
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/imago.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Workflow and Data Flow Documentation - CAI</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#workflow-and-data-flow-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CAI" class="md-header__button md-logo" aria-label="CAI" data-md-component="logo">
      
  <img src="../assets/imago.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CAI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Workflow and Data Flow Documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aliasrobotics/cai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aliasrobotics/cai
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CAI" class="md-nav__button md-logo" aria-label="CAI" data-md-component="logo">
      
  <img src="../assets/imago.png" alt="logo">

    </a>
    CAI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aliasrobotics/cai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aliasrobotics/cai
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Professional Edition
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Professional Edition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ü§î Why CAI PRO?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_alias1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚≠ê Alias1 Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üî• Exclusive Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚≠ê API Server (CAI PRO)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_pricing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üí∞ Pricing & Plans
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üöÄ Get Started with PRO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_contact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìû Contact Sales
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Interfaces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Mobile UI (iOS)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Mobile UI (iOS)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/mui_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/user_interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/gestures_shortcuts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gestures & Shortcuts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/chat_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chat Features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Terminal UI (TUI)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Terminal UI (TUI)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/tui_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/user_interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/terminals_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terminals Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/teams_and_parallel_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Teams & Parallel Execution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/sidebar_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sidebar Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/keyboard_shortcuts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Keyboard Shortcuts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/commands_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/advanced_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Command Line Interface (CLI)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Command Line Interface (CLI)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/cli_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/commands_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/advanced_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Core Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Core Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoffs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Agent Systems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../judge_gate_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Judge Gate Pipeline (Hunter ‚Üí Judge ‚Üí PoC)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Models & Providers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Models & Providers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_list_of_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Available Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Providers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Model Providers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/openrouter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenRouter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/ollama/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ollama
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure OpenAI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running_agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../continue_mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continue Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../session_resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Session Resume
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Streaming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tracing & Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guardrails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrails & Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../council/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLM Council
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grit (Audit Persistence)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Variables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Benchmarking
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Benchmarking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/running_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/attack_defense/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attack & Defense CTFs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/jeopardy_ctfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jeopardy CTFs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/cyber_ranges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cyber Ranges
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/knowledge_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/privacy_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Privacy Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../research/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../research_docs_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research Docs Index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            Agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/result/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Result
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/stream_events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stream Events
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/handoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoffs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lifecycle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/items/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Items
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/run_context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Run Context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/guardrail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrail
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/model_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/agent_output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Output
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/function_schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Function Schema
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/openai_chatcompletions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI Chat Completions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/openai_responses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI Responses
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Extensions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Extensions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/extensions/handoff_filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoff Filters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/extensions/handoff_prompt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoff Prompt
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_find_us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Find Us
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_citation_and_acknowledgments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Citation & Acknowledgments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#end-to-end-audit-process" class="md-nav__link">
    <span class="md-ellipsis">
      End-to-End Audit Process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="End-to-End Audit Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#high-level-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      High-Level Workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailed-process-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Detailed Process Flow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detailed Process Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-input-reception-and-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Input Reception and Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-analysis-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Analysis Preparation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-parallel-analysis-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3: Parallel Analysis Execution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-results-processing-and-aggregation" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4: Results Processing and Aggregation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-report-generation-and-delivery" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 5: Report Generation and Delivery
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-formats-and-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      Data Formats and Schemas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Formats and Schemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Core Data Structures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Data Structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auditrequest" class="md-nav__link">
    <span class="md-ellipsis">
      AuditRequest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysisconfig" class="md-nav__link">
    <span class="md-ellipsis">
      AnalysisConfig
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding" class="md-nav__link">
    <span class="md-ellipsis">
      Finding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#location" class="md-nav__link">
    <span class="md-ellipsis">
      Location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auditreport" class="md-nav__link">
    <span class="md-ellipsis">
      AuditReport
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json-schema-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      JSON Schema Definitions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="JSON Schema Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#audit-request-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Request Schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Finding Schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audit-report-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Report Schema
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-flow-diagrams" class="md-nav__link">
    <span class="md-ellipsis">
      Data Flow Diagrams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Flow Diagrams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contract-analysis-data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Contract Analysis Data Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-generation-data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Report Generation Data Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent-communication-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      Agent Communication Protocols
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent Communication Protocols">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-format" class="md-nav__link">
    <span class="md-ellipsis">
      Message Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-types" class="md-nav__link">
    <span class="md-ellipsis">
      Message Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Message Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-assignment-message" class="md-nav__link">
    <span class="md-ellipsis">
      Task Assignment Message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-submission-message" class="md-nav__link">
    <span class="md-ellipsis">
      Result Submission Message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-update-message" class="md-nav__link">
    <span class="md-ellipsis">
      Status Update Message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-message" class="md-nav__link">
    <span class="md-ellipsis">
      Error Message
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communication-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Communication Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Communication Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request-response-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Request-Response Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publish-subscribe-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Publish-Subscribe Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-pattern" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline Pattern
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-routing" class="md-nav__link">
    <span class="md-ellipsis">
      Message Routing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Message Routing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#direct-routing" class="md-nav__link">
    <span class="md-ellipsis">
      Direct Routing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topic-based-routing" class="md-nav__link">
    <span class="md-ellipsis">
      Topic-Based Routing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcast-routing" class="md-nav__link">
    <span class="md-ellipsis">
      Broadcast Routing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reliability-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      Reliability Mechanisms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reliability Mechanisms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-acknowledgment" class="md-nav__link">
    <span class="md-ellipsis">
      Message Acknowledgment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      Message Persistence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dead-letter-queue" class="md-nav__link">
    <span class="md-ellipsis">
      Dead Letter Queue
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#report-generation-process" class="md-nav__link">
    <span class="md-ellipsis">
      Report Generation Process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Report Generation Process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#report-types" class="md-nav__link">
    <span class="md-ellipsis">
      Report Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Report Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executive-summary-report" class="md-nav__link">
    <span class="md-ellipsis">
      Executive Summary Report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#technical-report" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-report" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Report
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-generation-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Report Generation Pipeline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Report Generation Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-data-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Data Collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-analysis-and-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Analysis and Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-report-assembly" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3: Report Assembly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-output-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4: Output Generation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Report Templates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Report Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json-report-template" class="md-nav__link">
    <span class="md-ellipsis">
      JSON Report Template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pdf-report-template-structure" class="md-nav__link">
    <span class="md-ellipsis">
      PDF Report Template Structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualization-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Visualization Generation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualization Generation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#risk-distribution-chart" class="md-nav__link">
    <span class="md-ellipsis">
      Risk Distribution Chart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#findings-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      Findings Timeline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#state-management" class="md-nav__link">
    <span class="md-ellipsis">
      State Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="State Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#audit-state-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Audit State Lifecycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      State Persistence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="State Persistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database-schema" class="md-nav__link">
    <span class="md-ellipsis">
      Database Schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-synchronization" class="md-nav__link">
    <span class="md-ellipsis">
      State Synchronization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpointing" class="md-nav__link">
    <span class="md-ellipsis">
      Checkpointing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling-and-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling and Recovery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling and Recovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#error-classification" class="md-nav__link">
    <span class="md-ellipsis">
      Error Classification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Classification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-errors" class="md-nav__link">
    <span class="md-ellipsis">
      System Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Agent Errors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery Strategies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recovery Strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Recovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-intervention" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Intervention
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      Error Reporting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Parallel Processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parallel Processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      Task Parallelization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-balancing" class="md-nav__link">
    <span class="md-ellipsis">
      Load Balancing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caching-and-memoization" class="md-nav__link">
    <span class="md-ellipsis">
      Caching and Memoization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caching and Memoization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analysis-result-caching" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis Result Caching
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Resource Optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Resource Optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      CPU Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="workflow-and-data-flow-documentation">Workflow and Data Flow Documentation</h1>
<p>This document provides comprehensive documentation of the audit workflow, data formats, agent communication protocols, and report generation processes in CAI's Web3 security auditing flow.</p>
<blockquote>
<p><strong>Note:</strong> All audit workflows run through the CAI-native <code>EliteWeb3Pipeline</code>
(<code>src/cai/web3/pipeline.py</code>). The <code>web3_security_ai</code> package is a backward-
compatibility adapter that delegates to this pipeline.</p>
</blockquote>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#end-to-end-audit-process">End-to-End Audit Process</a></li>
<li><a href="#data-formats-and-schemas">Data Formats and Schemas</a></li>
<li><a href="#agent-communication-protocols">Agent Communication Protocols</a></li>
<li><a href="#report-generation-process">Report Generation Process</a></li>
<li><a href="#state-management">State Management</a></li>
<li><a href="#error-handling-and-recovery">Error Handling and Recovery</a></li>
<li><a href="#performance-optimization">Performance Optimization</a></li>
</ul>
<hr />
<h2 id="end-to-end-audit-process">End-to-End Audit Process</h2>
<h3 id="high-level-workflow">High-Level Workflow</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-0-2">‚îÇ   Input         ‚îÇ    ‚îÇ   Analysis      ‚îÇ    ‚îÇ   Processing    ‚îÇ    ‚îÇ   Output        ‚îÇ
</span><span id="__span-0-3">‚îÇ   Reception     ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Preparation   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   &amp; Results     ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Generation    ‚îÇ
</span><span id="__span-0-4">‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ   Aggregation    ‚îÇ    ‚îÇ                 ‚îÇ
</span><span id="__span-0-5">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-0-6">         ‚îÇ                       ‚îÇ                       ‚îÇ                       ‚îÇ
</span><span id="__span-0-7">         ‚ñº                       ‚ñº                       ‚ñº                       ‚ñº
</span><span id="__span-0-8">   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-0-9">   ‚îÇ Contract    ‚îÇ         ‚îÇ Agent       ‚îÇ         ‚îÇ Result      ‚îÇ         ‚îÇ Report      ‚îÇ
</span><span id="__span-0-10">   ‚îÇ Validation  ‚îÇ         ‚îÇ Coordination‚îÇ         ‚îÇ Correlation ‚îÇ         ‚îÇ Generation  ‚îÇ
</span><span id="__span-0-11">   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span></code></pre></div>
<h3 id="detailed-process-flow">Detailed Process Flow</h3>
<h4 id="phase-1-input-reception-and-validation">Phase 1: Input Reception and Validation</h4>
<ol>
<li><strong>Input Parsing</strong></li>
<li>Accept various input formats (files, URLs, code strings)</li>
<li>Validate input format and accessibility</li>
<li>
<p>Extract metadata (Solidity version, imports, dependencies)</p>
</li>
<li>
<p><strong>Target Analysis</strong></p>
</li>
<li>Build contract dependency graph</li>
<li>Identify entry points and external interfaces</li>
<li>
<p>Determine analysis scope and boundaries</p>
</li>
<li>
<p><strong>Configuration Processing</strong></p>
</li>
<li>Load user configuration and defaults</li>
<li>Validate configuration parameters</li>
<li>Set up analysis environment</li>
</ol>
<h4 id="phase-2-analysis-preparation">Phase 2: Analysis Preparation</h4>
<ol>
<li><strong>Agent Initialization</strong></li>
<li>Load and configure audit agents</li>
<li>Initialize static analysis tools</li>
<li>
<p>Set up ML models and preprocessing</p>
</li>
<li>
<p><strong>Task Distribution</strong></p>
</li>
<li>Break down audit into parallelizable tasks</li>
<li>Assign tasks to appropriate agents</li>
<li>
<p>Set up inter-agent communication channels</p>
</li>
<li>
<p><strong>Resource Allocation</strong></p>
</li>
<li>Allocate computational resources</li>
<li>Set up temporary workspaces</li>
<li>Initialize monitoring and logging</li>
</ol>
<h4 id="phase-3-parallel-analysis-execution">Phase 3: Parallel Analysis Execution</h4>
<ol>
<li><strong>Static Analysis</strong></li>
<li>Run Slither, Mythril, and other static analyzers</li>
<li>Parse and normalize tool outputs</li>
<li>
<p>Extract code patterns and vulnerabilities</p>
</li>
<li>
<p><strong>Dynamic Analysis</strong></p>
</li>
<li>Execute symbolic analysis where applicable</li>
<li>Run fuzzing campaigns</li>
<li>
<p>Perform transaction pattern analysis</p>
</li>
<li>
<p><strong>AI/ML Analysis</strong></p>
</li>
<li>Apply machine learning models for pattern recognition</li>
<li>Classify vulnerabilities using trained models</li>
<li>
<p>Predict risk scores and impacts</p>
</li>
<li>
<p><strong>Cross-Agent Correlation</strong></p>
</li>
<li>Combine findings from multiple sources</li>
<li>Eliminate duplicates and false positives</li>
<li>Correlate related vulnerabilities</li>
</ol>
<h4 id="phase-4-results-processing-and-aggregation">Phase 4: Results Processing and Aggregation</h4>
<ol>
<li><strong>Finding Normalization</strong></li>
<li>Standardize finding formats across tools</li>
<li>Apply consistent severity scoring</li>
<li>
<p>Add contextual information</p>
</li>
<li>
<p><strong>Risk Assessment</strong></p>
</li>
<li>Calculate CVSS scores</li>
<li>Assess business impact</li>
<li>
<p>Prioritize findings by risk</p>
</li>
<li>
<p><strong>Compliance Checking</strong></p>
</li>
<li>Verify against security standards</li>
<li>Check regulatory compliance</li>
<li>Generate compliance reports</li>
</ol>
<h4 id="phase-5-report-generation-and-delivery">Phase 5: Report Generation and Delivery</h4>
<ol>
<li><strong>Report Compilation</strong></li>
<li>Aggregate all findings and analysis results</li>
<li>Generate multiple report formats</li>
<li>
<p>Include remediation recommendations</p>
</li>
<li>
<p><strong>Visualization Creation</strong></p>
</li>
<li>Generate charts and graphs</li>
<li>Create interactive dashboards</li>
<li>
<p>Produce executive summaries</p>
</li>
<li>
<p><strong>Output Delivery</strong></p>
</li>
<li>Deliver reports via configured channels</li>
<li>Store results in databases</li>
<li>Trigger follow-up actions</li>
</ol>
<hr />
<h2 id="data-formats-and-schemas">Data Formats and Schemas</h2>
<h3 id="core-data-structures">Core Data Structures</h3>
<h4 id="auditrequest">AuditRequest</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><span class="nd">@dataclass</span>
</span><span id="__span-1-2"><span class="k">class</span><span class="w"> </span><span class="nc">AuditRequest</span><span class="p">:</span>
</span><span id="__span-1-3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Request to perform a security audit.&quot;&quot;&quot;</span>
</span><span id="__span-1-4">
</span><span id="__span-1-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-1-6">    <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>  <span class="c1"># File paths, URLs, or code strings</span>
</span><span id="__span-1-7">    <span class="n">target_type</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;contract&quot;, &quot;protocol&quot;, &quot;dapp&quot;</span>
</span><span id="__span-1-8">    <span class="n">analysis_config</span><span class="p">:</span> <span class="n">AnalysisConfig</span>
</span><span id="__span-1-9">    <span class="n">reporting_config</span><span class="p">:</span> <span class="n">ReportingConfig</span>
</span><span id="__span-1-10">    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-1-11">    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span>
</span><span id="__span-1-12">    <span class="n">requester</span><span class="p">:</span> <span class="nb">str</span>
</span></code></pre></div>
<h4 id="analysisconfig">AnalysisConfig</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><span class="nd">@dataclass</span>
</span><span id="__span-2-2"><span class="k">class</span><span class="w"> </span><span class="nc">AnalysisConfig</span><span class="p">:</span>
</span><span id="__span-2-3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for analysis execution.&quot;&quot;&quot;</span>
</span><span id="__span-2-4">
</span><span id="__span-2-5">    <span class="n">depth</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;basic&quot;, &quot;standard&quot;, &quot;comprehensive&quot;, &quot;deep&quot;</span>
</span><span id="__span-2-6">    <span class="n">tools</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># Enabled analysis tools</span>
</span><span id="__span-2-7">    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Analysis timeout in seconds</span>
</span><span id="__span-2-8">    <span class="n">parallel</span><span class="p">:</span> <span class="nb">bool</span>  <span class="c1"># Enable parallel execution</span>
</span><span id="__span-2-9">    <span class="n">agents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># Enabled audit agents</span>
</span><span id="__span-2-10">    <span class="n">custom_rules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">CustomRule</span><span class="p">]</span>  <span class="c1"># User-defined rules</span>
</span><span id="__span-2-11">    <span class="n">exclusions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># Files/patterns to exclude</span>
</span></code></pre></div>
<h4 id="finding">Finding</h4>
<p>The canonical Finding model lives in <code>src/cai/core/finding.py</code> and is shared
across all pipeline stages, tools, and report generators:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><span class="nd">@dataclass</span>
</span><span id="__span-3-2"><span class="k">class</span><span class="w"> </span><span class="nc">Finding</span><span class="p">:</span>
</span><span id="__span-3-3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Canonical CAI finding ‚Äî used by pipeline, tools, and reports.&quot;&quot;&quot;</span>
</span><span id="__span-3-4">
</span><span id="__span-3-5">    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-6">    <span class="n">vulnerability_type</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-7">    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-8">    <span class="n">contract</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-9">    <span class="n">function_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-10">    <span class="n">location</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-3-11">
</span><span id="__span-3-12">    <span class="n">call_trace</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="__span-3-13">    <span class="n">state_variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="__span-3-14">    <span class="n">taint_path</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</span><span id="__span-3-15">
</span><span id="__span-3-16">    <span class="n">cross_contract</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-3-17">    <span class="n">external_call_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-3-18">    <span class="n">privilege_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-3-19">
</span><span id="__span-3-20">    <span class="n">exploit_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-3-21">    <span class="n">economic_profitability</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-3-22">    <span class="n">gas_cost_estimate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-3-23">
</span><span id="__span-3-24">    <span class="n">fork_verified</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-3-25">    <span class="n">invariant_broken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-3-26">
</span><span id="__span-3-27">    <span class="n">consensus_score</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-3-28">    <span class="n">rejected_reason</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-3-29">
</span><span id="__span-3-30">    <span class="k">def</span><span class="w"> </span><span class="nf">is_critical</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-3-31">        <span class="k">return</span> <span class="p">(</span>
</span><span id="__span-3-32">            <span class="bp">self</span><span class="o">.</span><span class="n">fork_verified</span>
</span><span id="__span-3-33">            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">invariant_broken</span>
</span><span id="__span-3-34">            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">economic_profitability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="__span-3-35">            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">economic_profitability</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="__span-3-36">            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">consensus_score</span> <span class="o">&gt;=</span> <span class="mf">0.85</span>
</span><span id="__span-3-37">        <span class="p">)</span>
</span></code></pre></div>
<h4 id="location">Location</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><span class="nd">@dataclass</span>
</span><span id="__span-4-2"><span class="k">class</span><span class="w"> </span><span class="nc">Location</span><span class="p">:</span>
</span><span id="__span-4-3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Location information for findings.&quot;&quot;&quot;</span>
</span><span id="__span-4-4">
</span><span id="__span-4-5">    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-4-6">    <span class="n">line</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-4-7">    <span class="n">column</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="__span-4-8">    <span class="n">function</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-4-9">    <span class="n">contract</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-4-10">    <span class="n">bytecode_offset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span></code></pre></div>
<h4 id="auditreport">AuditReport</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><span class="nd">@dataclass</span>
</span><span id="__span-5-2"><span class="k">class</span><span class="w"> </span><span class="nc">AuditReport</span><span class="p">:</span>
</span><span id="__span-5-3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Complete audit report.&quot;&quot;&quot;</span>
</span><span id="__span-5-4">
</span><span id="__span-5-5">    <span class="n">audit_id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-5-6">    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span>
</span><span id="__span-5-7">    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-5-8">    <span class="n">auditor_version</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-5-9">    <span class="n">summary</span><span class="p">:</span> <span class="n">ReportSummary</span>
</span><span id="__span-5-10">    <span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">]</span>
</span><span id="__span-5-11">    <span class="n">recommendations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Recommendation</span><span class="p">]</span>
</span><span id="__span-5-12">    <span class="n">compliance</span><span class="p">:</span> <span class="n">ComplianceResults</span>
</span><span id="__span-5-13">    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-5-14">    <span class="n">generated_formats</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span></code></pre></div>
<h3 id="json-schema-definitions">JSON Schema Definitions</h3>
<h4 id="audit-request-schema">Audit Request Schema</h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-6-1"><span class="p">{</span>
</span><span id="__span-6-2"><span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="p">,</span>
</span><span id="__span-6-3"><span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-6-4"><span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-5"><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-6-6"><span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-7"><span class="w">      </span><span class="nt">&quot;oneOf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-6-8"><span class="w">        </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-6-9"><span class="w">        </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}}</span>
</span><span id="__span-6-10"><span class="w">      </span><span class="p">]</span>
</span><span id="__span-6-11"><span class="w">    </span><span class="p">},</span>
</span><span id="__span-6-12"><span class="w">    </span><span class="nt">&quot;target_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-13"><span class="w">      </span><span class="nt">&quot;enum&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;contract&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;protocol&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dapp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;api&quot;</span><span class="p">]</span>
</span><span id="__span-6-14"><span class="w">    </span><span class="p">},</span>
</span><span id="__span-6-15"><span class="w">    </span><span class="nt">&quot;analysis_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/AnalysisConfig&quot;</span><span class="p">},</span>
</span><span id="__span-6-16"><span class="w">    </span><span class="nt">&quot;reporting_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/ReportingConfig&quot;</span><span class="p">},</span>
</span><span id="__span-6-17"><span class="w">    </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">},</span>
</span><span id="__span-6-18"><span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;date-time&quot;</span><span class="p">},</span>
</span><span id="__span-6-19"><span class="w">    </span><span class="nt">&quot;requester&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}</span>
</span><span id="__span-6-20"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-6-21"><span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;target&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;target_type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;analysis_config&quot;</span><span class="p">],</span>
</span><span id="__span-6-22"><span class="w">  </span><span class="nt">&quot;definitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-23"><span class="w">    </span><span class="nt">&quot;AnalysisConfig&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-24"><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-6-25"><span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-26"><span class="w">        </span><span class="nt">&quot;depth&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;enum&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;standard&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;comprehensive&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;deep&quot;</span><span class="p">]},</span>
</span><span id="__span-6-27"><span class="w">        </span><span class="nt">&quot;tools&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}},</span>
</span><span id="__span-6-28"><span class="w">        </span><span class="nt">&quot;timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span>
</span><span id="__span-6-29"><span class="w">        </span><span class="nt">&quot;parallel&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;boolean&quot;</span><span class="p">},</span>
</span><span id="__span-6-30"><span class="w">        </span><span class="nt">&quot;agents&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}},</span>
</span><span id="__span-6-31"><span class="w">        </span><span class="nt">&quot;custom_rules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/CustomRule&quot;</span><span class="p">}},</span>
</span><span id="__span-6-32"><span class="w">        </span><span class="nt">&quot;exclusions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}}</span>
</span><span id="__span-6-33"><span class="w">      </span><span class="p">}</span>
</span><span id="__span-6-34"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-35"><span class="w">  </span><span class="p">}</span>
</span><span id="__span-6-36"><span class="p">}</span>
</span></code></pre></div>
<h4 id="finding-schema">Finding Schema</h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-7-1"><span class="p">{</span>
</span><span id="__span-7-2"><span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="p">,</span>
</span><span id="__span-7-3"><span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-7-4"><span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-5"><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-6"><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-7"><span class="w">    </span><span class="nt">&quot;severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-8"><span class="w">      </span><span class="nt">&quot;enum&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;CRITICAL&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;HIGH&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;LOW&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;INFO&quot;</span><span class="p">]</span>
</span><span id="__span-7-9"><span class="w">    </span><span class="p">},</span>
</span><span id="__span-7-10"><span class="w">    </span><span class="nt">&quot;confidence&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;enum&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;medium&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;low&quot;</span><span class="p">]},</span>
</span><span id="__span-7-11"><span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-12"><span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-13"><span class="w">    </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/Location&quot;</span><span class="p">},</span>
</span><span id="__span-7-14"><span class="w">    </span><span class="nt">&quot;code_snippet&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-15"><span class="w">    </span><span class="nt">&quot;impact&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-16"><span class="w">    </span><span class="nt">&quot;recommendation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-17"><span class="w">    </span><span class="nt">&quot;cvss_score&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;maximum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">},</span>
</span><span id="__span-7-18"><span class="w">    </span><span class="nt">&quot;references&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}},</span>
</span><span id="__span-7-19"><span class="w">    </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">},</span>
</span><span id="__span-7-20"><span class="w">    </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}}</span>
</span><span id="__span-7-21"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-7-22"><span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;severity&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;description&quot;</span><span class="p">],</span>
</span><span id="__span-7-23"><span class="w">  </span><span class="nt">&quot;definitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-24"><span class="w">    </span><span class="nt">&quot;Location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-25"><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-7-26"><span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-27"><span class="w">        </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-28"><span class="w">        </span><span class="nt">&quot;line&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span>
</span><span id="__span-7-29"><span class="w">        </span><span class="nt">&quot;column&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
</span><span id="__span-7-30"><span class="w">        </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-31"><span class="w">        </span><span class="nt">&quot;contract&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-7-32"><span class="w">        </span><span class="nt">&quot;bytecode_offset&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">}</span>
</span><span id="__span-7-33"><span class="w">      </span><span class="p">},</span>
</span><span id="__span-7-34"><span class="w">      </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>
</span><span id="__span-7-35"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-36"><span class="w">  </span><span class="p">}</span>
</span><span id="__span-7-37"><span class="p">}</span>
</span></code></pre></div>
<h4 id="audit-report-schema">Audit Report Schema</h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-8-1"><span class="p">{</span>
</span><span id="__span-8-2"><span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="p">,</span>
</span><span id="__span-8-3"><span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-8-4"><span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-5"><span class="w">    </span><span class="nt">&quot;audit_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-8-6"><span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;date-time&quot;</span><span class="p">},</span>
</span><span id="__span-8-7"><span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-8-8"><span class="w">    </span><span class="nt">&quot;auditor_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
</span><span id="__span-8-9"><span class="w">    </span><span class="nt">&quot;summary&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/ReportSummary&quot;</span><span class="p">},</span>
</span><span id="__span-8-10"><span class="w">    </span><span class="nt">&quot;findings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/Finding&quot;</span><span class="p">}},</span>
</span><span id="__span-8-11"><span class="w">    </span><span class="nt">&quot;recommendations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/Recommendation&quot;</span><span class="p">}},</span>
</span><span id="__span-8-12"><span class="w">    </span><span class="nt">&quot;compliance&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;$ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;#/definitions/ComplianceResults&quot;</span><span class="p">},</span>
</span><span id="__span-8-13"><span class="w">    </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">},</span>
</span><span id="__span-8-14"><span class="w">    </span><span class="nt">&quot;generated_formats&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}}</span>
</span><span id="__span-8-15"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-8-16"><span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;audit_id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;target&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;summary&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;findings&quot;</span><span class="p">],</span>
</span><span id="__span-8-17"><span class="w">  </span><span class="nt">&quot;definitions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-18"><span class="w">    </span><span class="nt">&quot;ReportSummary&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-19"><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
</span><span id="__span-8-20"><span class="w">      </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-21"><span class="w">        </span><span class="nt">&quot;total_findings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
</span><span id="__span-8-22"><span class="w">        </span><span class="nt">&quot;critical&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
</span><span id="__span-8-23"><span class="w">        </span><span class="nt">&quot;high&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
</span><span id="__span-8-24"><span class="w">        </span><span class="nt">&quot;medium&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
</span><span id="__span-8-25"><span class="w">        </span><span class="nt">&quot;low&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
</span><span id="__span-8-26"><span class="w">        </span><span class="nt">&quot;info&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
</span><span id="__span-8-27"><span class="w">        </span><span class="nt">&quot;risk_score&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;maximum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">},</span>
</span><span id="__span-8-28"><span class="w">        </span><span class="nt">&quot;analysis_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
</span><span id="__span-8-29"><span class="w">        </span><span class="nt">&quot;coverage_percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;maximum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">}</span>
</span><span id="__span-8-30"><span class="w">      </span><span class="p">},</span>
</span><span id="__span-8-31"><span class="w">      </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;total_findings&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;risk_score&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;analysis_time&quot;</span><span class="p">]</span>
</span><span id="__span-8-32"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-33"><span class="w">  </span><span class="p">}</span>
</span><span id="__span-8-34"><span class="p">}</span>
</span></code></pre></div>
<h3 id="data-flow-diagrams">Data Flow Diagrams</h3>
<h4 id="contract-analysis-data-flow">Contract Analysis Data Flow</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1">Contract Source Code
</span><span id="__span-9-2">        ‚îÇ
</span><span id="__span-9-3">        ‚ñº
</span><span id="__span-9-4">   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-9-5">   ‚îÇ  Parser     ‚îÇ  Extract AST, metadata, dependencies
</span><span id="__span-9-6">   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-9-7">        ‚îÇ
</span><span id="__span-9-8">        ‚ñº
</span><span id="__span-9-9">   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-9-10">   ‚îÇ Preprocessor‚îÇ  Normalize, validate, prepare for analysis
</span><span id="__span-9-11">   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-9-12">        ‚îÇ
</span><span id="__span-9-13">        ‚ñº
</span><span id="__span-9-14">   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-9-15">   ‚îÇ Static      ‚îÇ     ‚îÇ Dynamic     ‚îÇ     ‚îÇ AI/ML       ‚îÇ
</span><span id="__span-9-16">   ‚îÇ Analysis    ‚îÇ     ‚îÇ Analysis    ‚îÇ     ‚îÇ Analysis    ‚îÇ
</span><span id="__span-9-17">   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-9-18">        ‚îÇ                     ‚îÇ                     ‚îÇ
</span><span id="__span-9-19">        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-9-20">                              ‚ñº
</span><span id="__span-9-21">                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-9-22">                     ‚îÇ Correlation ‚îÇ  Deduplicate, correlate findings
</span><span id="__span-9-23">                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-9-24">                              ‚îÇ
</span><span id="__span-9-25">                              ‚ñº
</span><span id="__span-9-26">                        Findings DB
</span></code></pre></div>
<h4 id="report-generation-data-flow">Report Generation Data Flow</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1">Findings DB
</span><span id="__span-10-2">     ‚îÇ
</span><span id="__span-10-3">     ‚ñº
</span><span id="__span-10-4">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-10-5">‚îÇ Aggregator  ‚îÇ  Group by severity, type, location
</span><span id="__span-10-6">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-10-7">     ‚îÇ
</span><span id="__span-10-8">     ‚ñº
</span><span id="__span-10-9">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-10-10">‚îÇ Risk        ‚îÇ  Calculate CVSS, assess impact
</span><span id="__span-10-11">‚îÇ Assessor    ‚îÇ
</span><span id="__span-10-12">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-10-13">     ‚îÇ
</span><span id="__span-10-14">     ‚ñº
</span><span id="__span-10-15">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-10-16">‚îÇ JSON        ‚îÇ     ‚îÇ PDF         ‚îÇ     ‚îÇ HTML        ‚îÇ
</span><span id="__span-10-17">‚îÇ Generator   ‚îÇ     ‚îÇ Generator   ‚îÇ     ‚îÇ Generator   ‚îÇ
</span><span id="__span-10-18">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-10-19">     ‚îÇ                     ‚îÇ                     ‚îÇ
</span><span id="__span-10-20">     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-10-21">                           ‚ñº
</span><span id="__span-10-22">                     Report Files
</span></code></pre></div>
<hr />
<h2 id="agent-communication-protocols">Agent Communication Protocols</h2>
<h3 id="message-format">Message Format</h3>
<p>All inter-agent communication uses a standardized message format:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><span class="nd">@dataclass</span>
</span><span id="__span-11-2"><span class="k">class</span><span class="w"> </span><span class="nc">AgentMessage</span><span class="p">:</span>
</span><span id="__span-11-3"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Standardized message format for agent communication.&quot;&quot;&quot;</span>
</span><span id="__span-11-4">
</span><span id="__span-11-5">    <span class="n">message_id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-11-6">    <span class="n">sender</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-11-7">    <span class="n">recipient</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-11-8">    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span>
</span><span id="__span-11-9">    <span class="n">message_type</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;task&quot;, &quot;result&quot;, &quot;status&quot;, &quot;error&quot;</span>
</span><span id="__span-11-10">    <span class="n">payload</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</span><span id="__span-11-11">    <span class="n">correlation_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-11-12">    <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 1=low, 5=high</span>
</span><span id="__span-11-13">    <span class="n">ttl</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3600</span>  <span class="c1"># Time to live in seconds</span>
</span></code></pre></div>
<h3 id="message-types">Message Types</h3>
<h4 id="task-assignment-message">Task Assignment Message</h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-12-1"><span class="p">{</span>
</span><span id="__span-12-2"><span class="w">  </span><span class="nt">&quot;message_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;msg_12345&quot;</span><span class="p">,</span>
</span><span id="__span-12-3"><span class="w">  </span><span class="nt">&quot;sender&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;orchestrator&quot;</span><span class="p">,</span>
</span><span id="__span-12-4"><span class="w">  </span><span class="nt">&quot;recipient&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;web3_audit_agent&quot;</span><span class="p">,</span>
</span><span id="__span-12-5"><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-11-05T06:26:13Z&quot;</span><span class="p">,</span>
</span><span id="__span-12-6"><span class="w">  </span><span class="nt">&quot;message_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;task&quot;</span><span class="p">,</span>
</span><span id="__span-12-7"><span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-8"><span class="w">    </span><span class="nt">&quot;task_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;task_67890&quot;</span><span class="p">,</span>
</span><span id="__span-12-9"><span class="w">    </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;analyze_contract&quot;</span><span class="p">,</span>
</span><span id="__span-12-10"><span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-11"><span class="w">      </span><span class="nt">&quot;contract_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;contracts/Token.sol&quot;</span><span class="p">,</span>
</span><span id="__span-12-12"><span class="w">      </span><span class="nt">&quot;analysis_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;comprehensive&quot;</span><span class="p">,</span>
</span><span id="__span-12-13"><span class="w">      </span><span class="nt">&quot;timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span>
</span><span id="__span-12-14"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-15"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-12-16"><span class="w">  </span><span class="nt">&quot;correlation_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
</span><span id="__span-12-17"><span class="w">  </span><span class="nt">&quot;priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
</span><span id="__span-12-18"><span class="p">}</span>
</span></code></pre></div>
<h4 id="result-submission-message">Result Submission Message</h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-13-1"><span class="p">{</span>
</span><span id="__span-13-2"><span class="w">  </span><span class="nt">&quot;message_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;msg_12346&quot;</span><span class="p">,</span>
</span><span id="__span-13-3"><span class="w">  </span><span class="nt">&quot;sender&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;web3_audit_agent&quot;</span><span class="p">,</span>
</span><span id="__span-13-4"><span class="w">  </span><span class="nt">&quot;recipient&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;orchestrator&quot;</span><span class="p">,</span>
</span><span id="__span-13-5"><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-11-05T06:28:45Z&quot;</span><span class="p">,</span>
</span><span id="__span-13-6"><span class="w">  </span><span class="nt">&quot;message_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;result&quot;</span><span class="p">,</span>
</span><span id="__span-13-7"><span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-8"><span class="w">    </span><span class="nt">&quot;task_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;task_67890&quot;</span><span class="p">,</span>
</span><span id="__span-13-9"><span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;completed&quot;</span><span class="p">,</span>
</span><span id="__span-13-10"><span class="w">    </span><span class="nt">&quot;findings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span>
</span><span id="__span-13-11"><span class="w">    </span><span class="nt">&quot;execution_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">152.3</span><span class="p">,</span>
</span><span id="__span-13-12"><span class="w">    </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-13"><span class="w">      </span><span class="nt">&quot;tool_versions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;slither&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.10.0&quot;</span><span class="p">},</span>
</span><span id="__span-13-14"><span class="w">      </span><span class="nt">&quot;coverage&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">95.2</span>
</span><span id="__span-13-15"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-13-16"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-13-17"><span class="w">  </span><span class="nt">&quot;correlation_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;msg_12345&quot;</span>
</span><span id="__span-13-18"><span class="p">}</span>
</span></code></pre></div>
<h4 id="status-update-message">Status Update Message</h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-14-1"><span class="p">{</span>
</span><span id="__span-14-2"><span class="w">  </span><span class="nt">&quot;message_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;msg_12347&quot;</span><span class="p">,</span>
</span><span id="__span-14-3"><span class="w">  </span><span class="nt">&quot;sender&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ml_engine&quot;</span><span class="p">,</span>
</span><span id="__span-14-4"><span class="w">  </span><span class="nt">&quot;recipient&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;orchestrator&quot;</span><span class="p">,</span>
</span><span id="__span-14-5"><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-11-05T06:27:22Z&quot;</span><span class="p">,</span>
</span><span id="__span-14-6"><span class="w">  </span><span class="nt">&quot;message_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;status&quot;</span><span class="p">,</span>
</span><span id="__span-14-7"><span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-8"><span class="w">    </span><span class="nt">&quot;task_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;task_67891&quot;</span><span class="p">,</span>
</span><span id="__span-14-9"><span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;running&quot;</span><span class="p">,</span>
</span><span id="__span-14-10"><span class="w">    </span><span class="nt">&quot;progress&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span>
</span><span id="__span-14-11"><span class="w">    </span><span class="nt">&quot;current_operation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Feature extraction&quot;</span><span class="p">,</span>
</span><span id="__span-14-12"><span class="w">    </span><span class="nt">&quot;estimated_completion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-11-05T06:32:00Z&quot;</span>
</span><span id="__span-14-13"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-14-14"><span class="w">  </span><span class="nt">&quot;correlation_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;msg_12345&quot;</span>
</span><span id="__span-14-15"><span class="p">}</span>
</span></code></pre></div>
<h4 id="error-message">Error Message</h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-15-1"><span class="p">{</span>
</span><span id="__span-15-2"><span class="w">  </span><span class="nt">&quot;message_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;msg_12348&quot;</span><span class="p">,</span>
</span><span id="__span-15-3"><span class="w">  </span><span class="nt">&quot;sender&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;static_analysis_adapter&quot;</span><span class="p">,</span>
</span><span id="__span-15-4"><span class="w">  </span><span class="nt">&quot;recipient&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;orchestrator&quot;</span><span class="p">,</span>
</span><span id="__span-15-5"><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-11-05T06:29:10Z&quot;</span><span class="p">,</span>
</span><span id="__span-15-6"><span class="w">  </span><span class="nt">&quot;message_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="__span-15-7"><span class="w">  </span><span class="nt">&quot;payload&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-8"><span class="w">    </span><span class="nt">&quot;task_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;task_67892&quot;</span><span class="p">,</span>
</span><span id="__span-15-9"><span class="w">    </span><span class="nt">&quot;error_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ToolExecutionError&quot;</span><span class="p">,</span>
</span><span id="__span-15-10"><span class="w">    </span><span class="nt">&quot;error_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Slither analysis failed: timeout&quot;</span><span class="p">,</span>
</span><span id="__span-15-11"><span class="w">    </span><span class="nt">&quot;error_details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-12"><span class="w">      </span><span class="nt">&quot;tool&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;slither&quot;</span><span class="p">,</span>
</span><span id="__span-15-13"><span class="w">      </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;slither contracts/Token.sol --json&quot;</span><span class="p">,</span>
</span><span id="__span-15-14"><span class="w">      </span><span class="nt">&quot;exit_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span>
</span><span id="__span-15-15"><span class="w">      </span><span class="nt">&quot;timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span>
</span><span id="__span-15-16"><span class="w">    </span><span class="p">},</span>
</span><span id="__span-15-17"><span class="w">    </span><span class="nt">&quot;recoverable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-15-18"><span class="w">    </span><span class="nt">&quot;retry_suggested&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-15-19"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-15-20"><span class="w">  </span><span class="nt">&quot;correlation_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;msg_12345&quot;</span><span class="p">,</span>
</span><span id="__span-15-21"><span class="w">  </span><span class="nt">&quot;priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
</span><span id="__span-15-22"><span class="p">}</span>
</span></code></pre></div>
<h3 id="communication-patterns">Communication Patterns</h3>
<h4 id="request-response-pattern">Request-Response Pattern</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1">Orchestrator ‚Üí Agent: Task Assignment
</span><span id="__span-16-2">      ‚Üì
</span><span id="__span-16-3">Agent ‚Üí Orchestrator: Status Updates
</span><span id="__span-16-4">      ‚Üì
</span><span id="__span-16-5">Agent ‚Üí Orchestrator: Result Submission
</span></code></pre></div>
<h4 id="publish-subscribe-pattern">Publish-Subscribe Pattern</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1">Agent ‚Üí All Agents: Capability Announcement
</span><span id="__span-17-2">Agent ‚Üí Subscribers: Finding Notifications
</span><span id="__span-17-3">Orchestrator ‚Üí All Agents: Global Configuration Updates
</span></code></pre></div>
<h4 id="pipeline-pattern">Pipeline Pattern</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1">Agent A ‚Üí Agent B: Processed Data
</span><span id="__span-18-2">Agent B ‚Üí Agent C: Enhanced Results
</span><span id="__span-18-3">Agent C ‚Üí Orchestrator: Final Output
</span></code></pre></div>
<h3 id="message-routing">Message Routing</h3>
<h4 id="direct-routing">Direct Routing</h4>
<p>Messages sent directly to specific agents by ID.</p>
<h4 id="topic-based-routing">Topic-Based Routing</h4>
<p>Messages published to topics that interested agents subscribe to:</p>
<ul>
<li><code>tasks/*</code> - Task assignments and updates</li>
<li><code>findings/*</code> - Security findings</li>
<li><code>status/*</code> - Agent status updates</li>
<li><code>errors/*</code> - Error notifications</li>
</ul>
<h4 id="broadcast-routing">Broadcast Routing</h4>
<p>System-wide announcements and configuration updates.</p>
<h3 id="reliability-mechanisms">Reliability Mechanisms</h3>
<h4 id="message-acknowledgment">Message Acknowledgment</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><span class="c1"># Sender waits for acknowledgment</span>
</span><span id="__span-19-2"><span class="n">message</span> <span class="o">=</span> <span class="n">send_message</span><span class="p">(</span><span class="n">recipient</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
</span><span id="__span-19-3"><span class="n">acknowledgment</span> <span class="o">=</span> <span class="n">wait_for_ack</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</span><span id="__span-19-4">
</span><span id="__span-19-5"><span class="k">if</span> <span class="ow">not</span> <span class="n">acknowledgment</span><span class="p">:</span>
</span><span id="__span-19-6">    <span class="c1"># Implement retry logic</span>
</span><span id="__span-19-7">    <span class="n">retry_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="message-persistence">Message Persistence</h4>
<p>All messages are persisted to ensure delivery even during system restarts.</p>
<h4 id="dead-letter-queue">Dead Letter Queue</h4>
<p>Undeliverable messages are moved to a dead letter queue for analysis.</p>
<hr />
<h2 id="report-generation-process">Report Generation Process</h2>
<h3 id="report-types">Report Types</h3>
<h4 id="executive-summary-report">Executive Summary Report</h4>
<p>High-level overview for management and stakeholders.</p>
<p><strong>Contents:</strong>
- Audit summary statistics
- Risk assessment overview
- Key findings and recommendations
- Compliance status</p>
<h4 id="technical-report">Technical Report</h4>
<p>Detailed technical findings for developers and auditors.</p>
<p><strong>Contents:</strong>
- Complete finding details
- Code snippets and locations
- Technical recommendations
- Remediation guidance</p>
<h4 id="compliance-report">Compliance Report</h4>
<p>Standards compliance assessment.</p>
<p><strong>Contents:</strong>
- Standards coverage matrix
- Compliance gaps
- Remediation roadmap
- Regulatory requirements</p>
<h3 id="report-generation-pipeline">Report Generation Pipeline</h3>
<h4 id="phase-1-data-collection">Phase 1: Data Collection</h4>
<ol>
<li><strong>Findings Aggregation</strong></li>
<li>Collect all findings from agents</li>
<li>Normalize data formats</li>
<li>
<p>Remove duplicates</p>
</li>
<li>
<p><strong>Metadata Enrichment</strong></p>
</li>
<li>Add contextual information</li>
<li>Include code snippets</li>
<li>Generate references</li>
</ol>
<h4 id="phase-2-analysis-and-processing">Phase 2: Analysis and Processing</h4>
<ol>
<li><strong>Risk Calculation</strong></li>
<li>Apply CVSS scoring</li>
<li>Assess business impact</li>
<li>
<p>Calculate risk scores</p>
</li>
<li>
<p><strong>Finding Correlation</strong></p>
</li>
<li>Group related findings</li>
<li>Identify root causes</li>
<li>Create finding chains</li>
</ol>
<h4 id="phase-3-report-assembly">Phase 3: Report Assembly</h4>
<ol>
<li><strong>Template Selection</strong></li>
<li>Choose appropriate templates</li>
<li>Load formatting rules</li>
<li>
<p>Configure output options</p>
</li>
<li>
<p><strong>Content Generation</strong></p>
</li>
<li>Populate templates with data</li>
<li>Generate visualizations</li>
<li>Create executive summaries</li>
</ol>
<h4 id="phase-4-output-generation">Phase 4: Output Generation</h4>
<ol>
<li><strong>Format Conversion</strong></li>
<li>Generate JSON reports</li>
<li>Create PDF documents</li>
<li>
<p>Produce HTML dashboards</p>
</li>
<li>
<p><strong>Quality Assurance</strong></p>
</li>
<li>Validate report completeness</li>
<li>Check formatting consistency</li>
<li>Verify data accuracy</li>
</ol>
<h3 id="report-templates">Report Templates</h3>
<h4 id="json-report-template">JSON Report Template</h4>
<div class="language-json highlight"><pre><span></span><code><span id="__span-20-1"><span class="p">{</span>
</span><span id="__span-20-2"><span class="w">  </span><span class="nt">&quot;report_metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-3"><span class="w">    </span><span class="nt">&quot;generated_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ timestamp }}&quot;</span><span class="p">,</span>
</span><span id="__span-20-4"><span class="w">    </span><span class="nt">&quot;generator_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ version }}&quot;</span><span class="p">,</span>
</span><span id="__span-20-5"><span class="w">    </span><span class="nt">&quot;audit_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ audit_id }}&quot;</span>
</span><span id="__span-20-6"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-20-7"><span class="w">  </span><span class="nt">&quot;executive_summary&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-8"><span class="w">    </span><span class="nt">&quot;total_findings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{{</span><span class="w"> </span><span class="err">summary.</span><span class="kc">t</span><span class="err">o</span><span class="kc">tal</span><span class="err">_</span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gs</span><span class="w"> </span><span class="p">}},</span>
</span><span id="__span-20-9"><span class="w">    </span><span class="nt">&quot;risk_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ summary.risk_level }}&quot;</span><span class="p">,</span>
</span><span id="__span-20-10"><span class="w">    </span><span class="nt">&quot;key_recommendations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{{</span><span class="w"> </span><span class="err">recomme</span><span class="kc">n</span><span class="err">da</span><span class="kc">t</span><span class="err">io</span><span class="kc">ns</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="kc">t</span><span class="err">ojso</span><span class="kc">n</span><span class="w"> </span><span class="p">}}</span>
</span><span id="__span-20-11"><span class="w">  </span><span class="p">},</span>
</span><span id="__span-20-12"><span class="w">  </span><span class="nt">&quot;detailed_findings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{{</span><span class="w"> </span><span class="kc">f</span><span class="err">i</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gs</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="kc">t</span><span class="err">ojso</span><span class="kc">n</span><span class="w"> </span><span class="p">}},</span>
</span><span id="__span-20-13"><span class="w">  </span><span class="nt">&quot;appendices&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-14"><span class="w">    </span><span class="nt">&quot;methodology&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ methodology }}&quot;</span><span class="p">,</span>
</span><span id="__span-20-15"><span class="w">    </span><span class="nt">&quot;tools_used&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{{</span><span class="w"> </span><span class="kc">t</span><span class="err">ools</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="kc">t</span><span class="err">ojso</span><span class="kc">n</span><span class="w"> </span><span class="p">}},</span>
</span><span id="__span-20-16"><span class="w">    </span><span class="nt">&quot;disclaimer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ disclaimer }}&quot;</span>
</span><span id="__span-20-17"><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-18"><span class="p">}</span>
</span></code></pre></div>
<h4 id="pdf-report-template-structure">PDF Report Template Structure</h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1">Cover Page
</span><span id="__span-21-2">‚îú‚îÄ‚îÄ Title
</span><span id="__span-21-3">‚îú‚îÄ‚îÄ Audit Date
</span><span id="__span-21-4">‚îú‚îÄ‚îÄ Target Information
</span><span id="__span-21-5">‚îî‚îÄ‚îÄ Executive Summary
</span><span id="__span-21-6">
</span><span id="__span-21-7">Table of Contents
</span><span id="__span-21-8">
</span><span id="__span-21-9">Executive Summary
</span><span id="__span-21-10">‚îú‚îÄ‚îÄ Audit Overview
</span><span id="__span-21-11">‚îú‚îÄ‚îÄ Key Findings
</span><span id="__span-21-12">‚îú‚îÄ‚îÄ Risk Assessment
</span><span id="__span-21-13">‚îî‚îÄ‚îÄ Recommendations
</span><span id="__span-21-14">
</span><span id="__span-21-15">Detailed Findings
</span><span id="__span-21-16">‚îú‚îÄ‚îÄ Critical Findings
</span><span id="__span-21-17">‚îú‚îÄ‚îÄ High Findings
</span><span id="__span-21-18">‚îú‚îÄ‚îÄ Medium Findings
</span><span id="__span-21-19">‚îú‚îÄ‚îÄ Low Findings
</span><span id="__span-21-20">‚îî‚îÄ‚îÄ Informational Findings
</span><span id="__span-21-21">
</span><span id="__span-21-22">Compliance Assessment
</span><span id="__span-21-23">‚îú‚îÄ‚îÄ Standards Coverage
</span><span id="__span-21-24">‚îú‚îÄ‚îÄ Compliance Gaps
</span><span id="__span-21-25">‚îî‚îÄ‚îÄ Remediation Plan
</span><span id="__span-21-26">
</span><span id="__span-21-27">Appendices
</span><span id="__span-21-28">‚îú‚îÄ‚îÄ Methodology
</span><span id="__span-21-29">‚îú‚îÄ‚îÄ Tools and Versions
</span><span id="__span-21-30">‚îú‚îÄ‚îÄ Glossary
</span><span id="__span-21-31">‚îî‚îÄ‚îÄ References
</span></code></pre></div>
<h3 id="visualization-generation">Visualization Generation</h3>
<h4 id="risk-distribution-chart">Risk Distribution Chart</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><span class="k">def</span><span class="w"> </span><span class="nf">generate_risk_chart</span><span class="p">(</span><span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span><span id="__span-22-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate risk distribution pie chart.&quot;&quot;&quot;</span>
</span><span id="__span-22-3">
</span><span id="__span-22-4">    <span class="n">severity_counts</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-22-5">    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
</span><span id="__span-22-6">        <span class="n">severity</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">severity</span>
</span><span id="__span-22-7">        <span class="n">severity_counts</span><span class="p">[</span><span class="n">severity</span><span class="p">]</span> <span class="o">=</span> <span class="n">severity_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-22-8">
</span><span id="__span-22-9">    <span class="c1"># Create pie chart</span>
</span><span id="__span-22-10">    <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">severity_counts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-22-11">    <span class="n">sizes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">severity_counts</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-22-12">    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#ff0000&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff8000&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffff00&#39;</span><span class="p">,</span> <span class="s1">&#39;#80ff00&#39;</span><span class="p">,</span> <span class="s1">&#39;#00ff00&#39;</span><span class="p">]</span>
</span><span id="__span-22-13">
</span><span id="__span-22-14">    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-22-15">    <span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-22-16">    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Findings by Severity&#39;</span><span class="p">)</span>
</span><span id="__span-22-17">    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</span><span id="__span-22-18">
</span><span id="__span-22-19">    <span class="c1"># Save to bytes</span>
</span><span id="__span-22-20">    <span class="n">buffer</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="__span-22-21">    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</span><span id="__span-22-22">    <span class="n">buffer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-22-23">    <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span></code></pre></div>
<h4 id="findings-timeline">Findings Timeline</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><span class="k">def</span><span class="w"> </span><span class="nf">generate_timeline_chart</span><span class="p">(</span><span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span><span id="__span-23-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate findings discovery timeline.&quot;&quot;&quot;</span>
</span><span id="__span-23-3">
</span><span id="__span-23-4">    <span class="c1"># Group findings by time (assuming timestamps are available)</span>
</span><span id="__span-23-5">    <span class="n">timeline_data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-23-6">    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
</span><span id="__span-23-7">        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">finding</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;discovered_at&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
</span><span id="__span-23-8">        <span class="k">if</span> <span class="n">timestamp</span> <span class="o">!=</span> <span class="s1">&#39;unknown&#39;</span><span class="p">:</span>
</span><span id="__span-23-9">            <span class="n">date</span> <span class="o">=</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-23-10">            <span class="n">timeline_data</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">timeline_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-23-11">
</span><span id="__span-23-12">    <span class="n">dates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">timeline_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-23-13">    <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">timeline_data</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">]</span>
</span><span id="__span-23-14">
</span><span id="__span-23-15">    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-23-16">    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
</span><span id="__span-23-17">    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Findings Discovery Timeline&#39;</span><span class="p">)</span>
</span><span id="__span-23-18">    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
</span><span id="__span-23-19">    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Findings&#39;</span><span class="p">)</span>
</span><span id="__span-23-20">    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span><span id="__span-23-21">    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</span><span id="__span-23-22">
</span><span id="__span-23-23">    <span class="n">buffer</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
</span><span id="__span-23-24">    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</span><span id="__span-23-25">    <span class="n">buffer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-23-26">    <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span></code></pre></div>
<hr />
<h2 id="state-management">State Management</h2>
<h3 id="audit-state-lifecycle">Audit State Lifecycle</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1">PENDING ‚Üí QUEUED ‚Üí RUNNING ‚Üí COMPLETING ‚Üí COMPLETED
</span><span id="__span-24-2">    ‚Üì        ‚Üì        ‚Üì          ‚Üì            ‚Üì
</span><span id="__span-24-3"> CANCELLED  FAILED   PAUSED    FAILED      ARCHIVED
</span></code></pre></div>
<h3 id="state-persistence">State Persistence</h3>
<h4 id="database-schema">Database Schema</h4>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-25-1"><span class="c1">-- Audit sessions table</span>
</span><span id="__span-25-2"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">audit_sessions</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-25-3"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span id="__span-25-4"><span class="w">    </span><span class="n">target</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-5"><span class="w">    </span><span class="n">target_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-6"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-7"><span class="w">    </span><span class="n">config</span><span class="w"> </span><span class="n">JSONB</span><span class="p">,</span>
</span><span id="__span-25-8"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-9"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-10"><span class="w">    </span><span class="n">completed_at</span><span class="w"> </span><span class="k">TIMESTAMP</span>
</span><span id="__span-25-11"><span class="p">);</span>
</span><span id="__span-25-12">
</span><span id="__span-25-13"><span class="c1">-- Audit findings table</span>
</span><span id="__span-25-14"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">audit_findings</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-25-15"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span id="__span-25-16"><span class="w">    </span><span class="n">audit_id</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">audit_sessions</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
</span><span id="__span-25-17"><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-18"><span class="w">    </span><span class="n">severity</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-19"><span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-20"><span class="w">    </span><span class="n">description</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
</span><span id="__span-25-21"><span class="w">    </span><span class="k">location</span><span class="w"> </span><span class="n">JSONB</span><span class="p">,</span>
</span><span id="__span-25-22"><span class="w">    </span><span class="n">metadata</span><span class="w"> </span><span class="n">JSONB</span><span class="p">,</span>
</span><span id="__span-25-23"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
</span><span id="__span-25-24"><span class="p">);</span>
</span><span id="__span-25-25">
</span><span id="__span-25-26"><span class="c1">-- Agent states table</span>
</span><span id="__span-25-27"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">agent_states</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-25-28"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span id="__span-25-29"><span class="w">    </span><span class="n">audit_id</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">audit_sessions</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
</span><span id="__span-25-30"><span class="w">    </span><span class="n">agent_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-25-31"><span class="w">    </span><span class="k">state</span><span class="w"> </span><span class="n">JSONB</span><span class="p">,</span>
</span><span id="__span-25-32"><span class="w">    </span><span class="n">last_updated</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
</span><span id="__span-25-33"><span class="p">);</span>
</span></code></pre></div>
<h4 id="state-synchronization">State Synchronization</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><span class="k">class</span><span class="w"> </span><span class="nc">StateManager</span><span class="p">:</span>
</span><span id="__span-26-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages audit state persistence and synchronization.&quot;&quot;&quot;</span>
</span><span id="__span-26-3">
</span><span id="__span-26-4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_connection</span><span class="p">):</span>
</span><span id="__span-26-5">        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db_connection</span>
</span><span id="__span-26-6">
</span><span id="__span-26-7">    <span class="k">def</span><span class="w"> </span><span class="nf">save_audit_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">audit_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-26-8"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Save complete audit state.&quot;&quot;&quot;</span>
</span><span id="__span-26-9">        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
</span><span id="__span-26-10">            <span class="c1"># Update audit session</span>
</span><span id="__span-26-11">            <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-26-12"><span class="s2">                UPDATE audit_sessions</span>
</span><span id="__span-26-13"><span class="s2">                SET status = </span><span class="si">%s</span><span class="s2">, updated_at = NOW()</span>
</span><span id="__span-26-14"><span class="s2">                WHERE id = </span><span class="si">%s</span>
</span><span id="__span-26-15"><span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">],</span> <span class="n">audit_id</span><span class="p">))</span>
</span><span id="__span-26-16">
</span><span id="__span-26-17">            <span class="c1"># Save agent states</span>
</span><span id="__span-26-18">            <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent_state</span> <span class="ow">in</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;agents&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-26-19">                <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-26-20"><span class="s2">                    INSERT INTO agent_states (audit_id, agent_name, state, last_updated)</span>
</span><span id="__span-26-21"><span class="s2">                    VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, NOW())</span>
</span><span id="__span-26-22"><span class="s2">                    ON CONFLICT (audit_id, agent_name)</span>
</span><span id="__span-26-23"><span class="s2">                    DO UPDATE SET state = EXCLUDED.state, last_updated = NOW()</span>
</span><span id="__span-26-24"><span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">audit_id</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">agent_state</span><span class="p">)))</span>
</span><span id="__span-26-25">
</span><span id="__span-26-26">    <span class="k">def</span><span class="w"> </span><span class="nf">load_audit_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">audit_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-26-27"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load complete audit state.&quot;&quot;&quot;</span>
</span><span id="__span-26-28">        <span class="c1"># Load audit session</span>
</span><span id="__span-26-29">        <span class="n">audit_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">fetchone</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-26-30"><span class="s2">            SELECT * FROM audit_sessions WHERE id = </span><span class="si">%s</span>
</span><span id="__span-26-31"><span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">audit_id</span><span class="p">,))</span>
</span><span id="__span-26-32">
</span><span id="__span-26-33">        <span class="k">if</span> <span class="ow">not</span> <span class="n">audit_row</span><span class="p">:</span>
</span><span id="__span-26-34">            <span class="k">raise</span> <span class="n">AuditNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Audit </span><span class="si">{</span><span class="n">audit_id</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
</span><span id="__span-26-35">
</span><span id="__span-26-36">        <span class="c1"># Load agent states</span>
</span><span id="__span-26-37">        <span class="n">agent_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">fetchall</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-26-38"><span class="s2">            SELECT agent_name, state FROM agent_states WHERE audit_id = </span><span class="si">%s</span>
</span><span id="__span-26-39"><span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">audit_id</span><span class="p">,))</span>
</span><span id="__span-26-40">
</span><span id="__span-26-41">        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-26-42">            <span class="s1">&#39;audit&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">audit_row</span><span class="p">),</span>
</span><span id="__span-26-43">            <span class="s1">&#39;agents&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;agent_name&#39;</span><span class="p">]:</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">agent_rows</span><span class="p">}</span>
</span><span id="__span-26-44">        <span class="p">}</span>
</span></code></pre></div>
<h3 id="checkpointing">Checkpointing</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><span class="k">class</span><span class="w"> </span><span class="nc">CheckpointManager</span><span class="p">:</span>
</span><span id="__span-27-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages audit checkpoints for resumability.&quot;&quot;&quot;</span>
</span><span id="__span-27-3">
</span><span id="__span-27-4">    <span class="k">def</span><span class="w"> </span><span class="nf">create_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">audit_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">checkpoint_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-27-5"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a resumable checkpoint.&quot;&quot;&quot;</span>
</span><span id="__span-27-6">        <span class="n">checkpoint</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-27-7">            <span class="s1">&#39;audit_id&#39;</span><span class="p">:</span> <span class="n">audit_id</span><span class="p">,</span>
</span><span id="__span-27-8">            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-27-9">            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">checkpoint_data</span><span class="p">,</span>
</span><span id="__span-27-10">            <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0&#39;</span>
</span><span id="__span-27-11">        <span class="p">}</span>
</span><span id="__span-27-12">
</span><span id="__span-27-13">        <span class="n">checkpoint_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;checkpoints/</span><span class="si">{</span><span class="n">audit_id</span><span class="si">}</span><span class="s2">/checkpoint_</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span><span class="si">}</span><span class="s2">.json&quot;</span>
</span><span id="__span-27-14">        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-27-15">
</span><span id="__span-27-16">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-27-17">            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-27-18">
</span><span id="__span-27-19">        <span class="k">return</span> <span class="n">checkpoint_path</span>
</span><span id="__span-27-20">
</span><span id="__span-27-21">    <span class="k">def</span><span class="w"> </span><span class="nf">load_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">audit_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-27-22"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the most recent checkpoint for an audit.&quot;&quot;&quot;</span>
</span><span id="__span-27-23">        <span class="n">checkpoint_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;checkpoints/</span><span class="si">{</span><span class="n">audit_id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-27-24">        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">):</span>
</span><span id="__span-27-25">            <span class="k">raise</span> <span class="n">CheckpointNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No checkpoints found for audit </span><span class="si">{</span><span class="n">audit_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-27-26">
</span><span id="__span-27-27">        <span class="c1"># Find most recent checkpoint</span>
</span><span id="__span-27-28">        <span class="n">checkpoint_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">checkpoint_dir</span><span class="si">}</span><span class="s2">/checkpoint_*.json&quot;</span><span class="p">)</span>
</span><span id="__span-27-29">        <span class="k">if</span> <span class="ow">not</span> <span class="n">checkpoint_files</span><span class="p">:</span>
</span><span id="__span-27-30">            <span class="k">raise</span> <span class="n">CheckpointNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No checkpoint files found for audit </span><span class="si">{</span><span class="n">audit_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-27-31">
</span><span id="__span-27-32">        <span class="n">latest_checkpoint</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">checkpoint_files</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getctime</span><span class="p">)</span>
</span><span id="__span-27-33">
</span><span id="__span-27-34">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">latest_checkpoint</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-27-35">            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="error-handling-and-recovery">Error Handling and Recovery</h2>
<h3 id="error-classification">Error Classification</h3>
<h4 id="system-errors">System Errors</h4>
<ul>
<li><strong>ConfigurationError</strong>: Invalid configuration or missing parameters</li>
<li><strong>ResourceError</strong>: Insufficient resources (memory, disk, CPU)</li>
<li><strong>NetworkError</strong>: Connectivity issues with external services</li>
<li><strong>DatabaseError</strong>: Database connectivity or query failures</li>
</ul>
<h4 id="analysis-errors">Analysis Errors</h4>
<ul>
<li><strong>ToolError</strong>: External tool execution failures</li>
<li><strong>ParseError</strong>: Input parsing or format validation failures</li>
<li><strong>TimeoutError</strong>: Analysis operations exceeding time limits</li>
<li><strong>ValidationError</strong>: Input validation failures</li>
</ul>
<h4 id="agent-errors">Agent Errors</h4>
<ul>
<li><strong>AgentCommunicationError</strong>: Inter-agent communication failures</li>
<li><strong>AgentTimeoutError</strong>: Agent operations timing out</li>
<li><strong>AgentConfigurationError</strong>: Agent-specific configuration issues</li>
</ul>
<h3 id="recovery-strategies">Recovery Strategies</h3>
<h4 id="automatic-recovery">Automatic Recovery</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><span class="k">class</span><span class="w"> </span><span class="nc">ErrorRecoveryManager</span><span class="p">:</span>
</span><span id="__span-28-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages automatic error recovery strategies.&quot;&quot;&quot;</span>
</span><span id="__span-28-3">
</span><span id="__span-28-4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-28-5">        <span class="bp">self</span><span class="o">.</span><span class="n">recovery_strategies</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-28-6">            <span class="s1">&#39;ToolError&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recover_tool_error</span><span class="p">,</span>
</span><span id="__span-28-7">            <span class="s1">&#39;TimeoutError&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recover_timeout_error</span><span class="p">,</span>
</span><span id="__span-28-8">            <span class="s1">&#39;NetworkError&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recover_network_error</span>
</span><span id="__span-28-9">        <span class="p">}</span>
</span><span id="__span-28-10">
</span><span id="__span-28-11">    <span class="k">def</span><span class="w"> </span><span class="nf">recover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RecoveryAction</span><span class="p">:</span>
</span><span id="__span-28-12"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine and execute recovery strategy.&quot;&quot;&quot;</span>
</span><span id="__span-28-13">
</span><span id="__span-28-14">        <span class="n">error_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="__span-28-15">
</span><span id="__span-28-16">        <span class="k">if</span> <span class="n">error_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recovery_strategies</span><span class="p">:</span>
</span><span id="__span-28-17">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recovery_strategies</span><span class="p">[</span><span class="n">error_type</span><span class="p">](</span><span class="n">error</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</span><span id="__span-28-18">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-28-19">            <span class="k">return</span> <span class="n">RecoveryAction</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;escalate&#39;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
</span><span id="__span-28-20">
</span><span id="__span-28-21">    <span class="k">def</span><span class="w"> </span><span class="nf">_recover_tool_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">ToolError</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RecoveryAction</span><span class="p">:</span>
</span><span id="__span-28-22"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recover from tool execution errors.&quot;&quot;&quot;</span>
</span><span id="__span-28-23">        <span class="n">tool_name</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tool_name&#39;</span><span class="p">)</span>
</span><span id="__span-28-24">
</span><span id="__span-28-25">        <span class="c1"># Try alternative tool</span>
</span><span id="__span-28-26">        <span class="n">alternatives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_alternative_tools</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
</span><span id="__span-28-27">        <span class="k">if</span> <span class="n">alternatives</span><span class="p">:</span>
</span><span id="__span-28-28">            <span class="k">return</span> <span class="n">RecoveryAction</span><span class="p">(</span>
</span><span id="__span-28-29">                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;retry_with_alternative&#39;</span><span class="p">,</span>
</span><span id="__span-28-30">                <span class="n">alternative_tool</span><span class="o">=</span><span class="n">alternatives</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="__span-28-31">                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Switching to alternative tool: </span><span class="si">{</span><span class="n">alternatives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-28-32">            <span class="p">)</span>
</span><span id="__span-28-33">
</span><span id="__span-28-34">        <span class="c1"># Retry with different parameters</span>
</span><span id="__span-28-35">        <span class="k">return</span> <span class="n">RecoveryAction</span><span class="p">(</span>
</span><span id="__span-28-36">            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;retry_with_params&#39;</span><span class="p">,</span>
</span><span id="__span-28-37">            <span class="n">new_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">},</span>
</span><span id="__span-28-38">            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Retrying with extended timeout&quot;</span>
</span><span id="__span-28-39">        <span class="p">)</span>
</span><span id="__span-28-40">
</span><span id="__span-28-41">    <span class="k">def</span><span class="w"> </span><span class="nf">_recover_timeout_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">TimeoutError</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RecoveryAction</span><span class="p">:</span>
</span><span id="__span-28-42"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recover from timeout errors.&quot;&quot;&quot;</span>
</span><span id="__span-28-43">        <span class="c1"># Reduce analysis scope</span>
</span><span id="__span-28-44">        <span class="k">return</span> <span class="n">RecoveryAction</span><span class="p">(</span>
</span><span id="__span-28-45">            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;reduce_scope&#39;</span><span class="p">,</span>
</span><span id="__span-28-46">            <span class="n">new_scope</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">,</span>
</span><span id="__span-28-47">            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Reducing analysis scope to basic level&quot;</span>
</span><span id="__span-28-48">        <span class="p">)</span>
</span><span id="__span-28-49">
</span><span id="__span-28-50">    <span class="k">def</span><span class="w"> </span><span class="nf">_recover_network_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">NetworkError</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RecoveryAction</span><span class="p">:</span>
</span><span id="__span-28-51"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Recover from network errors.&quot;&quot;&quot;</span>
</span><span id="__span-28-52">        <span class="c1"># Implement exponential backoff</span>
</span><span id="__span-28-53">        <span class="k">return</span> <span class="n">RecoveryAction</span><span class="p">(</span>
</span><span id="__span-28-54">            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;retry_with_backoff&#39;</span><span class="p">,</span>
</span><span id="__span-28-55">            <span class="n">backoff_seconds</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
</span><span id="__span-28-56">            <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="__span-28-57">            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Retrying with exponential backoff&quot;</span>
</span><span id="__span-28-58">        <span class="p">)</span>
</span></code></pre></div>
<h4 id="manual-intervention">Manual Intervention</h4>
<p>For errors requiring human intervention:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><span class="k">class</span><span class="w"> </span><span class="nc">ManualInterventionHandler</span><span class="p">:</span>
</span><span id="__span-29-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles errors requiring manual intervention.&quot;&quot;&quot;</span>
</span><span id="__span-29-3">
</span><span id="__span-29-4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notification_system</span><span class="p">):</span>
</span><span id="__span-29-5">        <span class="bp">self</span><span class="o">.</span><span class="n">notifications</span> <span class="o">=</span> <span class="n">notification_system</span>
</span><span id="__span-29-6">
</span><span id="__span-29-7">    <span class="k">def</span><span class="w"> </span><span class="nf">handle_manual_intervention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-29-8"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle errors requiring manual intervention.&quot;&quot;&quot;</span>
</span><span id="__span-29-9">
</span><span id="__span-29-10">        <span class="c1"># Create intervention request</span>
</span><span id="__span-29-11">        <span class="n">intervention</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-29-12">            <span class="s1">&#39;error_type&#39;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="__span-29-13">            <span class="s1">&#39;error_message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">),</span>
</span><span id="__span-29-14">            <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">context</span><span class="p">,</span>
</span><span id="__span-29-15">            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-29-16">            <span class="s1">&#39;possible_actions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suggest_actions</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</span><span id="__span-29-17">        <span class="p">}</span>
</span><span id="__span-29-18">
</span><span id="__span-29-19">        <span class="c1"># Notify administrators</span>
</span><span id="__span-29-20">        <span class="bp">self</span><span class="o">.</span><span class="n">notifications</span><span class="o">.</span><span class="n">send_alert</span><span class="p">(</span>
</span><span id="__span-29-21">            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Manual Intervention Required&quot;</span><span class="p">,</span>
</span><span id="__span-29-22">            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Audit </span><span class="si">{</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;audit_id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> requires manual intervention&quot;</span><span class="p">,</span>
</span><span id="__span-29-23">            <span class="n">details</span><span class="o">=</span><span class="n">intervention</span>
</span><span id="__span-29-24">        <span class="p">)</span>
</span><span id="__span-29-25">
</span><span id="__span-29-26">        <span class="c1"># Pause audit</span>
</span><span id="__span-29-27">        <span class="n">audit_manager</span><span class="o">.</span><span class="n">pause_audit</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;audit_id&#39;</span><span class="p">))</span>
</span><span id="__span-29-28">
</span><span id="__span-29-29">    <span class="k">def</span><span class="w"> </span><span class="nf">_suggest_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-29-30"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Suggest possible manual actions.&quot;&quot;&quot;</span>
</span><span id="__span-29-31">        <span class="n">suggestions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-29-32">
</span><span id="__span-29-33">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">ToolError</span><span class="p">):</span>
</span><span id="__span-29-34">            <span class="n">suggestions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="__span-29-35">                <span class="s2">&quot;Check tool installation and version&quot;</span><span class="p">,</span>
</span><span id="__span-29-36">                <span class="s2">&quot;Verify tool configuration and permissions&quot;</span><span class="p">,</span>
</span><span id="__span-29-37">                <span class="s2">&quot;Review tool-specific documentation&quot;</span><span class="p">,</span>
</span><span id="__span-29-38">                <span class="s2">&quot;Consider using alternative tool&quot;</span>
</span><span id="__span-29-39">            <span class="p">])</span>
</span><span id="__span-29-40">
</span><span id="__span-29-41">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">ConfigurationError</span><span class="p">):</span>
</span><span id="__span-29-42">            <span class="n">suggestions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span><span id="__span-29-43">                <span class="s2">&quot;Review configuration file syntax&quot;</span><span class="p">,</span>
</span><span id="__span-29-44">                <span class="s2">&quot;Check environment variables&quot;</span><span class="p">,</span>
</span><span id="__span-29-45">                <span class="s2">&quot;Validate parameter values&quot;</span><span class="p">,</span>
</span><span id="__span-29-46">                <span class="s2">&quot;Consult configuration documentation&quot;</span>
</span><span id="__span-29-47">            <span class="p">])</span>
</span><span id="__span-29-48">
</span><span id="__span-29-49">        <span class="k">return</span> <span class="n">suggestions</span>
</span></code></pre></div>
<h3 id="error-reporting">Error Reporting</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><span class="k">class</span><span class="w"> </span><span class="nc">ErrorReporter</span><span class="p">:</span>
</span><span id="__span-30-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Centralized error reporting and aggregation.&quot;&quot;&quot;</span>
</span><span id="__span-30-3">
</span><span id="__span-30-4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_connection</span><span class="p">,</span> <span class="n">metrics_system</span><span class="p">):</span>
</span><span id="__span-30-5">        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db_connection</span>
</span><span id="__span-30-6">        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="n">metrics_system</span>
</span><span id="__span-30-7">
</span><span id="__span-30-8">    <span class="k">def</span><span class="w"> </span><span class="nf">report_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-30-9"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Report error to centralized system.&quot;&quot;&quot;</span>
</span><span id="__span-30-10">
</span><span id="__span-30-11">        <span class="n">error_record</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-30-12">            <span class="s1">&#39;error_type&#39;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
</span><span id="__span-30-13">            <span class="s1">&#39;error_message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">),</span>
</span><span id="__span-30-14">            <span class="s1">&#39;stack_trace&#39;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
</span><span id="__span-30-15">            <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">context</span><span class="p">,</span>
</span><span id="__span-30-16">            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
</span><span id="__span-30-17">            <span class="s1">&#39;audit_id&#39;</span><span class="p">:</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;audit_id&#39;</span><span class="p">),</span>
</span><span id="__span-30-18">            <span class="s1">&#39;agent_name&#39;</span><span class="p">:</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent_name&#39;</span><span class="p">),</span>
</span><span id="__span-30-19">            <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_error_severity</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</span><span id="__span-30-20">        <span class="p">}</span>
</span><span id="__span-30-21">
</span><span id="__span-30-22">        <span class="c1"># Store in database</span>
</span><span id="__span-30-23">        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-30-24"><span class="s2">            INSERT INTO error_logs</span>
</span><span id="__span-30-25"><span class="s2">            (error_type, error_message, stack_trace, context, timestamp, audit_id, agent_name, severity)</span>
</span><span id="__span-30-26"><span class="s2">            VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)</span>
</span><span id="__span-30-27"><span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span>
</span><span id="__span-30-28">            <span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;error_type&#39;</span><span class="p">],</span>
</span><span id="__span-30-29">            <span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;error_message&#39;</span><span class="p">],</span>
</span><span id="__span-30-30">            <span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;stack_trace&#39;</span><span class="p">],</span>
</span><span id="__span-30-31">            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;context&#39;</span><span class="p">]),</span>
</span><span id="__span-30-32">            <span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span>
</span><span id="__span-30-33">            <span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;audit_id&#39;</span><span class="p">],</span>
</span><span id="__span-30-34">            <span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;agent_name&#39;</span><span class="p">],</span>
</span><span id="__span-30-35">            <span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span>
</span><span id="__span-30-36">        <span class="p">))</span>
</span><span id="__span-30-37">
</span><span id="__span-30-38">        <span class="c1"># Update metrics</span>
</span><span id="__span-30-39">        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">increment_counter</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;errors.</span><span class="si">{</span><span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;error_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-30-40">        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">increment_counter</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;errors.severity.</span><span class="si">{</span><span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-30-41">
</span><span id="__span-30-42">        <span class="c1"># Trigger alerts for critical errors</span>
</span><span id="__span-30-43">        <span class="k">if</span> <span class="n">error_record</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;critical&#39;</span><span class="p">:</span>
</span><span id="__span-30-44">            <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_critical_alert</span><span class="p">(</span><span class="n">error_record</span><span class="p">)</span>
</span><span id="__span-30-45">
</span><span id="__span-30-46">    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_error_severity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-30-47"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate error severity level.&quot;&quot;&quot;</span>
</span><span id="__span-30-48">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="p">(</span><span class="ne">SystemExit</span><span class="p">,</span> <span class="ne">KeyboardInterrupt</span><span class="p">)):</span>
</span><span id="__span-30-49">            <span class="k">return</span> <span class="s1">&#39;critical&#39;</span>
</span><span id="__span-30-50">        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="p">(</span><span class="n">DatabaseError</span><span class="p">,</span> <span class="n">NetworkError</span><span class="p">)):</span>
</span><span id="__span-30-51">            <span class="k">return</span> <span class="s1">&#39;high&#39;</span>
</span><span id="__span-30-52">        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="ne">TimeoutError</span><span class="p">):</span>
</span><span id="__span-30-53">            <span class="k">return</span> <span class="s1">&#39;medium&#39;</span>
</span><span id="__span-30-54">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-30-55">            <span class="k">return</span> <span class="s1">&#39;low&#39;</span>
</span></code></pre></div>
<hr />
<h2 id="performance-optimization">Performance Optimization</h2>
<h3 id="parallel-processing">Parallel Processing</h3>
<h4 id="task-parallelization">Task Parallelization</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-31-1"><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-31-2"><span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessPoolExecutor</span>
</span><span id="__span-31-3"><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>
</span><span id="__span-31-4">
</span><span id="__span-31-5"><span class="k">class</span><span class="w"> </span><span class="nc">ParallelProcessor</span><span class="p">:</span>
</span><span id="__span-31-6"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles parallel processing of audit tasks.&quot;&quot;&quot;</span>
</span><span id="__span-31-7">
</span><span id="__span-31-8">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-31-9">        <span class="bp">self</span><span class="o">.</span><span class="n">max_workers</span> <span class="o">=</span> <span class="n">max_workers</span> <span class="ow">or</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
</span><span id="__span-31-10">        <span class="bp">self</span><span class="o">.</span><span class="n">executor</span> <span class="o">=</span> <span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_workers</span><span class="p">)</span>
</span><span id="__span-31-11">
</span><span id="__span-31-12">    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_parallel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="__span-31-13"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process tasks in parallel.&quot;&quot;&quot;</span>
</span><span id="__span-31-14">
</span><span id="__span-31-15">        <span class="c1"># Create async tasks</span>
</span><span id="__span-31-16">        <span class="n">async_tasks</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-31-17">        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
</span><span id="__span-31-18">            <span class="n">async_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">run_in_executor</span><span class="p">(</span>
</span><span id="__span-31-19">                <span class="bp">self</span><span class="o">.</span><span class="n">executor</span><span class="p">,</span>
</span><span id="__span-31-20">                <span class="bp">self</span><span class="o">.</span><span class="n">_execute_task</span><span class="p">,</span>
</span><span id="__span-31-21">                <span class="n">task</span>
</span><span id="__span-31-22">            <span class="p">)</span>
</span><span id="__span-31-23">            <span class="n">async_tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">async_task</span><span class="p">)</span>
</span><span id="__span-31-24">
</span><span id="__span-31-25">        <span class="c1"># Wait for all tasks to complete</span>
</span><span id="__span-31-26">        <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">async_tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-31-27">
</span><span id="__span-31-28">        <span class="c1"># Handle results and exceptions</span>
</span><span id="__span-31-29">        <span class="n">processed_results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-31-30">        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
</span><span id="__span-31-31">            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>
</span><span id="__span-31-32">                <span class="c1"># Handle task failure</span>
</span><span id="__span-31-33">                <span class="n">processed_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="__span-31-34">                    <span class="s1">&#39;task_id&#39;</span><span class="p">:</span> <span class="n">tasks</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
</span><span id="__span-31-35">                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;failed&#39;</span><span class="p">,</span>
</span><span id="__span-31-36">                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="__span-31-37">                <span class="p">})</span>
</span><span id="__span-31-38">            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-31-39">                <span class="n">processed_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="__span-31-40">
</span><span id="__span-31-41">        <span class="k">return</span> <span class="n">processed_results</span>
</span><span id="__span-31-42">
</span><span id="__span-31-43">    <span class="k">def</span><span class="w"> </span><span class="nf">_execute_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-31-44"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute individual task.&quot;&quot;&quot;</span>
</span><span id="__span-31-45">        <span class="n">task_type</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
</span><span id="__span-31-46">
</span><span id="__span-31-47">        <span class="k">if</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;static_analysis&#39;</span><span class="p">:</span>
</span><span id="__span-31-48">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_static_analysis</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
</span><span id="__span-31-49">        <span class="k">elif</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;ml_analysis&#39;</span><span class="p">:</span>
</span><span id="__span-31-50">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_ml_analysis</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
</span><span id="__span-31-51">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-31-52">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown task type: </span><span class="si">{</span><span class="n">task_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="load-balancing">Load Balancing</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><span class="k">class</span><span class="w"> </span><span class="nc">LoadBalancer</span><span class="p">:</span>
</span><span id="__span-32-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Distributes workload across available resources.&quot;&quot;&quot;</span>
</span><span id="__span-32-3">
</span><span id="__span-32-4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]):</span>
</span><span id="__span-32-5">        <span class="bp">self</span><span class="o">.</span><span class="n">workers</span> <span class="o">=</span> <span class="n">workers</span>  <span class="c1"># [{&#39;id&#39;: &#39;worker1&#39;, &#39;capacity&#39;: 10, &#39;current_load&#39;: 0}]</span>
</span><span id="__span-32-6">        <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
</span><span id="__span-32-7">
</span><span id="__span-32-8">    <span class="k">def</span><span class="w"> </span><span class="nf">distribute_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-32-9"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Distribute task to least loaded worker.&quot;&quot;&quot;</span>
</span><span id="__span-32-10">
</span><span id="__span-32-11">        <span class="c1"># Find worker with lowest load</span>
</span><span id="__span-32-12">        <span class="n">available_workers</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span> <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="s1">&#39;current_load&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">w</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">]]</span>
</span><span id="__span-32-13">        <span class="k">if</span> <span class="ow">not</span> <span class="n">available_workers</span><span class="p">:</span>
</span><span id="__span-32-14">            <span class="k">raise</span> <span class="n">ResourceExhaustedError</span><span class="p">(</span><span class="s2">&quot;No available workers&quot;</span><span class="p">)</span>
</span><span id="__span-32-15">
</span><span id="__span-32-16">        <span class="n">best_worker</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">available_workers</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span><span class="p">[</span><span class="s1">&#39;current_load&#39;</span><span class="p">])</span>
</span><span id="__span-32-17">
</span><span id="__span-32-18">        <span class="c1"># Assign task to worker</span>
</span><span id="__span-32-19">        <span class="n">best_worker</span><span class="p">[</span><span class="s1">&#39;current_load&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-32-20">
</span><span id="__span-32-21">        <span class="k">return</span> <span class="n">best_worker</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span><span id="__span-32-22">
</span><span id="__span-32-23">    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-32-24"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process tasks from queue.&quot;&quot;&quot;</span>
</span><span id="__span-32-25">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-32-26">            <span class="n">task</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="__span-32-27">
</span><span id="__span-32-28">            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-32-29">                <span class="n">worker_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribute_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
</span><span id="__span-32-30">                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send_to_worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">,</span> <span class="n">task</span><span class="p">)</span>
</span><span id="__span-32-31">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-32-32">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to distribute task </span><span class="si">{</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-32-33">            <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-32-34">                <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="caching-and-memoization">Caching and Memoization</h3>
<h4 id="analysis-result-caching">Analysis Result Caching</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-33-1"><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
</span><span id="__span-33-2"><span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">lru_cache</span>
</span><span id="__span-33-3"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
</span><span id="__span-33-4"><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</span><span id="__span-33-5">
</span><span id="__span-33-6"><span class="k">class</span><span class="w"> </span><span class="nc">AnalysisCache</span><span class="p">:</span>
</span><span id="__span-33-7"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Caches analysis results to improve performance.&quot;&quot;&quot;</span>
</span><span id="__span-33-8">
</span><span id="__span-33-9">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./.audit_cache&quot;</span><span class="p">,</span> <span class="n">max_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
</span><span id="__span-33-10">        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">)</span>
</span><span id="__span-33-11">        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-33-12">        <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">=</span> <span class="n">max_size</span>
</span><span id="__span-33-13">        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># key -&gt; file_path</span>
</span><span id="__span-33-14">
</span><span id="__span-33-15">    <span class="k">def</span><span class="w"> </span><span class="nf">get_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">analysis_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-33-16"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate cache key from inputs.&quot;&quot;&quot;</span>
</span><span id="__span-33-17">        <span class="n">key_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-33-18">            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
</span><span id="__span-33-19">            <span class="s1">&#39;analysis_type&#39;</span><span class="p">:</span> <span class="n">analysis_type</span><span class="p">,</span>
</span><span id="__span-33-20">            <span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="n">config</span>
</span><span id="__span-33-21">        <span class="p">}</span>
</span><span id="__span-33-22">        <span class="n">key_string</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">key_data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-33-23">        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">key_string</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span><span id="__span-33-24">
</span><span id="__span-33-25">    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span><span id="__span-33-26"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve cached result.&quot;&quot;&quot;</span>
</span><span id="__span-33-27">        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">:</span>
</span><span id="__span-33-28">            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-33-29">
</span><span id="__span-33-30">        <span class="n">cache_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-33-31">
</span><span id="__span-33-32">        <span class="k">if</span> <span class="ow">not</span> <span class="n">cache_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-33-33">            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-33-34">            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-33-35">
</span><span id="__span-33-36">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-33-37">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-33-38">                <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-33-39">        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="__span-33-40">            <span class="c1"># Corrupted cache file</span>
</span><span id="__span-33-41">            <span class="n">cache_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span><span id="__span-33-42">            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-33-43">            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-33-44">
</span><span id="__span-33-45">    <span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
</span><span id="__span-33-46"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Store result in cache.&quot;&quot;&quot;</span>
</span><span id="__span-33-47">        <span class="c1"># Evict old entries if cache is full</span>
</span><span id="__span-33-48">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">:</span>
</span><span id="__span-33-49">            <span class="bp">self</span><span class="o">.</span><span class="n">_evict_oldest</span><span class="p">()</span>
</span><span id="__span-33-50">
</span><span id="__span-33-51">        <span class="c1"># Generate cache file path</span>
</span><span id="__span-33-52">        <span class="n">cache_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">.pkl&quot;</span>
</span><span id="__span-33-53">
</span><span id="__span-33-54">        <span class="c1"># Store result</span>
</span><span id="__span-33-55">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-33-56">            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="__span-33-57">
</span><span id="__span-33-58">        <span class="c1"># Update index</span>
</span><span id="__span-33-59">        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">.pkl&quot;</span>
</span><span id="__span-33-60">
</span><span id="__span-33-61">    <span class="k">def</span><span class="w"> </span><span class="nf">_evict_oldest</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-33-62"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Evict oldest cache entries.&quot;&quot;&quot;</span>
</span><span id="__span-33-63">        <span class="c1"># Simple LRU eviction - remove half of entries</span>
</span><span id="__span-33-64">        <span class="n">items_to_remove</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-33-65">
</span><span id="__span-33-66">        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="n">items_to_remove</span><span class="p">]:</span>
</span><span id="__span-33-67">            <span class="n">cache_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-33-68">            <span class="k">if</span> <span class="n">cache_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-33-69">                <span class="n">cache_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span><span id="__span-33-70">            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_index</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="__span-33-71">
</span><span id="__span-33-72"><span class="c1"># Usage with memoization</span>
</span><span id="__span-33-73"><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</span><span id="__span-33-74"><span class="k">def</span><span class="w"> </span><span class="nf">cached_static_analysis</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
</span><span id="__span-33-75"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Cached static analysis function.&quot;&quot;&quot;</span>
</span><span id="__span-33-76">    <span class="n">cache</span> <span class="o">=</span> <span class="n">AnalysisCache</span><span class="p">()</span>
</span><span id="__span-33-77">    <span class="n">cache_key</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_cache_key</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;static_</span><span class="si">{</span><span class="n">tool</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;config_hash&quot;</span><span class="p">:</span> <span class="n">config_hash</span><span class="p">})</span>
</span><span id="__span-33-78">
</span><span id="__span-33-79">    <span class="c1"># Check cache first</span>
</span><span id="__span-33-80">    <span class="n">cached_result</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
</span><span id="__span-33-81">    <span class="k">if</span> <span class="n">cached_result</span><span class="p">:</span>
</span><span id="__span-33-82">        <span class="k">return</span> <span class="n">cached_result</span>
</span><span id="__span-33-83">
</span><span id="__span-33-84">    <span class="c1"># Perform analysis</span>
</span><span id="__span-33-85">    <span class="n">result</span> <span class="o">=</span> <span class="n">perform_static_analysis</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">tool</span><span class="p">)</span>
</span><span id="__span-33-86">
</span><span id="__span-33-87">    <span class="c1"># Cache result</span>
</span><span id="__span-33-88">    <span class="n">cache</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span><span id="__span-33-89">
</span><span id="__span-33-90">    <span class="k">return</span> <span class="n">result</span>
</span></code></pre></div>
<h3 id="resource-optimization">Resource Optimization</h3>
<h4 id="memory-management">Memory Management</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><span class="k">class</span><span class="w"> </span><span class="nc">MemoryManager</span><span class="p">:</span>
</span><span id="__span-34-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages memory usage during analysis.&quot;&quot;&quot;</span>
</span><span id="__span-34-3">
</span><span id="__span-34-4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_memory_gb</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">):</span>
</span><span id="__span-34-5">        <span class="bp">self</span><span class="o">.</span><span class="n">max_memory_gb</span> <span class="o">=</span> <span class="n">max_memory_gb</span>
</span><span id="__span-34-6">        <span class="bp">self</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
</span><span id="__span-34-7">
</span><span id="__span-34-8">    <span class="k">def</span><span class="w"> </span><span class="nf">check_memory_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-34-9"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check current memory usage in GB.&quot;&quot;&quot;</span>
</span><span id="__span-34-10">        <span class="n">memory_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span>
</span><span id="__span-34-11">        <span class="k">return</span> <span class="n">memory_info</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Convert to GB</span>
</span><span id="__span-34-12">
</span><span id="__span-34-13">    <span class="k">def</span><span class="w"> </span><span class="nf">should_reduce_load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-34-14"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if memory usage is too high.&quot;&quot;&quot;</span>
</span><span id="__span-34-15">        <span class="n">current_usage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_memory_usage</span><span class="p">()</span>
</span><span id="__span-34-16">        <span class="k">return</span> <span class="n">current_usage</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_memory_gb</span> <span class="o">*</span> <span class="mf">0.8</span>  <span class="c1"># 80% threshold</span>
</span><span id="__span-34-17">
</span><span id="__span-34-18">    <span class="k">def</span><span class="w"> </span><span class="nf">optimize_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-34-19"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform memory optimization.&quot;&quot;&quot;</span>
</span><span id="__span-34-20">        <span class="c1"># Force garbage collection</span>
</span><span id="__span-34-21">        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span><span id="__span-34-22">
</span><span id="__span-34-23">        <span class="c1"># Clear any caches if necessary</span>
</span><span id="__span-34-24">        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;analysis_cache&#39;</span><span class="p">):</span>
</span><span id="__span-34-25">            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="__span-34-26">
</span><span id="__span-34-27">        <span class="c1"># Reduce worker pool size if needed</span>
</span><span id="__span-34-28">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_reduce_load</span><span class="p">():</span>
</span><span id="__span-34-29">            <span class="bp">self</span><span class="o">.</span><span class="n">_reduce_worker_pool</span><span class="p">()</span>
</span><span id="__span-34-30">
</span><span id="__span-34-31">    <span class="k">def</span><span class="w"> </span><span class="nf">_reduce_worker_pool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-34-32"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce the number of active workers.&quot;&quot;&quot;</span>
</span><span id="__span-34-33">        <span class="c1"># Implementation depends on parallel processing setup</span>
</span><span id="__span-34-34">        <span class="k">pass</span>
</span></code></pre></div>
<h4 id="cpu-optimization">CPU Optimization</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-35-1"><span class="k">class</span><span class="w"> </span><span class="nc">CPUOptimizer</span><span class="p">:</span>
</span><span id="__span-35-2"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimizes CPU usage for analysis tasks.&quot;&quot;&quot;</span>
</span><span id="__span-35-3">
</span><span id="__span-35-4">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-35-5">        <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
</span><span id="__span-35-6">
</span><span id="__span-35-7">    <span class="k">def</span><span class="w"> </span><span class="nf">get_optimal_worker_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-35-8"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get optimal number of workers for task type.&quot;&quot;&quot;</span>
</span><span id="__span-35-9">
</span><span id="__span-35-10">        <span class="k">if</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;cpu_intensive&#39;</span><span class="p">:</span>
</span><span id="__span-35-11">            <span class="c1"># Use all cores for CPU-intensive tasks</span>
</span><span id="__span-35-12">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span>
</span><span id="__span-35-13">        <span class="k">elif</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;io_intensive&#39;</span><span class="p">:</span>
</span><span id="__span-35-14">            <span class="c1"># Use more workers for I/O intensive tasks</span>
</span><span id="__span-35-15">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="__span-35-16">        <span class="k">elif</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;memory_intensive&#39;</span><span class="p">:</span>
</span><span id="__span-35-17">            <span class="c1"># Use fewer workers for memory-intensive tasks</span>
</span><span id="__span-35-18">            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-35-19">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-35-20">            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-35-21">
</span><span id="__span-35-22">    <span class="k">def</span><span class="w"> </span><span class="nf">throttle_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-35-23"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Throttle processing if CPU usage is too high.&quot;&quot;&quot;</span>
</span><span id="__span-35-24">        <span class="n">cpu_percent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-35-25">
</span><span id="__span-35-26">        <span class="k">if</span> <span class="n">cpu_percent</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
</span><span id="__span-35-27">            <span class="c1"># High CPU usage - add delay</span>
</span><span id="__span-35-28">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="__span-35-29">        <span class="k">elif</span> <span class="n">cpu_percent</span> <span class="o">&gt;</span> <span class="mi">75</span><span class="p">:</span>
</span><span id="__span-35-30">            <span class="c1"># Moderate CPU usage - slight delay</span>
</span><span id="__span-35-31">            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</span></code></pre></div>
<p>This comprehensive documentation covers the workflow, data flow, agent communication, and performance optimization aspects of the Web3 Security Auditing AI System.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "navigation.path", "navigation.sections", "navigation.expand", "content.code.annotate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>