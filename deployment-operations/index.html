
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/imago.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Deployment and Operational Guidance - CAI</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deployment-and-operational-guidance" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CAI" class="md-header__button md-logo" aria-label="CAI" data-md-component="logo">
      
  <img src="../assets/imago.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CAI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deployment and Operational Guidance
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aliasrobotics/cai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aliasrobotics/cai
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CAI" class="md-nav__button md-logo" aria-label="CAI" data-md-component="logo">
      
  <img src="../assets/imago.png" alt="logo">

    </a>
    CAI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aliasrobotics/cai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aliasrobotics/cai
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Professional Edition
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Professional Edition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ü§î Why CAI PRO?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_alias1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚≠ê Alias1 Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üî• Exclusive Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚≠ê API Server (CAI PRO)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_pricing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üí∞ Pricing & Plans
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üöÄ Get Started with PRO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_contact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìû Contact Sales
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Interfaces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Mobile UI (iOS)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Mobile UI (iOS)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/mui_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/user_interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/gestures_shortcuts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gestures & Shortcuts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/chat_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chat Features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Terminal UI (TUI)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Terminal UI (TUI)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/tui_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/user_interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/terminals_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terminals Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/teams_and_parallel_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Teams & Parallel Execution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/sidebar_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sidebar Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/keyboard_shortcuts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Keyboard Shortcuts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/commands_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/advanced_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Command Line Interface (CLI)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Command Line Interface (CLI)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/cli_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/commands_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/advanced_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Core Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Core Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoffs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Agent Systems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../judge_gate_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Judge Gate Pipeline (Hunter ‚Üí Judge ‚Üí PoC)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Models & Providers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Models & Providers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_list_of_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Available Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Providers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Model Providers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/openrouter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenRouter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/ollama/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ollama
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure OpenAI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running_agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../continue_mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continue Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../session_resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Session Resume
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Streaming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tracing & Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guardrails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrails & Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../council/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLM Council
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grit (Audit Persistence)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Variables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Benchmarking
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Benchmarking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/running_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/attack_defense/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attack & Defense CTFs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/jeopardy_ctfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jeopardy CTFs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/cyber_ranges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cyber Ranges
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/knowledge_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/privacy_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Privacy Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../research/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../research_docs_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research Docs Index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            Agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/result/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Result
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/stream_events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stream Events
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/handoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoffs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lifecycle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/items/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Items
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/run_context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Run Context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/guardrail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrail
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/model_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/agent_output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Output
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/function_schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Function Schema
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/openai_chatcompletions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI Chat Completions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/openai_responses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI Responses
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Extensions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Extensions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/extensions/handoff_filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoff Filters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/extensions/handoff_prompt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoff Prompt
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_find_us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Find Us
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_citation_and_acknowledgments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Citation & Acknowledgments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      System Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hardware Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimum-requirements-developmenttesting" class="md-nav__link">
    <span class="md-ellipsis">
      Minimum Requirements (Development/Testing)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-requirements-production-small-scale" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended Requirements (Production - Small Scale)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enterprise-requirements-production-large-scale" class="md-nav__link">
    <span class="md-ellipsis">
      Enterprise Requirements (Production - Large Scale)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Software Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Software Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operating-system" class="md-nav__link">
    <span class="md-ellipsis">
      Operating System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runtime-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Runtime Dependencies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-tools" class="md-nav__link">
    <span class="md-ellipsis">
      External Tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Network Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Network Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inbound-connections" class="md-nav__link">
    <span class="md-ellipsis">
      Inbound Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outbound-connections" class="md-nav__link">
    <span class="md-ellipsis">
      Outbound Connections
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-and-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Installation and Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installation and Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Automated Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automated Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-ansible-recommended-for-production" class="md-nav__link">
    <span class="md-ellipsis">
      Using Ansible (Recommended for Production)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-compose-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Compose Deployment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-by-step-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-management" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-files" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Main Configuration File
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Environment Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Required Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Optional Variables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment Strategies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment Strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blue-green-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Blue-Green Deployment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rolling-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Rolling Deployment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canary-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Canary Deployment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-and-observability" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring and Observability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring and Observability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Application Metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Application Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prometheus-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Prometheus Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Health Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Logging Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alerting" class="md-nav__link">
    <span class="md-ellipsis">
      Alerting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Tuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Tuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      CPU Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Database Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caching-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Caching Strategies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup-and-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Backup and Recovery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Backup and Recovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database-backup" class="md-nav__link">
    <span class="md-ellipsis">
      Database Backup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-backup" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Backup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-system-backup" class="md-nav__link">
    <span class="md-ellipsis">
      File System Backup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recovery Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Database Recovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Application Recovery
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disaster-recovery-plan" class="md-nav__link">
    <span class="md-ellipsis">
      Disaster Recovery Plan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Disaster Recovery Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recovery-time-objectives-rto" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery Time Objectives (RTO)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-point-objectives-rpo" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery Point Objectives (RPO)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dr-testing-schedule" class="md-nav__link">
    <span class="md-ellipsis">
      DR Testing Schedule
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      Security Hardening
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Hardening">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      System Hardening
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-security" class="md-nav__link">
    <span class="md-ellipsis">
      Application Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="deployment-and-operational-guidance">Deployment and Operational Guidance</h1>
<p>This document provides comprehensive guidance for deploying, operating, and maintaining the Web3 Security Auditing AI System in production environments.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#system-requirements">System Requirements</a></li>
<li><a href="#installation-and-setup">Installation and Setup</a></li>
<li><a href="#configuration-management">Configuration Management</a></li>
<li><a href="#deployment-strategies">Deployment Strategies</a></li>
<li><a href="#monitoring-and-observability">Monitoring and Observability</a></li>
<li><a href="#performance-tuning">Performance Tuning</a></li>
<li><a href="#backup-and-recovery">Backup and Recovery</a></li>
<li><a href="#security-hardening">Security Hardening</a></li>
<li><a href="#maintenance-procedures">Maintenance Procedures</a></li>
<li><a href="#troubleshooting-production-issues">Troubleshooting Production Issues</a></li>
<li><a href="#scaling-and-high-availability">Scaling and High Availability</a></li>
</ul>
<hr />
<h2 id="system-requirements">System Requirements</h2>
<h3 id="hardware-requirements">Hardware Requirements</h3>
<h4 id="minimum-requirements-developmenttesting">Minimum Requirements (Development/Testing)</h4>
<ul>
<li><strong>CPU</strong>: 4 cores (2.5 GHz base frequency)</li>
<li><strong>RAM</strong>: 8 GB</li>
<li><strong>Storage</strong>: 50 GB SSD</li>
<li><strong>Network</strong>: 10 Mbps stable connection</li>
</ul>
<h4 id="recommended-requirements-production-small-scale">Recommended Requirements (Production - Small Scale)</h4>
<ul>
<li><strong>CPU</strong>: 8 cores (3.0 GHz+)</li>
<li><strong>RAM</strong>: 16 GB</li>
<li><strong>Storage</strong>: 100 GB SSD + 500 GB HDD for archives</li>
<li><strong>Network</strong>: 100 Mbps dedicated connection</li>
<li><strong>GPU</strong>: Optional, NVIDIA GPU with 4GB+ VRAM for ML acceleration</li>
</ul>
<h4 id="enterprise-requirements-production-large-scale">Enterprise Requirements (Production - Large Scale)</h4>
<ul>
<li><strong>CPU</strong>: 16+ cores (3.5 GHz+)</li>
<li><strong>RAM</strong>: 64 GB+</li>
<li><strong>Storage</strong>: 500 GB SSD + 2TB+ HDD/NAS for archives</li>
<li><strong>Network</strong>: 1 Gbps dedicated connection</li>
<li><strong>GPU</strong>: NVIDIA GPU with 8GB+ VRAM (recommended for ML features)</li>
</ul>
<h3 id="software-requirements">Software Requirements</h3>
<h4 id="operating-system">Operating System</h4>
<ul>
<li><strong>Linux</strong>: Ubuntu 20.04+, CentOS 8+, RHEL 8+</li>
<li><strong>macOS</strong>: 12.0+ (for development)</li>
<li><strong>Windows</strong>: Windows 10/11 with WSL2 (for development)</li>
</ul>
<h4 id="runtime-dependencies">Runtime Dependencies</h4>
<ul>
<li><strong>Python</strong>: 3.12.0+</li>
<li><strong>Node.js</strong>: 18.0+ (for some analysis tools)</li>
<li><strong>Docker</strong>: 24.0+ (for containerized tools)</li>
<li><strong>Database</strong>: PostgreSQL 13+ or MongoDB 5+</li>
</ul>
<h4 id="external-tools">External Tools</h4>
<ul>
<li><strong>Slither</strong>: 0.10.0+</li>
<li><strong>Mythril</strong>: Latest stable</li>
<li><strong>Solc</strong>: 0.8.19+</li>
<li><strong>Git</strong>: 2.30+</li>
</ul>
<h3 id="network-requirements">Network Requirements</h3>
<h4 id="inbound-connections">Inbound Connections</h4>
<ul>
<li><strong>HTTPS</strong>: Port 443 (API and web interface)</li>
<li><strong>SSH</strong>: Port 22 (administrative access)</li>
<li><strong>Database</strong>: Port 5432 (PostgreSQL) or 27017 (MongoDB)</li>
</ul>
<h4 id="outbound-connections">Outbound Connections</h4>
<ul>
<li><strong>Blockchain Nodes</strong>: Various ports for Ethereum, Polygon, etc.</li>
<li><strong>AI APIs</strong>: OpenAI, Anthropic, etc. (if using cloud models)</li>
<li><strong>Security Databases</strong>: CVE databases, threat intelligence feeds</li>
<li><strong>Update Servers</strong>: For tool and system updates</li>
</ul>
<hr />
<h2 id="installation-and-setup">Installation and Setup</h2>
<h3 id="automated-installation">Automated Installation</h3>
<h4 id="using-ansible-recommended-for-production">Using Ansible (Recommended for Production)</h4>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><span class="c1"># inventory.ini</span>
</span><span id="__span-0-2"><span class="p p-Indicator">[</span><span class="nv">audit_servers</span><span class="p p-Indicator">]</span>
</span><span id="__span-0-3"><span class="l l-Scalar l-Scalar-Plain">audit01 ansible_host=192.168.1.10</span>
</span><span id="__span-0-4"><span class="l l-Scalar l-Scalar-Plain">audit02 ansible_host=192.168.1.11</span>
</span><span id="__span-0-5">
</span><span id="__span-0-6"><span class="l l-Scalar l-Scalar-Plain">[databases]</span>
</span><span id="__span-0-7"><span class="l l-Scalar l-Scalar-Plain">db01 ansible_host=192.168.1.20</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="l l-Scalar l-Scalar-Plain"># playbook.yml</span>
</span><span id="__span-0-10"><span class="nn">---</span>
</span><span id="__span-0-11"><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deploy Web3 Security Audit System</span>
</span><span id="__span-0-12"><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">audit_servers</span>
</span><span id="__span-0-13"><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-0-14"><span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
</span><span id="__span-0-15"><span class="w">    </span><span class="nt">web3_audit_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.1.0&quot;</span>
</span><span id="__span-0-16"><span class="w">    </span><span class="nt">db_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">groups[&#39;databases&#39;][0]</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-0-17">
</span><span id="__span-0-18"><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-0-19"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install system dependencies</span>
</span><span id="__span-0-20"><span class="w">      </span><span class="nt">apt</span><span class="p">:</span>
</span><span id="__span-0-21"><span class="w">        </span><span class="nt">name</span><span class="p">:</span>
</span><span id="__span-0-22"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3.12</span>
</span><span id="__span-0-23"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3.12-venv</span>
</span><span id="__span-0-24"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql-client</span>
</span><span id="__span-0-25"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker.io</span>
</span><span id="__span-0-26"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">git</span>
</span><span id="__span-0-27"><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-0-28"><span class="w">        </span><span class="nt">update_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-0-29">
</span><span id="__span-0-30"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create application user</span>
</span><span id="__span-0-31"><span class="w">      </span><span class="nt">user</span><span class="p">:</span>
</span><span id="__span-0-32"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web3audit</span>
</span><span id="__span-0-33"><span class="w">        </span><span class="nt">system</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-0-34"><span class="w">        </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/bin/bash</span>
</span><span id="__span-0-35"><span class="w">        </span><span class="nt">home</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/web3audit</span>
</span><span id="__span-0-36">
</span><span id="__span-0-37"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Clone repository</span>
</span><span id="__span-0-38"><span class="w">      </span><span class="nt">git</span><span class="p">:</span>
</span><span id="__span-0-39"><span class="w">        </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/your-org/web3-security-ai.git</span>
</span><span id="__span-0-40"><span class="w">        </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/web3audit/app</span>
</span><span id="__span-0-41"><span class="w">        </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">web3_audit_version</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-0-42"><span class="w">      </span><span class="nt">become_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web3audit</span>
</span><span id="__span-0-43">
</span><span id="__span-0-44"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create virtual environment</span>
</span><span id="__span-0-45"><span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3.12 -m venv /opt/web3audit/venv</span>
</span><span id="__span-0-46"><span class="w">      </span><span class="nt">become_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web3audit</span>
</span><span id="__span-0-47">
</span><span id="__span-0-48"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install Python dependencies</span>
</span><span id="__span-0-49"><span class="w">      </span><span class="nt">pip</span><span class="p">:</span>
</span><span id="__span-0-50"><span class="w">        </span><span class="nt">requirements</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/web3audit/app/requirements.txt</span>
</span><span id="__span-0-51"><span class="w">        </span><span class="nt">virtualenv</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/web3audit/venv</span>
</span><span id="__span-0-52"><span class="w">      </span><span class="nt">become_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web3audit</span>
</span><span id="__span-0-53">
</span><span id="__span-0-54"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install analysis tools</span>
</span><span id="__span-0-55"><span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/web3audit/venv/bin/python -m web3_security_ai.tools.install_tools</span>
</span><span id="__span-0-56"><span class="w">      </span><span class="nt">become_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web3audit</span>
</span><span id="__span-0-57">
</span><span id="__span-0-58"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Configure environment</span>
</span><span id="__span-0-59"><span class="w">      </span><span class="nt">template</span><span class="p">:</span>
</span><span id="__span-0-60"><span class="w">        </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">templates/env.j2</span>
</span><span id="__span-0-61"><span class="w">        </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/web3audit/.env</span>
</span><span id="__span-0-62"><span class="w">        </span><span class="nt">owner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web3audit</span>
</span><span id="__span-0-63"><span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0600&#39;</span>
</span><span id="__span-0-64">
</span><span id="__span-0-65"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create systemd service</span>
</span><span id="__span-0-66"><span class="w">      </span><span class="nt">template</span><span class="p">:</span>
</span><span id="__span-0-67"><span class="w">        </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">templates/web3audit.service.j2</span>
</span><span id="__span-0-68"><span class="w">        </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/systemd/system/web3audit.service</span>
</span><span id="__span-0-69">
</span><span id="__span-0-70"><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Enable and start service</span>
</span><span id="__span-0-71"><span class="w">      </span><span class="nt">systemd</span><span class="p">:</span>
</span><span id="__span-0-72"><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web3audit</span>
</span><span id="__span-0-73"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-0-74"><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">started</span>
</span><span id="__span-0-75"><span class="w">        </span><span class="nt">daemon_reload</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span></code></pre></div>
<h4 id="docker-compose-deployment">Docker Compose Deployment</h4>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><span class="c1"># docker-compose.yml</span>
</span><span id="__span-1-2"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>
</span><span id="__span-1-3">
</span><span id="__span-1-4"><span class="nt">services</span><span class="p">:</span>
</span><span id="__span-1-5"><span class="w">  </span><span class="nt">web3audit</span><span class="p">:</span>
</span><span id="__span-1-6"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web3-security-ai:latest</span>
</span><span id="__span-1-7"><span class="w">    </span><span class="nt">build</span><span class="p">:</span>
</span><span id="__span-1-8"><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
</span><span id="__span-1-9"><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Dockerfile.prod</span>
</span><span id="__span-1-10"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
</span><span id="__span-1-11"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WEB3_AUDIT_ENV=production</span>
</span><span id="__span-1-12"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DB_HOST=db</span>
</span><span id="__span-1-13"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDIS_HOST=redis</span>
</span><span id="__span-1-14"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
</span><span id="__span-1-15"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8000:8000&quot;</span>
</span><span id="__span-1-16"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
</span><span id="__span-1-17"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./data:/app/data</span>
</span><span id="__span-1-18"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./logs:/app/logs</span>
</span><span id="__span-1-19"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
</span><span id="__span-1-20"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db</span>
</span><span id="__span-1-21"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
</span><span id="__span-1-22"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
</span><span id="__span-1-23">
</span><span id="__span-1-24"><span class="w">  </span><span class="nt">db</span><span class="p">:</span>
</span><span id="__span-1-25"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres:15</span>
</span><span id="__span-1-26"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
</span><span id="__span-1-27"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POSTGRES_DB=web3audit</span>
</span><span id="__span-1-28"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POSTGRES_USER=web3audit</span>
</span><span id="__span-1-29"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">POSTGRES_PASSWORD=${DB_PASSWORD}</span>
</span><span id="__span-1-30"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
</span><span id="__span-1-31"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db_data:/var/lib/postgresql/data</span>
</span><span id="__span-1-32"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
</span><span id="__span-1-33">
</span><span id="__span-1-34"><span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
</span><span id="__span-1-35"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
</span><span id="__span-1-36"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
</span><span id="__span-1-37"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis_data:/data</span>
</span><span id="__span-1-38"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
</span><span id="__span-1-39">
</span><span id="__span-1-40"><span class="nt">volumes</span><span class="p">:</span>
</span><span id="__span-1-41"><span class="w">  </span><span class="nt">db_data</span><span class="p">:</span>
</span><span id="__span-1-42"><span class="w">  </span><span class="nt">redis_data</span><span class="p">:</span>
</span></code></pre></div>
<h3 id="manual-installation">Manual Installation</h3>
<h4 id="step-by-step-setup">Step-by-Step Setup</h4>
<ol>
<li>
<p><strong>Prepare System</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><span class="c1"># Update system</span>
</span><span id="__span-2-2">sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
</span><span id="__span-2-3">
</span><span id="__span-2-4"><span class="c1"># Install dependencies</span>
</span><span id="__span-2-5">sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>python3.12<span class="w"> </span>python3.12-venv<span class="w"> </span>postgresql-client<span class="w"> </span>docker.io<span class="w"> </span>git
</span><span id="__span-2-6">
</span><span id="__span-2-7"><span class="c1"># Install Node.js (for some tools)</span>
</span><span id="__span-2-8">curl<span class="w"> </span>-fsSL<span class="w"> </span>https://deb.nodesource.com/setup_18.x<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>-E<span class="w"> </span>bash<span class="w"> </span>-
</span><span id="__span-2-9">sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>nodejs
</span></code></pre></div></p>
</li>
<li>
<p><strong>Create Application User</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1">sudo<span class="w"> </span>useradd<span class="w"> </span>-r<span class="w"> </span>-s<span class="w"> </span>/bin/bash<span class="w"> </span>-m<span class="w"> </span>-d<span class="w"> </span>/opt/web3audit<span class="w"> </span>web3audit
</span><span id="__span-3-2">sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span>web3audit
</span></code></pre></div></p>
</li>
<li>
<p><strong>Clone and Install</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1">sudo<span class="w"> </span>-u<span class="w"> </span>web3audit<span class="w"> </span>bash<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-4-2"><span class="s">cd /opt/web3audit</span>
</span><span id="__span-4-3">
</span><span id="__span-4-4"><span class="s"># Clone repository</span>
</span><span id="__span-4-5"><span class="s">git clone https://github.com/your-org/web3-security-ai.git app</span>
</span><span id="__span-4-6"><span class="s">cd app</span>
</span><span id="__span-4-7">
</span><span id="__span-4-8"><span class="s"># Create virtual environment</span>
</span><span id="__span-4-9"><span class="s">python3.12 -m venv ../venv</span>
</span><span id="__span-4-10"><span class="s">source ../venv/bin/activate</span>
</span><span id="__span-4-11">
</span><span id="__span-4-12"><span class="s"># Install dependencies</span>
</span><span id="__span-4-13"><span class="s">pip install -r requirements.txt</span>
</span><span id="__span-4-14">
</span><span id="__span-4-15"><span class="s"># Install analysis tools</span>
</span><span id="__span-4-16"><span class="s">python -m web3_security_ai.tools.install_tools</span>
</span><span id="__span-4-17"><span class="s">EOF</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Configure Environment</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1">sudo<span class="w"> </span>-u<span class="w"> </span>web3audit<span class="w"> </span>tee<span class="w"> </span>/opt/web3audit/.env<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
</span><span id="__span-5-2"><span class="s"># Production Configuration</span>
</span><span id="__span-5-3"><span class="s">WEB3_AUDIT_ENV=production</span>
</span><span id="__span-5-4"><span class="s">WEB3_AUDIT_LOG_LEVEL=INFO</span>
</span><span id="__span-5-5"><span class="s">DB_HOST=localhost</span>
</span><span id="__span-5-6"><span class="s">DB_NAME=web3audit</span>
</span><span id="__span-5-7"><span class="s">DB_USER=web3audit</span>
</span><span id="__span-5-8"><span class="s">DB_PASSWORD=secure_password_here</span>
</span><span id="__span-5-9"><span class="s">REDIS_HOST=localhost</span>
</span><span id="__span-5-10"><span class="s">SECRET_KEY=$(openssl rand -hex 32)</span>
</span><span id="__span-5-11"><span class="s">EOF</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Setup Database</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><span class="c1"># Create database</span>
</span><span id="__span-6-2">sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>createdb<span class="w"> </span>web3audit
</span><span id="__span-6-3">sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>createuser<span class="w"> </span>web3audit
</span><span id="__span-6-4">sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>psql<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;ALTER USER web3audit PASSWORD &#39;secure_password_here&#39;;&quot;</span>
</span><span id="__span-6-5">sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>psql<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;GRANT ALL PRIVILEGES ON DATABASE web3audit TO web3audit;&quot;</span>
</span><span id="__span-6-6">
</span><span id="__span-6-7"><span class="c1"># Run migrations</span>
</span><span id="__span-6-8">sudo<span class="w"> </span>-u<span class="w"> </span>web3audit<span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;cd /opt/web3audit/app &amp;&amp; source ../venv/bin/activate &amp;&amp; python manage.py migrate&quot;</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Configure Systemd Service</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1">sudo<span class="w"> </span>tee<span class="w"> </span>/etc/systemd/system/web3audit.service<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
</span><span id="__span-7-2"><span class="s">[Unit]</span>
</span><span id="__span-7-3"><span class="s">Description=Web3 Security Auditing AI System</span>
</span><span id="__span-7-4"><span class="s">After=network.target postgresql.service redis-server.service</span>
</span><span id="__span-7-5">
</span><span id="__span-7-6"><span class="s">[Service]</span>
</span><span id="__span-7-7"><span class="s">Type=simple</span>
</span><span id="__span-7-8"><span class="s">User=web3audit</span>
</span><span id="__span-7-9"><span class="s">Group=web3audit</span>
</span><span id="__span-7-10"><span class="s">WorkingDirectory=/opt/web3audit/app</span>
</span><span id="__span-7-11"><span class="s">Environment=PATH=/opt/web3audit/venv/bin</span>
</span><span id="__span-7-12"><span class="s">ExecStart=/opt/web3audit/venv/bin/python -m web3_security_ai.cli serve</span>
</span><span id="__span-7-13"><span class="s">Restart=always</span>
</span><span id="__span-7-14"><span class="s">RestartSec=5</span>
</span><span id="__span-7-15">
</span><span id="__span-7-16"><span class="s">[Install]</span>
</span><span id="__span-7-17"><span class="s">WantedBy=multi-user.target</span>
</span><span id="__span-7-18"><span class="s">EOF</span>
</span><span id="__span-7-19">
</span><span id="__span-7-20">sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
</span><span id="__span-7-21">sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>web3audit
</span><span id="__span-7-22">sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>web3audit
</span></code></pre></div></p>
</li>
</ol>
<hr />
<h2 id="configuration-management">Configuration Management</h2>
<h3 id="configuration-hierarchy">Configuration Hierarchy</h3>
<ol>
<li><strong>System Defaults</strong>: Built-in default values</li>
<li><strong>Environment Variables</strong>: Override defaults</li>
<li><strong>Configuration Files</strong>: YAML/JSON files</li>
<li><strong>Runtime Overrides</strong>: API/database overrides</li>
</ol>
<h3 id="configuration-files">Configuration Files</h3>
<h4 id="main-configuration-file">Main Configuration File</h4>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-8-1"><span class="c1"># config/production.yaml</span>
</span><span id="__span-8-2"><span class="nt">system</span><span class="p">:</span>
</span><span id="__span-8-3"><span class="w">  </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
</span><span id="__span-8-4"><span class="w">  </span><span class="nt">log_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INFO</span>
</span><span id="__span-8-5"><span class="w">  </span><span class="nt">secret_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SECRET_KEY}</span>
</span><span id="__span-8-6"><span class="w">  </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-8-7">
</span><span id="__span-8-8"><span class="nt">database</span><span class="p">:</span>
</span><span id="__span-8-9"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${DB_HOST}</span>
</span><span id="__span-8-10"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5432</span>
</span><span id="__span-8-11"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${DB_NAME}</span>
</span><span id="__span-8-12"><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${DB_USER}</span>
</span><span id="__span-8-13"><span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${DB_PASSWORD}</span>
</span><span id="__span-8-14"><span class="w">  </span><span class="nt">ssl_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">require</span>
</span><span id="__span-8-15">
</span><span id="__span-8-16"><span class="nt">redis</span><span class="p">:</span>
</span><span id="__span-8-17"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${REDIS_HOST}</span>
</span><span id="__span-8-18"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6379</span>
</span><span id="__span-8-19"><span class="w">  </span><span class="nt">db</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</span><span id="__span-8-20"><span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${REDIS_PASSWORD}</span>
</span><span id="__span-8-21">
</span><span id="__span-8-22"><span class="nt">audit</span><span class="p">:</span>
</span><span id="__span-8-23"><span class="w">  </span><span class="nt">max_concurrent_audits</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-8-24"><span class="w">  </span><span class="nt">default_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1800</span>
</span><span id="__span-8-25"><span class="w">  </span><span class="nt">max_file_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10485760</span><span class="w">  </span><span class="c1"># 10MB</span>
</span><span id="__span-8-26"><span class="w">  </span><span class="nt">allowed_file_types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;.sol&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;.vy&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;.json&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-8-27">
</span><span id="__span-8-28"><span class="nt">agents</span><span class="p">:</span>
</span><span id="__span-8-29"><span class="w">  </span><span class="nt">orchestrator</span><span class="p">:</span>
</span><span id="__span-8-30"><span class="w">    </span><span class="nt">max_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</span><span id="__span-8-31"><span class="w">    </span><span class="nt">queue_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</span><span id="__span-8-32"><span class="w">  </span><span class="nt">web3_audit</span><span class="p">:</span>
</span><span id="__span-8-33"><span class="w">    </span><span class="nt">deep_analysis</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-34"><span class="w">    </span><span class="nt">parallel_processing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-35"><span class="w">  </span><span class="nt">ml_engine</span><span class="p">:</span>
</span><span id="__span-8-36"><span class="w">    </span><span class="nt">model_cache_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</span><span id="__span-8-37"><span class="w">    </span><span class="nt">prediction_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
</span><span id="__span-8-38">
</span><span id="__span-8-39"><span class="nt">tools</span><span class="p">:</span>
</span><span id="__span-8-40"><span class="w">  </span><span class="nt">slither</span><span class="p">:</span>
</span><span id="__span-8-41"><span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.10.0&quot;</span>
</span><span id="__span-8-42"><span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
</span><span id="__span-8-43"><span class="w">    </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-8-44"><span class="w">      </span><span class="nt">exclude_dependencies</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-45"><span class="w">      </span><span class="nt">detectors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;reentrancy&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;unchecked-lowlevel-call&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-8-46"><span class="w">  </span><span class="nt">mythril</span><span class="p">:</span>
</span><span id="__span-8-47"><span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;latest&quot;</span>
</span><span id="__span-8-48"><span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">600</span>
</span><span id="__span-8-49"><span class="w">    </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-8-50"><span class="w">      </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
</span><span id="__span-8-51">
</span><span id="__span-8-52"><span class="nt">reporting</span><span class="p">:</span>
</span><span id="__span-8-53"><span class="w">  </span><span class="nt">formats</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;json&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;pdf&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;html&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-8-54"><span class="w">  </span><span class="nt">storage</span><span class="p">:</span>
</span><span id="__span-8-55"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">filesystem</span>
</span><span id="__span-8-56"><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/web3audit/reports</span>
</span><span id="__span-8-57"><span class="w">    </span><span class="nt">retention_days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">365</span>
</span><span id="__span-8-58"><span class="w">  </span><span class="nt">email</span><span class="p">:</span>
</span><span id="__span-8-59"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-60"><span class="w">    </span><span class="nt">smtp_server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">smtp.company.com</span>
</span><span id="__span-8-61"><span class="w">    </span><span class="nt">smtp_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">587</span>
</span><span id="__span-8-62"><span class="w">    </span><span class="nt">from_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">audits@company.com</span>
</span><span id="__span-8-63">
</span><span id="__span-8-64"><span class="nt">security</span><span class="p">:</span>
</span><span id="__span-8-65"><span class="w">  </span><span class="nt">api_keys_required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-66"><span class="w">  </span><span class="nt">rate_limiting</span><span class="p">:</span>
</span><span id="__span-8-67"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-68"><span class="w">    </span><span class="nt">requests_per_minute</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</span><span id="__span-8-69"><span class="w">  </span><span class="nt">audit_trail</span><span class="p">:</span>
</span><span id="__span-8-70"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-71"><span class="w">    </span><span class="nt">log_api_calls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-72">
</span><span id="__span-8-73"><span class="nt">monitoring</span><span class="p">:</span>
</span><span id="__span-8-74"><span class="w">  </span><span class="nt">prometheus</span><span class="p">:</span>
</span><span id="__span-8-75"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-76"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9090</span>
</span><span id="__span-8-77"><span class="w">  </span><span class="nt">health_checks</span><span class="p">:</span>
</span><span id="__span-8-78"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-8-79"><span class="w">    </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span></code></pre></div>
<h3 id="environment-variables">Environment Variables</h3>
<h4 id="required-variables">Required Variables</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><span class="c1"># Database</span>
</span><span id="__span-9-2"><span class="nv">DB_HOST</span><span class="o">=</span>localhost
</span><span id="__span-9-3"><span class="nv">DB_NAME</span><span class="o">=</span>web3audit
</span><span id="__span-9-4"><span class="nv">DB_USER</span><span class="o">=</span>web3audit
</span><span id="__span-9-5"><span class="nv">DB_PASSWORD</span><span class="o">=</span>secure_password
</span><span id="__span-9-6">
</span><span id="__span-9-7"><span class="c1"># Security</span>
</span><span id="__span-9-8"><span class="nv">SECRET_KEY</span><span class="o">=</span>your-secret-key-here
</span><span id="__span-9-9">
</span><span id="__span-9-10"><span class="c1"># External Services</span>
</span><span id="__span-9-11"><span class="nv">REDIS_HOST</span><span class="o">=</span>localhost
</span><span id="__span-9-12"><span class="nv">SMTP_SERVER</span><span class="o">=</span>smtp.company.com
</span></code></pre></div>
<h4 id="optional-variables">Optional Variables</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><span class="c1"># Performance Tuning</span>
</span><span id="__span-10-2"><span class="nv">WEB3_AUDIT_MAX_WORKERS</span><span class="o">=</span><span class="m">4</span>
</span><span id="__span-10-3"><span class="nv">WEB3_AUDIT_MEMORY_LIMIT</span><span class="o">=</span>4GB
</span><span id="__span-10-4">
</span><span id="__span-10-5"><span class="c1"># Feature Flags</span>
</span><span id="__span-10-6"><span class="nv">WEB3_AUDIT_ML_ENABLED</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-10-7"><span class="nv">WEB3_AUDIT_ADVANCED_REPORTING</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-10-8">
</span><span id="__span-10-9"><span class="c1"># External APIs</span>
</span><span id="__span-10-10"><span class="nv">OPENAI_API_KEY</span><span class="o">=</span>sk-your-key
</span><span id="__span-10-11"><span class="nv">ANTHROPIC_API_KEY</span><span class="o">=</span>your-key
</span></code></pre></div>
<h3 id="configuration-validation">Configuration Validation</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConfigValidator</span><span class="p">,</span> <span class="n">ConfigLoader</span>
</span><span id="__span-11-2">
</span><span id="__span-11-3"><span class="k">class</span><span class="w"> </span><span class="nc">ProductionConfigManager</span><span class="p">:</span>
</span><span id="__span-11-4"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages production configuration with validation.&quot;&quot;&quot;</span>
</span><span id="__span-11-5">
</span><span id="__span-11-6">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-11-7">        <span class="bp">self</span><span class="o">.</span><span class="n">validator</span> <span class="o">=</span> <span class="n">ConfigValidator</span><span class="p">()</span>
</span><span id="__span-11-8">        <span class="bp">self</span><span class="o">.</span><span class="n">loader</span> <span class="o">=</span> <span class="n">ConfigLoader</span><span class="p">()</span>
</span><span id="__span-11-9">
</span><span id="__span-11-10">    <span class="k">def</span><span class="w"> </span><span class="nf">load_and_validate_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-11-11"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load and validate configuration.&quot;&quot;&quot;</span>
</span><span id="__span-11-12">        <span class="c1"># Load configuration</span>
</span><span id="__span-11-13">        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
</span><span id="__span-11-14">
</span><span id="__span-11-15">        <span class="c1"># Validate configuration</span>
</span><span id="__span-11-16">        <span class="n">validation_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="__span-11-17">
</span><span id="__span-11-18">        <span class="k">if</span> <span class="n">validation_errors</span><span class="p">:</span>
</span><span id="__span-11-19">            <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid configuration: </span><span class="si">{</span><span class="n">validation_errors</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-20">
</span><span id="__span-11-21">        <span class="c1"># Apply environment variable overrides</span>
</span><span id="__span-11-22">        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_env_overrides</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="__span-11-23">
</span><span id="__span-11-24">        <span class="c1"># Validate external dependencies</span>
</span><span id="__span-11-25">        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_dependencies</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="__span-11-26">
</span><span id="__span-11-27">        <span class="k">return</span> <span class="n">config</span>
</span><span id="__span-11-28">
</span><span id="__span-11-29">    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_env_overrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-11-30"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply environment variable overrides.&quot;&quot;&quot;</span>
</span><span id="__span-11-31">        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-11-32">
</span><span id="__span-11-33">        <span class="c1"># Database overrides</span>
</span><span id="__span-11-34">        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;DB_HOST&#39;</span><span class="p">):</span>
</span><span id="__span-11-35">            <span class="n">config</span><span class="p">[</span><span class="s1">&#39;database&#39;</span><span class="p">][</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;DB_HOST&#39;</span><span class="p">)</span>
</span><span id="__span-11-36">
</span><span id="__span-11-37">        <span class="c1"># Security overrides</span>
</span><span id="__span-11-38">        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;SECRET_KEY&#39;</span><span class="p">):</span>
</span><span id="__span-11-39">            <span class="n">config</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">][</span><span class="s1">&#39;secret_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;SECRET_KEY&#39;</span><span class="p">)</span>
</span><span id="__span-11-40">
</span><span id="__span-11-41">        <span class="k">return</span> <span class="n">config</span>
</span><span id="__span-11-42">
</span><span id="__span-11-43">    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-11-44"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate external dependencies.&quot;&quot;&quot;</span>
</span><span id="__span-11-45">        <span class="c1"># Check database connectivity</span>
</span><span id="__span-11-46">        <span class="bp">self</span><span class="o">.</span><span class="n">_check_database_connection</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;database&#39;</span><span class="p">])</span>
</span><span id="__span-11-47">
</span><span id="__span-11-48">        <span class="c1"># Check Redis connectivity</span>
</span><span id="__span-11-49">        <span class="bp">self</span><span class="o">.</span><span class="n">_check_redis_connection</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;redis&#39;</span><span class="p">))</span>
</span><span id="__span-11-50">
</span><span id="__span-11-51">        <span class="c1"># Check tool availability</span>
</span><span id="__span-11-52">        <span class="bp">self</span><span class="o">.</span><span class="n">_check_tools_availability</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tools&#39;</span><span class="p">,</span> <span class="p">{}))</span>
</span></code></pre></div>
<hr />
<h2 id="deployment-strategies">Deployment Strategies</h2>
<h3 id="blue-green-deployment">Blue-Green Deployment</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-12-2"><span class="c1"># Blue-green deployment script</span>
</span><span id="__span-12-3">
</span><span id="__span-12-4"><span class="nv">BLUE_PORT</span><span class="o">=</span><span class="m">8000</span>
</span><span id="__span-12-5"><span class="nv">GREEN_PORT</span><span class="o">=</span><span class="m">8001</span>
</span><span id="__span-12-6"><span class="nv">CURRENT_PORT</span><span class="o">=</span><span class="nv">$BLUE_PORT</span>
</span><span id="__span-12-7">
</span><span id="__span-12-8"><span class="c1"># Deploy to green environment</span>
</span><span id="__span-12-9"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Deploying to green environment (port </span><span class="nv">$GREEN_PORT</span><span class="s2">)...&quot;</span>
</span><span id="__span-12-10">
</span><span id="__span-12-11"><span class="c1"># Build new version</span>
</span><span id="__span-12-12">docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>web3audit:new<span class="w"> </span>.
</span><span id="__span-12-13">
</span><span id="__span-12-14"><span class="c1"># Start green environment</span>
</span><span id="__span-12-15">docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>web3audit-green<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-16"><span class="w">  </span>-p<span class="w"> </span><span class="nv">$GREEN_PORT</span>:8000<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-17"><span class="w">  </span>-e<span class="w"> </span><span class="nv">WEB3_AUDIT_ENV</span><span class="o">=</span>production<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-18"><span class="w">  </span>web3audit:new
</span><span id="__span-12-19">
</span><span id="__span-12-20"><span class="c1"># Wait for health check</span>
</span><span id="__span-12-21"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Waiting for green environment to be healthy...&quot;</span>
</span><span id="__span-12-22"><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..30<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-23"><span class="w">  </span><span class="k">if</span><span class="w"> </span>curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:<span class="nv">$GREEN_PORT</span>/health<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-12-24"><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Green environment is healthy&quot;</span>
</span><span id="__span-12-25"><span class="w">    </span><span class="k">break</span>
</span><span id="__span-12-26"><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-12-27"><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
</span><span id="__span-12-28"><span class="k">done</span>
</span><span id="__span-12-29">
</span><span id="__span-12-30"><span class="c1"># Switch traffic (using nginx or load balancer)</span>
</span><span id="__span-12-31"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Switching traffic to green environment...&quot;</span>
</span><span id="__span-12-32">sudo<span class="w"> </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$CURRENT_PORT</span><span class="s2">/</span><span class="nv">$GREEN_PORT</span><span class="s2">/&quot;</span><span class="w"> </span>/etc/nginx/sites-available/web3audit
</span><span id="__span-12-33">sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx
</span><span id="__span-12-34">
</span><span id="__span-12-35"><span class="c1"># Wait for traffic to drain</span>
</span><span id="__span-12-36">sleep<span class="w"> </span><span class="m">30</span>
</span><span id="__span-12-37">
</span><span id="__span-12-38"><span class="c1"># Stop blue environment</span>
</span><span id="__span-12-39"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Stopping blue environment...&quot;</span>
</span><span id="__span-12-40">docker<span class="w"> </span>stop<span class="w"> </span>web3audit-blue
</span><span id="__span-12-41">docker<span class="w"> </span>rm<span class="w"> </span>web3audit-blue
</span><span id="__span-12-42">
</span><span id="__span-12-43"><span class="c1"># Rename green to blue for next deployment</span>
</span><span id="__span-12-44">docker<span class="w"> </span>tag<span class="w"> </span>web3audit:new<span class="w"> </span>web3audit:current
</span><span id="__span-12-45">docker<span class="w"> </span>rmi<span class="w"> </span>web3audit:old<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">true</span>
</span><span id="__span-12-46">docker<span class="w"> </span>tag<span class="w"> </span>web3audit:current<span class="w"> </span>web3audit:old
</span><span id="__span-12-47">
</span><span id="__span-12-48"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Deployment completed successfully&quot;</span>
</span></code></pre></div>
<h3 id="rolling-deployment">Rolling Deployment</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-13-2"><span class="c1"># Rolling deployment script</span>
</span><span id="__span-13-3">
</span><span id="__span-13-4"><span class="nv">REPLICAS</span><span class="o">=</span><span class="m">3</span>
</span><span id="__span-13-5"><span class="nv">IMAGE_TAG</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">latest</span><span class="si">}</span>
</span><span id="__span-13-6">
</span><span id="__span-13-7"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting rolling deployment with </span><span class="nv">$REPLICAS</span><span class="s2"> replicas...&quot;</span>
</span><span id="__span-13-8">
</span><span id="__span-13-9"><span class="c1"># Update each replica one by one</span>
</span><span id="__span-13-10"><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>seq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="nv">$REPLICAS</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-13-11"><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Updating replica </span><span class="nv">$i</span><span class="s2">...&quot;</span>
</span><span id="__span-13-12">
</span><span id="__span-13-13"><span class="w">  </span><span class="c1"># Stop old container</span>
</span><span id="__span-13-14"><span class="w">  </span>docker<span class="w"> </span>stop<span class="w"> </span><span class="s2">&quot;web3audit-replica-</span><span class="nv">$i</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">true</span>
</span><span id="__span-13-15"><span class="w">  </span>docker<span class="w"> </span>rm<span class="w"> </span><span class="s2">&quot;web3audit-replica-</span><span class="nv">$i</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">true</span>
</span><span id="__span-13-16">
</span><span id="__span-13-17"><span class="w">  </span><span class="c1"># Start new container</span>
</span><span id="__span-13-18"><span class="w">  </span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;web3audit-replica-</span><span class="nv">$i</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-19"><span class="w">    </span>--network<span class="w"> </span>web3audit-network<span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-20"><span class="w">    </span>-e<span class="w"> </span><span class="nv">WEB3_AUDIT_ENV</span><span class="o">=</span>production<span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-21"><span class="w">    </span><span class="s2">&quot;web3audit:</span><span class="nv">$IMAGE_TAG</span><span class="s2">&quot;</span>
</span><span id="__span-13-22">
</span><span id="__span-13-23"><span class="w">  </span><span class="c1"># Wait for health check</span>
</span><span id="__span-13-24"><span class="w">  </span><span class="k">for</span><span class="w"> </span>j<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..10<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-13-25"><span class="w">    </span><span class="k">if</span><span class="w"> </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="s2">&quot;web3audit-replica-</span><span class="nv">$i</span><span class="s2">&quot;</span><span class="w"> </span>curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:8000/health<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-13-26"><span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Replica </span><span class="nv">$i</span><span class="s2"> is healthy&quot;</span>
</span><span id="__span-13-27"><span class="w">      </span><span class="k">break</span>
</span><span id="__span-13-28"><span class="w">    </span><span class="k">fi</span>
</span><span id="__span-13-29"><span class="w">    </span>sleep<span class="w"> </span><span class="m">5</span>
</span><span id="__span-13-30"><span class="w">  </span><span class="k">done</span>
</span><span id="__span-13-31">
</span><span id="__span-13-32"><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Replica </span><span class="nv">$i</span><span class="s2"> updated successfully&quot;</span>
</span><span id="__span-13-33"><span class="k">done</span>
</span><span id="__span-13-34">
</span><span id="__span-13-35"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Rolling deployment completed&quot;</span>
</span></code></pre></div>
<h3 id="canary-deployment">Canary Deployment</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-14-2"><span class="c1"># Canary deployment script</span>
</span><span id="__span-14-3">
</span><span id="__span-14-4"><span class="nv">CANARY_PERCENTAGE</span><span class="o">=</span><span class="m">10</span>
</span><span id="__span-14-5"><span class="nv">TOTAL_REQUESTS</span><span class="o">=</span><span class="m">1000</span>
</span><span id="__span-14-6"><span class="nv">CANARY_REQUESTS</span><span class="o">=</span><span class="k">$((</span><span class="nv">TOTAL_REQUESTS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">CANARY_PERCENTAGE</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">100</span><span class="k">))</span>
</span><span id="__span-14-7">
</span><span id="__span-14-8"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting canary deployment (</span><span class="nv">$CANARY_PERCENTAGE</span><span class="s2">% traffic)...&quot;</span>
</span><span id="__span-14-9">
</span><span id="__span-14-10"><span class="c1"># Deploy canary version</span>
</span><span id="__span-14-11">docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>web3audit-canary<span class="w"> </span><span class="se">\</span>
</span><span id="__span-14-12"><span class="w">  </span>-p<span class="w"> </span><span class="m">8001</span>:8000<span class="w"> </span><span class="se">\</span>
</span><span id="__span-14-13"><span class="w">  </span>-e<span class="w"> </span><span class="nv">WEB3_AUDIT_ENV</span><span class="o">=</span>production<span class="w"> </span><span class="se">\</span>
</span><span id="__span-14-14"><span class="w">  </span>web3audit:new
</span><span id="__span-14-15">
</span><span id="__span-14-16"><span class="c1"># Configure load balancer for canary routing</span>
</span><span id="__span-14-17">cat<span class="w"> </span>&gt;<span class="w"> </span>/etc/nginx/sites-available/web3audit-canary<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
</span><span id="__span-14-18"><span class="s">upstream backend {</span>
</span><span id="__span-14-19"><span class="s">    ip_hash;</span>
</span><span id="__span-14-20"><span class="s">    server localhost:8000 weight=9;  # 90% to stable</span>
</span><span id="__span-14-21"><span class="s">    server localhost:8001 weight=1;  # 10% to canary</span>
</span><span id="__span-14-22"><span class="s">}</span>
</span><span id="__span-14-23">
</span><span id="__span-14-24"><span class="s">server {</span>
</span><span id="__span-14-25"><span class="s">    listen 80;</span>
</span><span id="__span-14-26"><span class="s">    server_name audit.company.com;</span>
</span><span id="__span-14-27">
</span><span id="__span-14-28"><span class="s">    location / {</span>
</span><span id="__span-14-29"><span class="s">        proxy_pass http://backend;</span>
</span><span id="__span-14-30"><span class="s">        proxy_set_header Host \$host;</span>
</span><span id="__span-14-31"><span class="s">        proxy_set_header X-Real-IP \$remote_addr;</span>
</span><span id="__span-14-32"><span class="s">    }</span>
</span><span id="__span-14-33"><span class="s">}</span>
</span><span id="__span-14-34"><span class="s">EOF</span>
</span><span id="__span-14-35">
</span><span id="__span-14-36">sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/etc/nginx/sites-available/web3audit-canary<span class="w"> </span>/etc/nginx/sites-enabled/
</span><span id="__span-14-37">sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx
</span><span id="__span-14-38">
</span><span id="__span-14-39"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Canary deployment active. Monitoring for </span><span class="nv">$CANARY_REQUESTS</span><span class="s2"> requests...&quot;</span>
</span><span id="__span-14-40">
</span><span id="__span-14-41"><span class="c1"># Monitor canary performance</span>
</span><span id="__span-14-42"><span class="nv">REQUESTS_SEEN</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-43"><span class="nv">ERRORS</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-14-44">
</span><span id="__span-14-45"><span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$REQUESTS_SEEN</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$CANARY_REQUESTS</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-14-46"><span class="w">  </span><span class="c1"># Check canary health</span>
</span><span id="__span-14-47"><span class="w">  </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span>curl<span class="w"> </span>-f<span class="w"> </span>http://localhost:8001/health<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-48"><span class="w">    </span><span class="o">((</span>ERRORS++<span class="o">))</span>
</span><span id="__span-14-49"><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-14-50">
</span><span id="__span-14-51"><span class="w">  </span><span class="o">((</span>REQUESTS_SEEN++<span class="o">))</span>
</span><span id="__span-14-52">
</span><span id="__span-14-53"><span class="w">  </span><span class="c1"># Check error rate</span>
</span><span id="__span-14-54"><span class="w">  </span><span class="nv">ERROR_RATE</span><span class="o">=</span><span class="k">$((</span><span class="nv">ERRORS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">REQUESTS_SEEN</span><span class="k">))</span>
</span><span id="__span-14-55"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$ERROR_RATE</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-56"><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Error rate too high (</span><span class="nv">$ERROR_RATE</span><span class="s2">%). Rolling back canary...&quot;</span>
</span><span id="__span-14-57"><span class="w">    </span>sudo<span class="w"> </span>rm<span class="w"> </span>/etc/nginx/sites-enabled/web3audit-canary
</span><span id="__span-14-58"><span class="w">    </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx
</span><span id="__span-14-59"><span class="w">    </span>docker<span class="w"> </span>stop<span class="w"> </span>web3audit-canary
</span><span id="__span-14-60"><span class="w">    </span>docker<span class="w"> </span>rm<span class="w"> </span>web3audit-canary
</span><span id="__span-14-61"><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-62"><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-14-63">
</span><span id="__span-14-64"><span class="w">  </span>sleep<span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-65"><span class="k">done</span>
</span><span id="__span-14-66">
</span><span id="__span-14-67"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Canary deployment successful. Promoting to full production...&quot;</span>
</span><span id="__span-14-68">
</span><span id="__span-14-69"><span class="c1"># Full deployment</span>
</span><span id="__span-14-70">sudo<span class="w"> </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/weight=9/weight=0/&#39;</span><span class="w"> </span>/etc/nginx/sites-available/web3audit-canary
</span><span id="__span-14-71">sudo<span class="w"> </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/weight=1/weight=10/&#39;</span><span class="w"> </span>/etc/nginx/sites-available/web3audit-canary
</span><span id="__span-14-72">sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx
</span><span id="__span-14-73">
</span><span id="__span-14-74"><span class="c1"># Stop old version</span>
</span><span id="__span-14-75">docker<span class="w"> </span>stop<span class="w"> </span>web3audit-stable
</span><span id="__span-14-76">docker<span class="w"> </span>rm<span class="w"> </span>web3audit-stable
</span><span id="__span-14-77">
</span><span id="__span-14-78"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Full deployment completed&quot;</span>
</span></code></pre></div>
<hr />
<h2 id="monitoring-and-observability">Monitoring and Observability</h2>
<h3 id="application-metrics">Application Metrics</h3>
<h4 id="prometheus-metrics">Prometheus Metrics</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><span class="kn">from</span><span class="w"> </span><span class="nn">prometheus_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">Gauge</span><span class="p">,</span> <span class="n">generate_latest</span>
</span><span id="__span-15-2"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-15-3">
</span><span id="__span-15-4"><span class="k">class</span><span class="w"> </span><span class="nc">AuditMetrics</span><span class="p">:</span>
</span><span id="__span-15-5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Application metrics for monitoring.&quot;&quot;&quot;</span>
</span><span id="__span-15-6">
</span><span id="__span-15-7">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-15-8">        <span class="c1"># Counters</span>
</span><span id="__span-15-9">        <span class="bp">self</span><span class="o">.</span><span class="n">audits_started</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span>
</span><span id="__span-15-10">            <span class="s1">&#39;web3audit_audits_started_total&#39;</span><span class="p">,</span>
</span><span id="__span-15-11">            <span class="s1">&#39;Total number of audits started&#39;</span>
</span><span id="__span-15-12">        <span class="p">)</span>
</span><span id="__span-15-13">        <span class="bp">self</span><span class="o">.</span><span class="n">audits_completed</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span>
</span><span id="__span-15-14">            <span class="s1">&#39;web3audit_audits_completed_total&#39;</span><span class="p">,</span>
</span><span id="__span-15-15">            <span class="s1">&#39;Total number of audits completed&#39;</span><span class="p">,</span>
</span><span id="__span-15-16">            <span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span>  <span class="c1"># success, failed, timeout</span>
</span><span id="__span-15-17">        <span class="p">)</span>
</span><span id="__span-15-18">        <span class="bp">self</span><span class="o">.</span><span class="n">findings_discovered</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span>
</span><span id="__span-15-19">            <span class="s1">&#39;web3audit_findings_discovered_total&#39;</span><span class="p">,</span>
</span><span id="__span-15-20">            <span class="s1">&#39;Total number of findings discovered&#39;</span><span class="p">,</span>
</span><span id="__span-15-21">            <span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span>  <span class="c1"># critical, high, medium, low, info</span>
</span><span id="__span-15-22">        <span class="p">)</span>
</span><span id="__span-15-23">
</span><span id="__span-15-24">        <span class="c1"># Histograms</span>
</span><span id="__span-15-25">        <span class="bp">self</span><span class="o">.</span><span class="n">audit_duration</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span>
</span><span id="__span-15-26">            <span class="s1">&#39;web3audit_audit_duration_seconds&#39;</span><span class="p">,</span>
</span><span id="__span-15-27">            <span class="s1">&#39;Time taken to complete audits&#39;</span><span class="p">,</span>
</span><span id="__span-15-28">            <span class="n">buckets</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">1800</span><span class="p">,</span> <span class="mi">3600</span><span class="p">,</span> <span class="mi">7200</span><span class="p">]</span>
</span><span id="__span-15-29">        <span class="p">)</span>
</span><span id="__span-15-30">        <span class="bp">self</span><span class="o">.</span><span class="n">agent_processing_time</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span>
</span><span id="__span-15-31">            <span class="s1">&#39;web3audit_agent_processing_time_seconds&#39;</span><span class="p">,</span>
</span><span id="__span-15-32">            <span class="s1">&#39;Time taken by agents to process tasks&#39;</span><span class="p">,</span>
</span><span id="__span-15-33">            <span class="p">[</span><span class="s1">&#39;agent_type&#39;</span><span class="p">]</span>
</span><span id="__span-15-34">        <span class="p">)</span>
</span><span id="__span-15-35">
</span><span id="__span-15-36">        <span class="c1"># Gauges</span>
</span><span id="__span-15-37">        <span class="bp">self</span><span class="o">.</span><span class="n">active_audits</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
</span><span id="__span-15-38">            <span class="s1">&#39;web3audit_active_audits&#39;</span><span class="p">,</span>
</span><span id="__span-15-39">            <span class="s1">&#39;Number of currently active audits&#39;</span>
</span><span id="__span-15-40">        <span class="p">)</span>
</span><span id="__span-15-41">        <span class="bp">self</span><span class="o">.</span><span class="n">queue_size</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
</span><span id="__span-15-42">            <span class="s1">&#39;web3audit_queue_size&#39;</span><span class="p">,</span>
</span><span id="__span-15-43">            <span class="s1">&#39;Number of audits waiting in queue&#39;</span>
</span><span id="__span-15-44">        <span class="p">)</span>
</span><span id="__span-15-45">        <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
</span><span id="__span-15-46">            <span class="s1">&#39;web3audit_memory_usage_bytes&#39;</span><span class="p">,</span>
</span><span id="__span-15-47">            <span class="s1">&#39;Current memory usage&#39;</span>
</span><span id="__span-15-48">        <span class="p">)</span>
</span><span id="__span-15-49">
</span><span id="__span-15-50">    <span class="k">def</span><span class="w"> </span><span class="nf">record_audit_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-15-51"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record audit start.&quot;&quot;&quot;</span>
</span><span id="__span-15-52">        <span class="bp">self</span><span class="o">.</span><span class="n">audits_started</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span>
</span><span id="__span-15-53">        <span class="bp">self</span><span class="o">.</span><span class="n">active_audits</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span>
</span><span id="__span-15-54">
</span><span id="__span-15-55">    <span class="k">def</span><span class="w"> </span><span class="nf">record_audit_completion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="__span-15-56"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record audit completion.&quot;&quot;&quot;</span>
</span><span id="__span-15-57">        <span class="bp">self</span><span class="o">.</span><span class="n">audits_completed</span><span class="o">.</span><span class="n">labels</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">)</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span>
</span><span id="__span-15-58">        <span class="bp">self</span><span class="o">.</span><span class="n">audit_duration</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
</span><span id="__span-15-59">        <span class="bp">self</span><span class="o">.</span><span class="n">active_audits</span><span class="o">.</span><span class="n">dec</span><span class="p">()</span>
</span><span id="__span-15-60">
</span><span id="__span-15-61">    <span class="k">def</span><span class="w"> </span><span class="nf">record_findings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]):</span>
</span><span id="__span-15-62"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record discovered findings.&quot;&quot;&quot;</span>
</span><span id="__span-15-63">        <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
</span><span id="__span-15-64">            <span class="bp">self</span><span class="o">.</span><span class="n">findings_discovered</span><span class="o">.</span><span class="n">labels</span><span class="p">(</span>
</span><span id="__span-15-65">                <span class="n">severity</span><span class="o">=</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;severity&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="__span-15-66">            <span class="p">)</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span>
</span><span id="__span-15-67">
</span><span id="__span-15-68">    <span class="k">def</span><span class="w"> </span><span class="nf">update_queue_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="__span-15-69"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update queue size gauge.&quot;&quot;&quot;</span>
</span><span id="__span-15-70">        <span class="bp">self</span><span class="o">.</span><span class="n">queue_size</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span><span id="__span-15-71">
</span><span id="__span-15-72">    <span class="k">def</span><span class="w"> </span><span class="nf">update_memory_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-15-73"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update memory usage gauge.&quot;&quot;&quot;</span>
</span><span id="__span-15-74">        <span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
</span><span id="__span-15-75">        <span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
</span><span id="__span-15-76">        <span class="n">memory_bytes</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span>
</span><span id="__span-15-77">        <span class="bp">self</span><span class="o">.</span><span class="n">memory_usage</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">memory_bytes</span><span class="p">)</span>
</span><span id="__span-15-78">
</span><span id="__span-15-79"><span class="c1"># Global metrics instance</span>
</span><span id="__span-15-80"><span class="n">metrics</span> <span class="o">=</span> <span class="n">AuditMetrics</span><span class="p">()</span>
</span></code></pre></div>
<h4 id="health-checks">Health Checks</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span>
</span><span id="__span-16-2"><span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
</span><span id="__span-16-3"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-16-4">
</span><span id="__span-16-5"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="__span-16-6">
</span><span id="__span-16-7"><span class="k">class</span><span class="w"> </span><span class="nc">HealthChecker</span><span class="p">:</span>
</span><span id="__span-16-8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Comprehensive health checking.&quot;&quot;&quot;</span>
</span><span id="__span-16-9">
</span><span id="__span-16-10">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-16-11">        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-16-12">        <span class="bp">self</span><span class="o">.</span><span class="n">last_health_check</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-16-13">        <span class="bp">self</span><span class="o">.</span><span class="n">health_check_interval</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># seconds</span>
</span><span id="__span-16-14">
</span><span id="__span-16-15">    <span class="k">def</span><span class="w"> </span><span class="nf">check_database</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-16-16"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check database connectivity.&quot;&quot;&quot;</span>
</span><span id="__span-16-17">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-16-18">            <span class="c1"># Database connection test</span>
</span><span id="__span-16-19">            <span class="n">db_connection_test</span><span class="p">()</span>
</span><span id="__span-16-20">            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span><span class="p">,</span> <span class="s2">&quot;response_time&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>
</span><span id="__span-16-21">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-16-22">            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;unhealthy&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span id="__span-16-23">
</span><span id="__span-16-24">    <span class="k">def</span><span class="w"> </span><span class="nf">check_redis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-16-25"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check Redis connectivity.&quot;&quot;&quot;</span>
</span><span id="__span-16-26">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-16-27">            <span class="n">redis_connection_test</span><span class="p">()</span>
</span><span id="__span-16-28">            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span><span class="p">,</span> <span class="s2">&quot;response_time&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>
</span><span id="__span-16-29">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-16-30">            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;unhealthy&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span id="__span-16-31">
</span><span id="__span-16-32">    <span class="k">def</span><span class="w"> </span><span class="nf">check_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-16-33"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check analysis tools availability.&quot;&quot;&quot;</span>
</span><span id="__span-16-34">        <span class="n">tools_status</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-16-35">
</span><span id="__span-16-36">        <span class="c1"># Check Slither</span>
</span><span id="__span-16-37">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-16-38">            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="__span-16-39">                <span class="p">[</span><span class="s2">&quot;slither&quot;</span><span class="p">,</span> <span class="s2">&quot;--version&quot;</span><span class="p">],</span>
</span><span id="__span-16-40">                <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-16-41">                <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span>
</span><span id="__span-16-42">            <span class="p">)</span>
</span><span id="__span-16-43">            <span class="n">tools_status</span><span class="p">[</span><span class="s2">&quot;slither&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-16-44">                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;unhealthy&quot;</span><span class="p">,</span>
</span><span id="__span-16-45">                <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-16-46">            <span class="p">}</span>
</span><span id="__span-16-47">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-16-48">            <span class="n">tools_status</span><span class="p">[</span><span class="s2">&quot;slither&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;unhealthy&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span id="__span-16-49">
</span><span id="__span-16-50">        <span class="k">return</span> <span class="n">tools_status</span>
</span><span id="__span-16-51">
</span><span id="__span-16-52">    <span class="k">def</span><span class="w"> </span><span class="nf">check_system_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-16-53"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check system resource usage.&quot;&quot;&quot;</span>
</span><span id="__span-16-54">        <span class="n">cpu_percent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-16-55">        <span class="n">memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span>
</span><span id="__span-16-56">        <span class="n">disk</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span><span id="__span-16-57">
</span><span id="__span-16-58">        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-16-59">            <span class="s2">&quot;cpu_usage&quot;</span><span class="p">:</span> <span class="n">cpu_percent</span><span class="p">,</span>
</span><span id="__span-16-60">            <span class="s2">&quot;memory_usage&quot;</span><span class="p">:</span> <span class="n">memory</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
</span><span id="__span-16-61">            <span class="s2">&quot;disk_usage&quot;</span><span class="p">:</span> <span class="n">disk</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
</span><span id="__span-16-62">            <span class="s2">&quot;cpu_status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span> <span class="k">if</span> <span class="n">cpu_percent</span> <span class="o">&lt;</span> <span class="mi">90</span> <span class="k">else</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span>
</span><span id="__span-16-63">            <span class="s2">&quot;memory_status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span> <span class="k">if</span> <span class="n">memory</span><span class="o">.</span><span class="n">percent</span> <span class="o">&lt;</span> <span class="mi">85</span> <span class="k">else</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span>
</span><span id="__span-16-64">            <span class="s2">&quot;disk_status&quot;</span><span class="p">:</span> <span class="s2">&quot;healthy&quot;</span> <span class="k">if</span> <span class="n">disk</span><span class="o">.</span><span class="n">percent</span> <span class="o">&lt;</span> <span class="mi">90</span> <span class="k">else</span> <span class="s2">&quot;warning&quot;</span>
</span><span id="__span-16-65">        <span class="p">}</span>
</span><span id="__span-16-66">
</span><span id="__span-16-67">    <span class="k">def</span><span class="w"> </span><span class="nf">overall_health</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-16-68"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return overall system health.&quot;&quot;&quot;</span>
</span><span id="__span-16-69">        <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-16-70">
</span><span id="__span-16-71">        <span class="c1"># Cache health checks</span>
</span><span id="__span-16-72">        <span class="k">if</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_health_check</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">health_check_interval</span><span class="p">:</span>
</span><span id="__span-16-73">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_health</span>
</span><span id="__span-16-74">
</span><span id="__span-16-75">        <span class="c1"># Perform comprehensive health check</span>
</span><span id="__span-16-76">        <span class="n">health_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-16-77">            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">current_time</span><span class="p">,</span>
</span><span id="__span-16-78">            <span class="s2">&quot;uptime&quot;</span><span class="p">:</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span>
</span><span id="__span-16-79">            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">get_version</span><span class="p">(),</span>
</span><span id="__span-16-80">            <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_database</span><span class="p">(),</span>
</span><span id="__span-16-81">            <span class="s2">&quot;redis&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_redis</span><span class="p">(),</span>
</span><span id="__span-16-82">            <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_tools</span><span class="p">(),</span>
</span><span id="__span-16-83">            <span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_system_resources</span><span class="p">()</span>
</span><span id="__span-16-84">        <span class="p">}</span>
</span><span id="__span-16-85">
</span><span id="__span-16-86">        <span class="c1"># Determine overall status</span>
</span><span id="__span-16-87">        <span class="n">component_statuses</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-16-88">            <span class="n">health_data</span><span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">],</span>
</span><span id="__span-16-89">            <span class="n">health_data</span><span class="p">[</span><span class="s2">&quot;redis&quot;</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">],</span>
</span><span id="__span-16-90">            <span class="n">health_data</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">][</span><span class="s2">&quot;cpu_status&quot;</span><span class="p">],</span>
</span><span id="__span-16-91">            <span class="n">health_data</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">][</span><span class="s2">&quot;memory_status&quot;</span><span class="p">],</span>
</span><span id="__span-16-92">            <span class="n">health_data</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">][</span><span class="s2">&quot;disk_status&quot;</span><span class="p">]</span>
</span><span id="__span-16-93">        <span class="p">]</span>
</span><span id="__span-16-94">
</span><span id="__span-16-95">        <span class="k">if</span> <span class="s2">&quot;unhealthy&quot;</span> <span class="ow">in</span> <span class="n">component_statuses</span><span class="p">:</span>
</span><span id="__span-16-96">            <span class="n">overall_status</span> <span class="o">=</span> <span class="s2">&quot;unhealthy&quot;</span>
</span><span id="__span-16-97">        <span class="k">elif</span> <span class="s2">&quot;warning&quot;</span> <span class="ow">in</span> <span class="n">component_statuses</span><span class="p">:</span>
</span><span id="__span-16-98">            <span class="n">overall_status</span> <span class="o">=</span> <span class="s2">&quot;warning&quot;</span>
</span><span id="__span-16-99">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-16-100">            <span class="n">overall_status</span> <span class="o">=</span> <span class="s2">&quot;healthy&quot;</span>
</span><span id="__span-16-101">
</span><span id="__span-16-102">        <span class="n">health_data</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">overall_status</span>
</span><span id="__span-16-103">        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_health</span> <span class="o">=</span> <span class="n">health_data</span>
</span><span id="__span-16-104">        <span class="bp">self</span><span class="o">.</span><span class="n">last_health_check</span> <span class="o">=</span> <span class="n">current_time</span>
</span><span id="__span-16-105">
</span><span id="__span-16-106">        <span class="k">return</span> <span class="n">health_data</span>
</span><span id="__span-16-107">
</span><span id="__span-16-108"><span class="n">health_checker</span> <span class="o">=</span> <span class="n">HealthChecker</span><span class="p">()</span>
</span><span id="__span-16-109">
</span><span id="__span-16-110"><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/health&#39;</span><span class="p">)</span>
</span><span id="__span-16-111"><span class="k">def</span><span class="w"> </span><span class="nf">health</span><span class="p">():</span>
</span><span id="__span-16-112"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Health check endpoint.&quot;&quot;&quot;</span>
</span><span id="__span-16-113">    <span class="n">health_data</span> <span class="o">=</span> <span class="n">health_checker</span><span class="o">.</span><span class="n">overall_health</span><span class="p">()</span>
</span><span id="__span-16-114">    <span class="n">status_code</span> <span class="o">=</span> <span class="mi">200</span> <span class="k">if</span> <span class="n">health_data</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;healthy&quot;</span> <span class="k">else</span> <span class="mi">503</span>
</span><span id="__span-16-115">    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">health_data</span><span class="p">),</span> <span class="n">status_code</span>
</span><span id="__span-16-116">
</span><span id="__span-16-117"><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/health/detailed&#39;</span><span class="p">)</span>
</span><span id="__span-16-118"><span class="k">def</span><span class="w"> </span><span class="nf">detailed_health</span><span class="p">():</span>
</span><span id="__span-16-119"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Detailed health check endpoint.&quot;&quot;&quot;</span>
</span><span id="__span-16-120">    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">health_checker</span><span class="o">.</span><span class="n">overall_health</span><span class="p">())</span>
</span></code></pre></div>
<h3 id="logging-configuration">Logging Configuration</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><span class="c1"># logging_config.yaml</span>
</span><span id="__span-17-2"><span class="n">version</span><span class="p">:</span> <span class="mi">1</span>
</span><span id="__span-17-3"><span class="n">disable_existing_loggers</span><span class="p">:</span> <span class="n">false</span>
</span><span id="__span-17-4">
</span><span id="__span-17-5"><span class="n">formatters</span><span class="p">:</span>
</span><span id="__span-17-6">  <span class="n">json</span><span class="p">:</span>
</span><span id="__span-17-7">    <span class="n">class</span><span class="p">:</span> <span class="n">pythonjsonlogger</span><span class="o">.</span><span class="n">jsonlogger</span><span class="o">.</span><span class="n">JsonFormatter</span>
</span><span id="__span-17-8">    <span class="nb">format</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(name)s</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
</span><span id="__span-17-9">
</span><span id="__span-17-10">  <span class="n">detailed</span><span class="p">:</span>
</span><span id="__span-17-11">    <span class="nb">format</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(name)s</span><span class="s2"> - </span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2"> - </span><span class="si">%(pathname)s</span><span class="s2">:</span><span class="si">%(lineno)d</span><span class="s2">&quot;</span>
</span><span id="__span-17-12">
</span><span id="__span-17-13"><span class="n">handlers</span><span class="p">:</span>
</span><span id="__span-17-14">  <span class="n">console</span><span class="p">:</span>
</span><span id="__span-17-15">    <span class="n">class</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span>
</span><span id="__span-17-16">    <span class="n">level</span><span class="p">:</span> <span class="n">INFO</span>
</span><span id="__span-17-17">    <span class="n">formatter</span><span class="p">:</span> <span class="n">detailed</span>
</span><span id="__span-17-18">    <span class="n">stream</span><span class="p">:</span> <span class="n">ext</span><span class="p">:</span><span class="o">//</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
</span><span id="__span-17-19">
</span><span id="__span-17-20">  <span class="n">file</span><span class="p">:</span>
</span><span id="__span-17-21">    <span class="n">class</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span>
</span><span id="__span-17-22">    <span class="n">level</span><span class="p">:</span> <span class="n">INFO</span>
</span><span id="__span-17-23">    <span class="n">formatter</span><span class="p">:</span> <span class="n">json</span>
</span><span id="__span-17-24">    <span class="n">filename</span><span class="p">:</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">web3audit</span><span class="o">/</span><span class="n">application</span><span class="o">.</span><span class="n">log</span>
</span><span id="__span-17-25">    <span class="n">maxBytes</span><span class="p">:</span> <span class="mi">10485760</span>  <span class="c1"># 10MB</span>
</span><span id="__span-17-26">    <span class="n">backupCount</span><span class="p">:</span> <span class="mi">5</span>
</span><span id="__span-17-27">
</span><span id="__span-17-28">  <span class="n">error_file</span><span class="p">:</span>
</span><span id="__span-17-29">    <span class="n">class</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span>
</span><span id="__span-17-30">    <span class="n">level</span><span class="p">:</span> <span class="n">ERROR</span>
</span><span id="__span-17-31">    <span class="n">formatter</span><span class="p">:</span> <span class="n">json</span>
</span><span id="__span-17-32">    <span class="n">filename</span><span class="p">:</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">web3audit</span><span class="o">/</span><span class="n">error</span><span class="o">.</span><span class="n">log</span>
</span><span id="__span-17-33">    <span class="n">maxBytes</span><span class="p">:</span> <span class="mi">10485760</span>
</span><span id="__span-17-34">    <span class="n">backupCount</span><span class="p">:</span> <span class="mi">10</span>
</span><span id="__span-17-35">
</span><span id="__span-17-36">  <span class="n">audit_trail</span><span class="p">:</span>
</span><span id="__span-17-37">    <span class="n">class</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span>
</span><span id="__span-17-38">    <span class="n">level</span><span class="p">:</span> <span class="n">INFO</span>
</span><span id="__span-17-39">    <span class="n">formatter</span><span class="p">:</span> <span class="n">json</span>
</span><span id="__span-17-40">    <span class="n">filename</span><span class="p">:</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">web3audit</span><span class="o">/</span><span class="n">audit_trail</span><span class="o">.</span><span class="n">log</span>
</span><span id="__span-17-41">    <span class="n">maxBytes</span><span class="p">:</span> <span class="mi">10485760</span>
</span><span id="__span-17-42">    <span class="n">backupCount</span><span class="p">:</span> <span class="mi">30</span>
</span><span id="__span-17-43">
</span><span id="__span-17-44"><span class="n">loggers</span><span class="p">:</span>
</span><span id="__span-17-45">  <span class="n">web3_security_ai</span><span class="p">:</span>
</span><span id="__span-17-46">    <span class="n">level</span><span class="p">:</span> <span class="n">INFO</span>
</span><span id="__span-17-47">    <span class="n">handlers</span><span class="p">:</span> <span class="p">[</span><span class="n">console</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">error_file</span><span class="p">]</span>
</span><span id="__span-17-48">    <span class="n">propagate</span><span class="p">:</span> <span class="n">false</span>
</span><span id="__span-17-49">
</span><span id="__span-17-50">  <span class="n">audit_trail</span><span class="p">:</span>
</span><span id="__span-17-51">    <span class="n">level</span><span class="p">:</span> <span class="n">INFO</span>
</span><span id="__span-17-52">    <span class="n">handlers</span><span class="p">:</span> <span class="p">[</span><span class="n">audit_trail</span><span class="p">]</span>
</span><span id="__span-17-53">    <span class="n">propagate</span><span class="p">:</span> <span class="n">false</span>
</span><span id="__span-17-54">
</span><span id="__span-17-55"><span class="n">root</span><span class="p">:</span>
</span><span id="__span-17-56">  <span class="n">level</span><span class="p">:</span> <span class="n">INFO</span>
</span><span id="__span-17-57">  <span class="n">handlers</span><span class="p">:</span> <span class="p">[</span><span class="n">console</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">error_file</span><span class="p">]</span>
</span></code></pre></div>
<h3 id="alerting">Alerting</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.monitoring</span><span class="w"> </span><span class="kn">import</span> <span class="n">AlertManager</span>
</span><span id="__span-18-2">
</span><span id="__span-18-3"><span class="k">class</span><span class="w"> </span><span class="nc">ProductionAlertManager</span><span class="p">(</span><span class="n">AlertManager</span><span class="p">):</span>
</span><span id="__span-18-4"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Production alerting system.&quot;&quot;&quot;</span>
</span><span id="__span-18-5">
</span><span id="__span-18-6">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-18-7">        <span class="bp">self</span><span class="o">.</span><span class="n">alert_channels</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-18-8">            <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="n">EmailAlertChannel</span><span class="p">(),</span>
</span><span id="__span-18-9">            <span class="s2">&quot;slack&quot;</span><span class="p">:</span> <span class="n">SlackAlertChannel</span><span class="p">(),</span>
</span><span id="__span-18-10">            <span class="s2">&quot;pagerduty&quot;</span><span class="p">:</span> <span class="n">PagerDutyAlertChannel</span><span class="p">()</span>
</span><span id="__span-18-11">        <span class="p">}</span>
</span><span id="__span-18-12">
</span><span id="__span-18-13">    <span class="k">def</span><span class="w"> </span><span class="nf">alert_critical_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-18-14"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Alert on critical system failures.&quot;&quot;&quot;</span>
</span><span id="__span-18-15">        <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-18-16">            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;critical&quot;</span><span class="p">,</span>
</span><span id="__span-18-17">            <span class="s2">&quot;component&quot;</span><span class="p">:</span> <span class="n">component</span><span class="p">,</span>
</span><span id="__span-18-18">            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Critical failure in </span><span class="si">{</span><span class="n">component</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-18-19">            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
</span><span id="__span-18-20">        <span class="p">}</span>
</span><span id="__span-18-21">
</span><span id="__span-18-22">        <span class="c1"># Send to all channels</span>
</span><span id="__span-18-23">        <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alert_channels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="__span-18-24">            <span class="n">channel</span><span class="o">.</span><span class="n">send_alert</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
</span><span id="__span-18-25">
</span><span id="__span-18-26">    <span class="k">def</span><span class="w"> </span><span class="nf">alert_performance_degradation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="__span-18-27"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Alert on performance degradation.&quot;&quot;&quot;</span>
</span><span id="__span-18-28">        <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-18-29">            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span>
</span><span id="__span-18-30">            <span class="s2">&quot;component&quot;</span><span class="p">:</span> <span class="s2">&quot;performance&quot;</span><span class="p">,</span>
</span><span id="__span-18-31">            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Performance degradation: </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> (threshold: </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
</span><span id="__span-18-32">            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
</span><span id="__span-18-33">        <span class="p">}</span>
</span><span id="__span-18-34">
</span><span id="__span-18-35">        <span class="c1"># Send to monitoring channels only</span>
</span><span id="__span-18-36">        <span class="bp">self</span><span class="o">.</span><span class="n">alert_channels</span><span class="p">[</span><span class="s2">&quot;slack&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">send_alert</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
</span><span id="__span-18-37">        <span class="bp">self</span><span class="o">.</span><span class="n">alert_channels</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">send_alert</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
</span><span id="__span-18-38">
</span><span id="__span-18-39">    <span class="k">def</span><span class="w"> </span><span class="nf">alert_security_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-18-40"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Alert on security incidents.&quot;&quot;&quot;</span>
</span><span id="__span-18-41">        <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-18-42">            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;critical&quot;</span><span class="p">,</span>
</span><span id="__span-18-43">            <span class="s2">&quot;component&quot;</span><span class="p">:</span> <span class="s2">&quot;security&quot;</span><span class="p">,</span>
</span><span id="__span-18-44">            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Security incident detected: </span><span class="si">{</span><span class="n">incident_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-18-45">            <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="n">details</span><span class="p">,</span>
</span><span id="__span-18-46">            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
</span><span id="__span-18-47">        <span class="p">}</span>
</span><span id="__span-18-48">
</span><span id="__span-18-49">        <span class="c1"># Send to all channels with high priority</span>
</span><span id="__span-18-50">        <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alert_channels</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="__span-18-51">            <span class="n">channel</span><span class="o">.</span><span class="n">send_alert</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="performance-tuning">Performance Tuning</h2>
<h3 id="memory-optimization">Memory Optimization</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><span class="kn">import</span><span class="w"> </span><span class="nn">gc</span>
</span><span id="__span-19-2"><span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
</span><span id="__span-19-3"><span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">lru_cache</span>
</span><span id="__span-19-4">
</span><span id="__span-19-5"><span class="k">class</span><span class="w"> </span><span class="nc">MemoryOptimizer</span><span class="p">:</span>
</span><span id="__span-19-6"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Memory optimization strategies.&quot;&quot;&quot;</span>
</span><span id="__span-19-7">
</span><span id="__span-19-8">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_memory_gb</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">):</span>
</span><span id="__span-19-9">        <span class="bp">self</span><span class="o">.</span><span class="n">max_memory_gb</span> <span class="o">=</span> <span class="n">max_memory_gb</span>
</span><span id="__span-19-10">        <span class="bp">self</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
</span><span id="__span-19-11">
</span><span id="__span-19-12">    <span class="k">def</span><span class="w"> </span><span class="nf">should_gc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-19-13"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if garbage collection should be run.&quot;&quot;&quot;</span>
</span><span id="__span-19-14">        <span class="n">memory_usage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_usage_gb</span><span class="p">()</span>
</span><span id="__span-19-15">        <span class="k">return</span> <span class="n">memory_usage</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_memory_gb</span> <span class="o">*</span> <span class="mf">0.8</span>
</span><span id="__span-19-16">
</span><span id="__span-19-17">    <span class="k">def</span><span class="w"> </span><span class="nf">get_memory_usage_gb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-19-18"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current memory usage in GB.&quot;&quot;&quot;</span>
</span><span id="__span-19-19">        <span class="n">memory_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span>
</span><span id="__span-19-20">        <span class="k">return</span> <span class="n">memory_info</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-19-21">
</span><span id="__span-19-22">    <span class="k">def</span><span class="w"> </span><span class="nf">optimize_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-19-23"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform memory optimization.&quot;&quot;&quot;</span>
</span><span id="__span-19-24">        <span class="c1"># Force garbage collection</span>
</span><span id="__span-19-25">        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span><span id="__span-19-26">
</span><span id="__span-19-27">        <span class="c1"># Clear LRU caches if they exist</span>
</span><span id="__span-19-28">        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;analysis_cache&#39;</span><span class="p">):</span>
</span><span id="__span-19-29">            <span class="bp">self</span><span class="o">.</span><span class="n">analysis_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="__span-19-30">
</span><span id="__span-19-31">        <span class="c1"># Clear any temporary data structures</span>
</span><span id="__span-19-32">        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_temp_data</span><span class="p">()</span>
</span><span id="__span-19-33">
</span><span id="__span-19-34">    <span class="k">def</span><span class="w"> </span><span class="nf">_clear_temp_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-19-35"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear temporary data structures.&quot;&quot;&quot;</span>
</span><span id="__span-19-36">        <span class="c1"># Implementation depends on specific data structures used</span>
</span><span id="__span-19-37">        <span class="k">pass</span>
</span><span id="__span-19-38">
</span><span id="__span-19-39"><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-19-40"><span class="k">def</span><span class="w"> </span><span class="nf">cached_contract_analysis</span><span class="p">(</span><span class="n">contract_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">analysis_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-19-41"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Cache contract analysis results.&quot;&quot;&quot;</span>
</span><span id="__span-19-42">    <span class="c1"># Implementation</span>
</span><span id="__span-19-43">    <span class="k">pass</span>
</span></code></pre></div>
<h3 id="cpu-optimization">CPU Optimization</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>
</span><span id="__span-20-2"><span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span><span class="p">,</span> <span class="n">ProcessPoolExecutor</span>
</span><span id="__span-20-3">
</span><span id="__span-20-4"><span class="k">class</span><span class="w"> </span><span class="nc">CPUOptimizer</span><span class="p">:</span>
</span><span id="__span-20-5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;CPU optimization strategies.&quot;&quot;&quot;</span>
</span><span id="__span-20-6">
</span><span id="__span-20-7">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-20-8">        <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
</span><span id="__span-20-9">
</span><span id="__span-20-10">    <span class="k">def</span><span class="w"> </span><span class="nf">get_optimal_thread_pool_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-20-11"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get optimal thread pool size for task type.&quot;&quot;&quot;</span>
</span><span id="__span-20-12">        <span class="k">if</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;io_bound&#39;</span><span class="p">:</span>
</span><span id="__span-20-13">            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># More threads for I/O</span>
</span><span id="__span-20-14">        <span class="k">elif</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;cpu_bound&#39;</span><span class="p">:</span>
</span><span id="__span-20-15">            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Fewer threads for CPU</span>
</span><span id="__span-20-16">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-20-17">            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-20-18">
</span><span id="__span-20-19">    <span class="k">def</span><span class="w"> </span><span class="nf">get_optimal_process_pool_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="__span-20-20"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get optimal process pool size.&quot;&quot;&quot;</span>
</span><span id="__span-20-21">        <span class="k">if</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;memory_intensive&#39;</span><span class="p">:</span>
</span><span id="__span-20-22">            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Fewer processes for memory</span>
</span><span id="__span-20-23">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-20-24">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span>
</span><span id="__span-20-25">
</span><span id="__span-20-26">    <span class="k">def</span><span class="w"> </span><span class="nf">create_optimal_executor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-20-27"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create optimally configured executor.&quot;&quot;&quot;</span>
</span><span id="__span-20-28">        <span class="k">if</span> <span class="n">task_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;io_bound&#39;</span><span class="p">,</span> <span class="s1">&#39;network&#39;</span><span class="p">]:</span>
</span><span id="__span-20-29">            <span class="n">pool_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_optimal_thread_pool_size</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span>
</span><span id="__span-20-30">            <span class="k">return</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">pool_size</span><span class="p">)</span>
</span><span id="__span-20-31">        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-20-32">            <span class="n">pool_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_optimal_process_pool_size</span><span class="p">(</span><span class="n">task_type</span><span class="p">)</span>
</span><span id="__span-20-33">            <span class="k">return</span> <span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">pool_size</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="database-optimization">Database Optimization</h3>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-21-1"><span class="c1">-- Optimized database indexes</span>
</span><span id="__span-21-2"><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">CONCURRENTLY</span><span class="w"> </span><span class="n">idx_audit_sessions_status_created</span>
</span><span id="__span-21-3"><span class="k">ON</span><span class="w"> </span><span class="n">audit_sessions</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">created_at</span><span class="w"> </span><span class="k">DESC</span><span class="p">);</span>
</span><span id="__span-21-4">
</span><span id="__span-21-5"><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">CONCURRENTLY</span><span class="w"> </span><span class="n">idx_audit_findings_audit_id_severity</span>
</span><span id="__span-21-6"><span class="k">ON</span><span class="w"> </span><span class="n">audit_findings</span><span class="w"> </span><span class="p">(</span><span class="n">audit_id</span><span class="p">,</span><span class="w"> </span><span class="n">severity</span><span class="p">);</span>
</span><span id="__span-21-7">
</span><span id="__span-21-8"><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">CONCURRENTLY</span><span class="w"> </span><span class="n">idx_audit_findings_type</span>
</span><span id="__span-21-9"><span class="k">ON</span><span class="w"> </span><span class="n">audit_findings</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">gin</span><span class="w"> </span><span class="p">(</span><span class="k">type</span><span class="w"> </span><span class="n">gin_trgm_ops</span><span class="p">);</span>
</span><span id="__span-21-10">
</span><span id="__span-21-11"><span class="c1">-- Partitioning for large tables</span>
</span><span id="__span-21-12"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">audit_sessions_y2024m01</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="n">audit_sessions</span>
</span><span id="__span-21-13"><span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;2024-02-01&#39;</span><span class="p">);</span>
</span><span id="__span-21-14">
</span><span id="__span-21-15"><span class="c1">-- Database configuration optimizations</span>
</span><span id="__span-21-16"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">shared_buffers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;256MB&#39;</span><span class="p">;</span>
</span><span id="__span-21-17"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">effective_cache_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1GB&#39;</span><span class="p">;</span>
</span><span id="__span-21-18"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">work_mem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;4MB&#39;</span><span class="p">;</span>
</span><span id="__span-21-19"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">maintenance_work_mem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;64MB&#39;</span><span class="p">;</span>
</span><span id="__span-21-20"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">checkpoint_completion_target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">9</span><span class="p">;</span>
</span><span id="__span-21-21"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">wal_buffers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;16MB&#39;</span><span class="p">;</span>
</span><span id="__span-21-22"><span class="k">ALTER</span><span class="w"> </span><span class="k">SYSTEM</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">default_statistics_target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
</span></code></pre></div>
<h3 id="caching-strategies">Caching Strategies</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><span class="kn">from</span><span class="w"> </span><span class="nn">cachetools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TTLCache</span><span class="p">,</span> <span class="n">LRUCache</span>
</span><span id="__span-22-2"><span class="kn">import</span><span class="w"> </span><span class="nn">redis</span>
</span><span id="__span-22-3">
</span><span id="__span-22-4"><span class="k">class</span><span class="w"> </span><span class="nc">CacheManager</span><span class="p">:</span>
</span><span id="__span-22-5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Multi-level caching system.&quot;&quot;&quot;</span>
</span><span id="__span-22-6">
</span><span id="__span-22-7">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">redis_client</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-22-8">        <span class="c1"># L1: In-memory LRU cache</span>
</span><span id="__span-22-9">        <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span> <span class="o">=</span> <span class="n">LRUCache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="__span-22-10">
</span><span id="__span-22-11">        <span class="c1"># L2: TTL cache for temporary data</span>
</span><span id="__span-22-12">        <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span> <span class="o">=</span> <span class="n">TTLCache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
</span><span id="__span-22-13">
</span><span id="__span-22-14">        <span class="c1"># L3: Redis for distributed caching</span>
</span><span id="__span-22-15">        <span class="bp">self</span><span class="o">.</span><span class="n">redis</span> <span class="o">=</span> <span class="n">redis_client</span>
</span><span id="__span-22-16">
</span><span id="__span-22-17">    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-22-18"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get value from cache hierarchy.&quot;&quot;&quot;</span>
</span><span id="__span-22-19">        <span class="c1"># Check L1 cache</span>
</span><span id="__span-22-20">        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-22-21">        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-22-22">            <span class="k">return</span> <span class="n">value</span>
</span><span id="__span-22-23">
</span><span id="__span-22-24">        <span class="c1"># Check L2 cache</span>
</span><span id="__span-22-25">        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-22-26">        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-22-27">            <span class="c1"># Promote to L1</span>
</span><span id="__span-22-28">            <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-22-29">            <span class="k">return</span> <span class="n">value</span>
</span><span id="__span-22-30">
</span><span id="__span-22-31">        <span class="c1"># Check Redis</span>
</span><span id="__span-22-32">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="p">:</span>
</span><span id="__span-22-33">            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="__span-22-34">            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-22-35">                <span class="c1"># Promote to higher caches</span>
</span><span id="__span-22-36">                <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-22-37">                <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-22-38">                <span class="k">return</span> <span class="n">value</span>
</span><span id="__span-22-39">
</span><span id="__span-22-40">        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-22-41">
</span><span id="__span-22-42">    <span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ttl</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-22-43"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set value in cache hierarchy.&quot;&quot;&quot;</span>
</span><span id="__span-22-44">        <span class="c1"># Set in L1</span>
</span><span id="__span-22-45">        <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-22-46">
</span><span id="__span-22-47">        <span class="c1"># Set in L2 with TTL</span>
</span><span id="__span-22-48">        <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="__span-22-49">
</span><span id="__span-22-50">        <span class="c1"># Set in Redis with TTL</span>
</span><span id="__span-22-51">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="p">:</span>
</span><span id="__span-22-52">            <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">setex</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ttl</span> <span class="ow">or</span> <span class="mi">3600</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="__span-22-53">
</span><span id="__span-22-54">    <span class="k">def</span><span class="w"> </span><span class="nf">invalidate_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-22-55"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Invalidate cache entries matching pattern.&quot;&quot;&quot;</span>
</span><span id="__span-22-56">        <span class="c1"># Invalidate L1 and L2 (simplified)</span>
</span><span id="__span-22-57">        <span class="n">keys_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">k</span><span class="p">]</span>
</span><span id="__span-22-58">        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys_to_remove</span><span class="p">:</span>
</span><span id="__span-22-59">            <span class="bp">self</span><span class="o">.</span><span class="n">l1_cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-22-60">            <span class="bp">self</span><span class="o">.</span><span class="n">l2_cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-22-61">
</span><span id="__span-22-62">        <span class="c1"># Invalidate Redis</span>
</span><span id="__span-22-63">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="p">:</span>
</span><span id="__span-22-64">            <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
</span><span id="__span-22-65">            <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="__span-22-66">                <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="backup-and-recovery">Backup and Recovery</h2>
<h3 id="database-backup">Database Backup</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-23-2"><span class="c1"># Database backup script</span>
</span><span id="__span-23-3">
</span><span id="__span-23-4"><span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&quot;/opt/web3audit/backups&quot;</span>
</span><span id="__span-23-5"><span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date<span class="w"> </span>+%Y%m%d_%H%M%S<span class="k">)</span>
</span><span id="__span-23-6"><span class="nv">BACKUP_NAME</span><span class="o">=</span><span class="s2">&quot;web3audit_backup_</span><span class="nv">$DATE</span><span class="s2">&quot;</span>
</span><span id="__span-23-7">
</span><span id="__span-23-8"><span class="c1"># Create backup directory</span>
</span><span id="__span-23-9">mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$BACKUP_DIR</span>
</span><span id="__span-23-10">
</span><span id="__span-23-11"><span class="c1"># Database backup</span>
</span><span id="__span-23-12">pg_dump<span class="w"> </span>-h<span class="w"> </span>localhost<span class="w"> </span>-U<span class="w"> </span>web3audit<span class="w"> </span>-d<span class="w"> </span>web3audit<span class="w"> </span>-Fc<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/<span class="si">${</span><span class="nv">BACKUP_NAME</span><span class="si">}</span>.dump
</span><span id="__span-23-13">
</span><span id="__span-23-14"><span class="c1"># Compress backup</span>
</span><span id="__span-23-15">gzip<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/<span class="si">${</span><span class="nv">BACKUP_NAME</span><span class="si">}</span>.dump
</span><span id="__span-23-16">
</span><span id="__span-23-17"><span class="c1"># Upload to cloud storage</span>
</span><span id="__span-23-18">aws<span class="w"> </span>s3<span class="w"> </span>cp<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/<span class="si">${</span><span class="nv">BACKUP_NAME</span><span class="si">}</span>.dump.gz<span class="w"> </span>s3://web3audit-backups/database/
</span><span id="__span-23-19">
</span><span id="__span-23-20"><span class="c1"># Clean old backups (keep last 30 days)</span>
</span><span id="__span-23-21">find<span class="w"> </span><span class="nv">$BACKUP_DIR</span><span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.dump.gz&quot;</span><span class="w"> </span>-mtime<span class="w"> </span>+30<span class="w"> </span>-delete
</span><span id="__span-23-22">
</span><span id="__span-23-23"><span class="c1"># Log backup completion</span>
</span><span id="__span-23-24"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>date<span class="k">)</span><span class="s2">: Database backup completed - </span><span class="nv">$BACKUP_NAME</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/var/log/web3audit/backup.log
</span></code></pre></div>
<h3 id="configuration-backup">Configuration Backup</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-24-2"><span class="c1"># Configuration backup script</span>
</span><span id="__span-24-3">
</span><span id="__span-24-4"><span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&quot;/opt/web3audit/backups/config&quot;</span>
</span><span id="__span-24-5"><span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date<span class="w"> </span>+%Y%m%d_%H%M%S<span class="k">)</span>
</span><span id="__span-24-6">
</span><span id="__span-24-7"><span class="c1"># Create backup directory</span>
</span><span id="__span-24-8">mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$BACKUP_DIR</span>
</span><span id="__span-24-9">
</span><span id="__span-24-10"><span class="c1"># Backup configurations</span>
</span><span id="__span-24-11">tar<span class="w"> </span>-czf<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/config_backup_<span class="nv">$DATE</span>.tar.gz<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-12"><span class="w">    </span>/opt/web3audit/.env<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-13"><span class="w">    </span>/opt/web3audit/app/config/<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-14"><span class="w">    </span>/etc/systemd/system/web3audit.service<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-15"><span class="w">    </span>/etc/nginx/sites-available/web3audit
</span><span id="__span-24-16">
</span><span id="__span-24-17"><span class="c1"># Upload to cloud storage</span>
</span><span id="__span-24-18">aws<span class="w"> </span>s3<span class="w"> </span>cp<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/config_backup_<span class="nv">$DATE</span>.tar.gz<span class="w"> </span>s3://web3audit-backups/config/
</span><span id="__span-24-19">
</span><span id="__span-24-20"><span class="c1"># Clean old backups (keep last 90 days)</span>
</span><span id="__span-24-21">find<span class="w"> </span><span class="nv">$BACKUP_DIR</span><span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.tar.gz&quot;</span><span class="w"> </span>-mtime<span class="w"> </span>+90<span class="w"> </span>-delete
</span></code></pre></div>
<h3 id="file-system-backup">File System Backup</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-25-2"><span class="c1"># File system backup script</span>
</span><span id="__span-25-3">
</span><span id="__span-25-4"><span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&quot;/opt/web3audit/backups/filesystem&quot;</span>
</span><span id="__span-25-5"><span class="nv">SOURCE_DIR</span><span class="o">=</span><span class="s2">&quot;/opt/web3audit&quot;</span>
</span><span id="__span-25-6"><span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date<span class="w"> </span>+%Y%m%d_%H%M%S<span class="k">)</span>
</span><span id="__span-25-7">
</span><span id="__span-25-8"><span class="c1"># Create backup directory</span>
</span><span id="__span-25-9">mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$BACKUP_DIR</span>
</span><span id="__span-25-10">
</span><span id="__span-25-11"><span class="c1"># Backup application data (excluding logs and temp files)</span>
</span><span id="__span-25-12">rsync<span class="w"> </span>-av<span class="w"> </span>--exclude<span class="o">=</span><span class="s1">&#39;logs/&#39;</span><span class="w"> </span>--exclude<span class="o">=</span><span class="s1">&#39;temp/&#39;</span><span class="w"> </span>--exclude<span class="o">=</span><span class="s1">&#39;.git/&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-25-13"><span class="w">    </span><span class="nv">$SOURCE_DIR</span>/<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/backup_<span class="nv">$DATE</span>/
</span><span id="__span-25-14">
</span><span id="__span-25-15"><span class="c1"># Compress backup</span>
</span><span id="__span-25-16">tar<span class="w"> </span>-czf<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/backup_<span class="nv">$DATE</span>.tar.gz<span class="w"> </span>-C<span class="w"> </span><span class="nv">$BACKUP_DIR</span><span class="w"> </span>backup_<span class="nv">$DATE</span>
</span><span id="__span-25-17">
</span><span id="__span-25-18"><span class="c1"># Upload to cloud storage</span>
</span><span id="__span-25-19">aws<span class="w"> </span>s3<span class="w"> </span>cp<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/backup_<span class="nv">$DATE</span>.tar.gz<span class="w"> </span>s3://web3audit-backups/filesystem/
</span><span id="__span-25-20">
</span><span id="__span-25-21"><span class="c1"># Clean up local backup</span>
</span><span id="__span-25-22">rm<span class="w"> </span>-rf<span class="w"> </span><span class="nv">$BACKUP_DIR</span>/backup_<span class="nv">$DATE</span>
</span><span id="__span-25-23">
</span><span id="__span-25-24"><span class="c1"># Clean old backups (keep last 30 days)</span>
</span><span id="__span-25-25">find<span class="w"> </span><span class="nv">$BACKUP_DIR</span><span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.tar.gz&quot;</span><span class="w"> </span>-mtime<span class="w"> </span>+30<span class="w"> </span>-delete
</span></code></pre></div>
<h3 id="recovery-procedures">Recovery Procedures</h3>
<h4 id="database-recovery">Database Recovery</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-26-2"><span class="c1"># Database recovery script</span>
</span><span id="__span-26-3">
</span><span id="__span-26-4"><span class="nv">BACKUP_FILE</span><span class="o">=</span><span class="nv">$1</span>
</span><span id="__span-26-5"><span class="nv">DB_NAME</span><span class="o">=</span><span class="s2">&quot;web3audit&quot;</span>
</span><span id="__span-26-6"><span class="nv">DB_USER</span><span class="o">=</span><span class="s2">&quot;web3audit&quot;</span>
</span><span id="__span-26-7">
</span><span id="__span-26-8"><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKUP_FILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-26-9"><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Usage: </span><span class="nv">$0</span><span class="s2"> &lt;backup_file&gt;&quot;</span>
</span><span id="__span-26-10"><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-26-11"><span class="k">fi</span>
</span><span id="__span-26-12">
</span><span id="__span-26-13"><span class="c1"># Stop application</span>
</span><span id="__span-26-14">sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>web3audit
</span><span id="__span-26-15">
</span><span id="__span-26-16"><span class="c1"># Drop and recreate database</span>
</span><span id="__span-26-17">sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>dropdb<span class="w"> </span><span class="nv">$DB_NAME</span>
</span><span id="__span-26-18">sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>createdb<span class="w"> </span><span class="nv">$DB_NAME</span>
</span><span id="__span-26-19">sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>psql<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;GRANT ALL PRIVILEGES ON DATABASE </span><span class="nv">$DB_NAME</span><span class="s2"> TO </span><span class="nv">$DB_USER</span><span class="s2">;&quot;</span>
</span><span id="__span-26-20">
</span><span id="__span-26-21"><span class="c1"># Restore from backup</span>
</span><span id="__span-26-22">pg_restore<span class="w"> </span>-h<span class="w"> </span>localhost<span class="w"> </span>-U<span class="w"> </span><span class="nv">$DB_USER</span><span class="w"> </span>-d<span class="w"> </span><span class="nv">$DB_NAME</span><span class="w"> </span><span class="nv">$BACKUP_FILE</span>
</span><span id="__span-26-23">
</span><span id="__span-26-24"><span class="c1"># Run migrations if needed</span>
</span><span id="__span-26-25">sudo<span class="w"> </span>-u<span class="w"> </span>web3audit<span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;cd /opt/web3audit/app &amp;&amp; source ../venv/bin/activate &amp;&amp; python manage.py migrate&quot;</span>
</span><span id="__span-26-26">
</span><span id="__span-26-27"><span class="c1"># Start application</span>
</span><span id="__span-26-28">sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>web3audit
</span><span id="__span-26-29">
</span><span id="__span-26-30"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Database recovery completed&quot;</span>
</span></code></pre></div>
<h4 id="application-recovery">Application Recovery</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-27-2"><span class="c1"># Application recovery script</span>
</span><span id="__span-27-3">
</span><span id="__span-27-4"><span class="nv">BACKUP_FILE</span><span class="o">=</span><span class="nv">$1</span>
</span><span id="__span-27-5"><span class="nv">APP_DIR</span><span class="o">=</span><span class="s2">&quot;/opt/web3audit&quot;</span>
</span><span id="__span-27-6">
</span><span id="__span-27-7"><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKUP_FILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-27-8"><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Usage: </span><span class="nv">$0</span><span class="s2"> &lt;backup_file&gt;&quot;</span>
</span><span id="__span-27-9"><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-27-10"><span class="k">fi</span>
</span><span id="__span-27-11">
</span><span id="__span-27-12"><span class="c1"># Stop application</span>
</span><span id="__span-27-13">sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>web3audit
</span><span id="__span-27-14">
</span><span id="__span-27-15"><span class="c1"># Backup current state</span>
</span><span id="__span-27-16">mv<span class="w"> </span><span class="nv">$APP_DIR</span><span class="w"> </span><span class="si">${</span><span class="nv">APP_DIR</span><span class="si">}</span>.old.<span class="k">$(</span>date<span class="w"> </span>+%s<span class="k">)</span>
</span><span id="__span-27-17">
</span><span id="__span-27-18"><span class="c1"># Extract backup</span>
</span><span id="__span-27-19">mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$APP_DIR</span>
</span><span id="__span-27-20">tar<span class="w"> </span>-xzf<span class="w"> </span><span class="nv">$BACKUP_FILE</span><span class="w"> </span>-C<span class="w"> </span><span class="nv">$APP_DIR</span>
</span><span id="__span-27-21">
</span><span id="__span-27-22"><span class="c1"># Restore configurations</span>
</span><span id="__span-27-23">cp<span class="w"> </span><span class="si">${</span><span class="nv">APP_DIR</span><span class="si">}</span>.old*/.env<span class="w"> </span><span class="nv">$APP_DIR</span>/<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">true</span>
</span><span id="__span-27-24">
</span><span id="__span-27-25"><span class="c1"># Restore virtual environment</span>
</span><span id="__span-27-26">python3.12<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span><span class="nv">$APP_DIR</span>/venv
</span><span id="__span-27-27"><span class="nb">source</span><span class="w"> </span><span class="nv">$APP_DIR</span>/venv/bin/activate
</span><span id="__span-27-28">pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span><span class="nv">$APP_DIR</span>/app/requirements.txt
</span><span id="__span-27-29">
</span><span id="__span-27-30"><span class="c1"># Start application</span>
</span><span id="__span-27-31">sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>web3audit
</span><span id="__span-27-32">
</span><span id="__span-27-33"><span class="c1"># Clean up old backup</span>
</span><span id="__span-27-34">rm<span class="w"> </span>-rf<span class="w"> </span><span class="si">${</span><span class="nv">APP_DIR</span><span class="si">}</span>.old.*
</span><span id="__span-27-35">
</span><span id="__span-27-36"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Application recovery completed&quot;</span>
</span></code></pre></div>
<h3 id="disaster-recovery-plan">Disaster Recovery Plan</h3>
<h4 id="recovery-time-objectives-rto">Recovery Time Objectives (RTO)</h4>
<ul>
<li><strong>Critical Systems</strong>: 1 hour</li>
<li><strong>Database</strong>: 4 hours</li>
<li><strong>Application</strong>: 2 hours</li>
<li><strong>Full System</strong>: 8 hours</li>
</ul>
<h4 id="recovery-point-objectives-rpo">Recovery Point Objectives (RPO)</h4>
<ul>
<li><strong>Database</strong>: 1 hour (transaction logs)</li>
<li><strong>Configurations</strong>: 1 day</li>
<li><strong>File System</strong>: 1 day</li>
</ul>
<h4 id="dr-testing-schedule">DR Testing Schedule</h4>
<ul>
<li><strong>Monthly</strong>: Component-level recovery testing</li>
<li><strong>Quarterly</strong>: Full system failover testing</li>
<li><strong>Annually</strong>: Complete disaster recovery simulation</li>
</ul>
<hr />
<h2 id="security-hardening">Security Hardening</h2>
<h3 id="system-hardening">System Hardening</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-28-2"><span class="c1"># System hardening script</span>
</span><span id="__span-28-3">
</span><span id="__span-28-4"><span class="c1"># Update system</span>
</span><span id="__span-28-5">apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
</span><span id="__span-28-6">
</span><span id="__span-28-7"><span class="c1"># Install security packages</span>
</span><span id="__span-28-8">apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>ufw<span class="w"> </span>fail2ban<span class="w"> </span>auditd<span class="w"> </span>apparmor
</span><span id="__span-28-9">
</span><span id="__span-28-10"><span class="c1"># Configure firewall</span>
</span><span id="__span-28-11">ufw<span class="w"> </span>default<span class="w"> </span>deny<span class="w"> </span>incoming
</span><span id="__span-28-12">ufw<span class="w"> </span>default<span class="w"> </span>allow<span class="w"> </span>outgoing
</span><span id="__span-28-13">ufw<span class="w"> </span>allow<span class="w"> </span>ssh
</span><span id="__span-28-14">ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">80</span>
</span><span id="__span-28-15">ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">443</span>
</span><span id="__span-28-16">ufw<span class="w"> </span>--force<span class="w"> </span><span class="nb">enable</span>
</span><span id="__span-28-17">
</span><span id="__span-28-18"><span class="c1"># Configure fail2ban</span>
</span><span id="__span-28-19">cat<span class="w"> </span>&gt;<span class="w"> </span>/etc/fail2ban/jail.local<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
</span><span id="__span-28-20"><span class="s">[sshd]</span>
</span><span id="__span-28-21"><span class="s">enabled = true</span>
</span><span id="__span-28-22"><span class="s">port = ssh</span>
</span><span id="__span-28-23"><span class="s">filter = sshd</span>
</span><span id="__span-28-24"><span class="s">logpath = /var/log/auth.log</span>
</span><span id="__span-28-25"><span class="s">maxretry = 3</span>
</span><span id="__span-28-26"><span class="s">bantime = 3600</span>
</span><span id="__span-28-27"><span class="s">EOF</span>
</span><span id="__span-28-28">
</span><span id="__span-28-29">systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>fail2ban
</span><span id="__span-28-30">systemctl<span class="w"> </span>start<span class="w"> </span>fail2ban
</span><span id="__span-28-31">
</span><span id="__span-28-32"><span class="c1"># Configure auditd</span>
</span><span id="__span-28-33">cat<span class="w"> </span>&gt;<span class="w"> </span>/etc/audit/rules.d/web3audit.rules<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
</span><span id="__span-28-34"><span class="s"># Audit file access</span>
</span><span id="__span-28-35"><span class="s">-a always,exit -F arch=b64 -S open,openat,execve -F path=/opt/web3audit</span>
</span><span id="__span-28-36"><span class="s">-a always,exit -F arch=b32 -S open,openat,execve -F path=/opt/web3audit</span>
</span><span id="__span-28-37">
</span><span id="__span-28-38"><span class="s"># Audit network activity</span>
</span><span id="__span-28-39"><span class="s">-a always,exit -F arch=b64 -S socket,bind,connect -F key=network</span>
</span><span id="__span-28-40"><span class="s">-a always,exit -F arch=b32 -S socket,bind,connect -F key=network</span>
</span><span id="__span-28-41"><span class="s">EOF</span>
</span><span id="__span-28-42">
</span><span id="__span-28-43">systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>auditd
</span><span id="__span-28-44">systemctl<span class="w"> </span>start<span class="w"> </span>auditd
</span><span id="__span-28-45">
</span><span id="__span-28-46"><span class="c1"># Secure SSH</span>
</span><span id="__span-28-47">sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/#PermitRootLogin yes/PermitRootLogin no/&#39;</span><span class="w"> </span>/etc/ssh/sshd_config
</span><span id="__span-28-48">sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/#PasswordAuthentication yes/PasswordAuthentication no/&#39;</span><span class="w"> </span>/etc/ssh/sshd_config
</span><span id="__span-28-49">systemctl<span class="w"> </span>reload<span class="w"> </span>sshd
</span><span id="__span-28-50">
</span><span id="__span-28-51"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;System hardening completed&quot;</span>
</span></code></pre></div>
<h3 id="application-security">Application Security</h3>
<p>```python
from flask import Flask, request, g
from werkzeug.security import generate_password_hash, check_password_hash
import jwt
import functools</p>
<p>app = Flask(<strong>name</strong>)</p>
<p>class SecurityManager:
    """Application security manager."""</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">secret_key</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">secret_key</span>

<span class="n">def</span><span class="w"> </span><span class="n">generate_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">user_id</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">role</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate JWT token with role-based claims.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;user_id&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;role&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">role</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;exp&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">),</span>
<span class="w">        </span><span class="s1">&#39;iat&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">(),</span>
<span class="w">        </span><span class="s1">&#39;iss&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;web3-security-audit&#39;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span><span class="p">,</span><span class="w"> </span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;HS256&#39;</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">verify_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify and decode JWT token.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">try</span><span class="p">:</span>
<span class="w">        </span><span class="n">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span><span class="p">,</span><span class="w"> </span><span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;HS256&#39;</span><span class="p">])</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">payload</span>
<span class="w">    </span><span class="n">except</span><span class="w"> </span><span class="n">jwt</span><span class="o">.</span><span class="n">ExpiredSignatureError</span><span class="p">:</span>
<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Token has expired&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">except</span><span class="w"> </span><span class="n">jwt</span><span class="o">.</span><span class="n">InvalidTokenError</span><span class="p">:</span>
<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">AuthenticationError</span><span class="p">(</span><span class="s2">&quot;Invalid token&quot;</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">require_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">required_role</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator for role-based access control.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
<span class="w">        </span><span class="err">@</span><span class="n">functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">decorated_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">            </span><span class="n">auth_header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Authorization&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">auth_header</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">auth_header</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Bearer &#39;</span><span class="p">):</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Missing or invalid authorization header&#39;</span><span class="p">},</span><span class="w"> </span><span class="mi">401</span>

<span class="w">            </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">auth_header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">            </span><span class="n">try</span><span class="p">:</span>
<span class="w">                </span><span class="n">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="w">                </span><span class="n">user_role</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">user_role</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_get_role_hierarchy</span><span class="p">(</span><span class="n">required_role</span><span class="p">):</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Insufficient permissions&#39;</span><span class="p">},</span><span class="w"> </span><span class="mi">403</span>

<span class="w">                </span><span class="n">g</span><span class="o">.</span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
<span class="w">                </span><span class="n">g</span><span class="o">.</span><span class="n">user_role</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_role</span>

<span class="w">            </span><span class="n">except</span><span class="w"> </span><span class="n">AuthenticationError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)},</span><span class="w"> </span><span class="mi">401</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">decorated_function</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">decorator</span>

<span class="n">def</span><span class="w"> </span><span class="n">_get_role_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">role</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get role hierarchy for permission checking.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">hierarchies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;admin&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;auditor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;viewer&#39;</span><span class="p">],</span>
<span class="w">        </span><span class="s1">&#39;auditor&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;auditor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;viewer&#39;</span><span class="p">],</span>
<span class="w">        </span><span class="s1">&#39;viewer&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;viewer&#39;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hierarchies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">role</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">role</span><span class="p">])</span>
</code></pre></div>

<h1 id="rate-limiting">Rate limiting</h1>
<p>from flask_limiter import Limiter
from flask_limiter.util import get_remote_address</p>
<p>limiter = Limiter(
    app=app,
    key_func=get_remote_address,
    default_limits=["200 per day", "50 per hour"]
)</p>
<h1 id="input-validation">Input validation</h1>
<p>from cerberus import Validator</p>
<p>audit_request_schema = {
    'target': {'required': True, 'type': 'string', 'maxlength': 1000},
    'target_type': {'required': True, 'allowed': ['contract', 'protocol', 'dapp']},
    'analysis_config': {
        'type': 'dict',
        'schema': {
            'depth': {'allowed': ['basic', 'standard', 'comprehensive', 'deep']},
            'tools': {'type': 'list', 'schema': {'type': 'string'}},
            'timeout': {'type': 'integer', 'min': 1, 'max': 3600}
        }
    }
}</p>
<p>def validate_audit_request(data: dict) -&gt; dict:
    """Validate audit request data."""
    validator = Validator(audit_request_schema)
    if not validator.validate(data):
        raise ValidationError(f"Invalid request data: {validator.errors}")
    return validator.document</p>
<h1 id="security-headers">Security headers</h1>
<p>@app.after_request
def add_security_headers(response):
    """Add security headers to all responses."""
    response.headers['X-Content-Type-Options'] = 'nosniff'
    response.headers['X-Frame-Options'] = 'DENY'
    response.headers['X-XSS-Protection'] = '1; mode=block'
    response.headers['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains'
    response.headers['Content-Security-Policy'] = "default-src 'self'"
    return response</p>
<h1 id="initialize-security-manager">Initialize security manager</h1>
<p>security_manager = SecurityManager(app.config['SECRET_KEY'])</p>
<p>@app.route('/api/v1/audit/submit', methods=['POST'])
@limiter.limit("10 per hour")
@security_manager.require_role('auditor')
def submit_audit():
    """Submit audit request with security controls."""</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "navigation.path", "navigation.sections", "navigation.expand", "content.code.annotate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>