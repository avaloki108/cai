
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/imago.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Code Examples and Sample Usage - CAI</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#code-examples-and-sample-usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CAI" class="md-header__button md-logo" aria-label="CAI" data-md-component="logo">
      
  <img src="../assets/imago.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CAI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Code Examples and Sample Usage
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aliasrobotics/cai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aliasrobotics/cai
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CAI" class="md-nav__button md-logo" aria-label="CAI" data-md-component="logo">
      
  <img src="../assets/imago.png" alt="logo">

    </a>
    CAI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aliasrobotics/cai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aliasrobotics/cai
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Professional Edition
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Professional Edition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ü§î Why CAI PRO?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_alias1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚≠ê Alias1 Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üî• Exclusive Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚≠ê API Server (CAI PRO)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_pricing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üí∞ Pricing & Plans
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üöÄ Get Started with PRO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_pro_contact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìû Contact Sales
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Interfaces
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Mobile UI (iOS)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Mobile UI (iOS)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/mui_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/user_interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/gestures_shortcuts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gestures & Shortcuts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mui/chat_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chat Features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Terminal UI (TUI)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Terminal UI (TUI)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/tui_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/user_interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/terminals_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terminals Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/teams_and_parallel_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Teams & Parallel Execution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/sidebar_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sidebar Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/keyboard_shortcuts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Keyboard Shortcuts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/commands_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/advanced_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tui/troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Command Line Interface (CLI)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Command Line Interface (CLI)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/cli_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/commands_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commands Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/advanced_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Core Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Core Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoffs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Agent Systems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../judge_gate_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Judge Gate Pipeline (Hunter ‚Üí Judge ‚Üí PoC)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Models & Providers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Models & Providers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_list_of_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Available Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Providers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Model Providers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/openrouter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenRouter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/ollama/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ollama
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure OpenAI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running_agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../continue_mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continue Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../session_resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Session Resume
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../results/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Streaming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tracing & Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guardrails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrails & Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../council/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLM Council
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grit (Audit Persistence)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment_variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Variables
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Benchmarking
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Benchmarking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/running_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/attack_defense/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attack & Defense CTFs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/jeopardy_ctfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jeopardy CTFs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/cyber_ranges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cyber Ranges
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/knowledge_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/privacy_benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Privacy Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../research/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../research_docs_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research Docs Index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            Agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/result/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Result
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/stream_events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stream Events
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/handoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoffs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lifecycle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/items/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Items
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/run_context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Run Context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/guardrail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrail
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/model_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/agent_output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Output
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/function_schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Function Schema
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_2" >
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/openai_chatcompletions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI Chat Completions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/models/openai_responses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI Responses
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_3" >
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Extensions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Extensions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/extensions/handoff_filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoff Filters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ref/extensions/handoff_prompt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handoff Prompt
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_find_us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Find Us
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cai_citation_and_acknowledgments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Citation & Acknowledgments
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1-simple-smart-contract-audit" class="md-nav__link">
    <span class="md-ellipsis">
      Example 1: Simple Smart Contract Audit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-command-line-audit" class="md-nav__link">
    <span class="md-ellipsis">
      Example 2: Command Line Audit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-3-defi-protocol-audit" class="md-nav__link">
    <span class="md-ellipsis">
      Example 3: DeFi Protocol Audit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-agent-development" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Agent Development
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Agent Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-4-custom-security-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Example 4: Custom Security Agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-5-plugin-development" class="md-nav__link">
    <span class="md-ellipsis">
      Example 5: Plugin Development
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-tool-integration" class="md-nav__link">
    <span class="md-ellipsis">
      External Tool Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External Tool Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-6-integrating-third-party-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Example 6: Integrating Third-Party Tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-7-advanced-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Example 7: Advanced Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-8-cicd-integration-config" class="md-nav__link">
    <span class="md-ellipsis">
      Example 8: CI/CD Integration Config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Usage Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Usage Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-9-parallel-multi-protocol-audit" class="md-nav__link">
    <span class="md-ellipsis">
      Example 9: Parallel Multi-Protocol Audit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-10-custom-reporting-and-analytics" class="md-nav__link">
    <span class="md-ellipsis">
      Example 10: Custom Reporting and Analytics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="code-examples-and-sample-usage">Code Examples and Sample Usage</h1>
<p>This document provides comprehensive code examples for using the Web3 Security Auditing AI System, from basic usage to advanced custom agent development.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#basic-usage-examples">Basic Usage Examples</a></li>
<li><a href="#custom-agent-development">Custom Agent Development</a></li>
<li><a href="#external-tool-integration">External Tool Integration</a></li>
<li><a href="#configuration-examples">Configuration Examples</a></li>
<li><a href="#advanced-usage-patterns">Advanced Usage Patterns</a></li>
<li><a href="#integration-examples">Integration Examples</a></li>
</ul>
<hr />
<h2 id="basic-usage-examples">Basic Usage Examples</h2>
<h3 id="example-1-simple-smart-contract-audit">Example 1: Simple Smart Contract Audit</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-0-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-3"><span class="sd">Basic smart contract auditing example.</span>
</span><span id="__span-0-4"><span class="sd">This example demonstrates how to perform a basic security audit on a smart contract.</span>
</span><span id="__span-0-5"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai</span><span class="w"> </span><span class="kn">import</span> <span class="n">Web3SecurityAuditor</span>
</span><span id="__span-0-8">
</span><span id="__span-0-9"><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-0-10">    <span class="c1"># Initialize the auditor</span>
</span><span id="__span-0-11">    <span class="n">auditor</span> <span class="o">=</span> <span class="n">Web3SecurityAuditor</span><span class="p">()</span>
</span><span id="__span-0-12">
</span><span id="__span-0-13">    <span class="c1"># Sample vulnerable contract</span>
</span><span id="__span-0-14">    <span class="n">contract_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-15"><span class="s1">pragma solidity ^0.8.0;</span>
</span><span id="__span-0-16">
</span><span id="__span-0-17"><span class="s1">contract VulnerableToken {</span>
</span><span id="__span-0-18"><span class="s1">    mapping(address =&gt; uint256) public balances;</span>
</span><span id="__span-0-19">
</span><span id="__span-0-20"><span class="s1">    function deposit() public payable {</span>
</span><span id="__span-0-21"><span class="s1">        balances[msg.sender] += msg.value;</span>
</span><span id="__span-0-22"><span class="s1">    }</span>
</span><span id="__span-0-23">
</span><span id="__span-0-24"><span class="s1">    function withdraw(uint256 amount) public {</span>
</span><span id="__span-0-25"><span class="s1">        require(balances[msg.sender] &gt;= amount, &quot;Insufficient balance&quot;);</span>
</span><span id="__span-0-26"><span class="s1">        (bool success,) = msg.sender.call{value: amount}(&quot;&quot;);</span>
</span><span id="__span-0-27"><span class="s1">        require(success, &quot;Transfer failed&quot;);</span>
</span><span id="__span-0-28"><span class="s1">        balances[msg.sender] -= amount; // BUG: State change after external call</span>
</span><span id="__span-0-29"><span class="s1">    }</span>
</span><span id="__span-0-30">
</span><span id="__span-0-31"><span class="s1">    function transfer(address to, uint256 amount) public {</span>
</span><span id="__span-0-32"><span class="s1">        require(balances[msg.sender] &gt;= amount, &quot;Insufficient balance&quot;);</span>
</span><span id="__span-0-33"><span class="s1">        balances[to] += amount; // BUG: No overflow check in older Solidity</span>
</span><span id="__span-0-34"><span class="s1">        balances[msg.sender] -= amount;</span>
</span><span id="__span-0-35"><span class="s1">    }</span>
</span><span id="__span-0-36"><span class="s1">}</span>
</span><span id="__span-0-37"><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-38">
</span><span id="__span-0-39">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üîç Starting smart contract audit...&quot;</span><span class="p">)</span>
</span><span id="__span-0-40">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</span><span id="__span-0-41">
</span><span id="__span-0-42">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-43">        <span class="c1"># Run the audit</span>
</span><span id="__span-0-44">        <span class="n">results</span> <span class="o">=</span> <span class="n">auditor</span><span class="o">.</span><span class="n">audit_contract</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span>
</span><span id="__span-0-45">
</span><span id="__span-0-46">        <span class="c1"># Display results</span>
</span><span id="__span-0-47">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìä Audit Summary:&quot;</span><span class="p">)</span>
</span><span id="__span-0-48">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Total Findings: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vulnerabilities&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[]))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-49">        <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-0-50">
</span><span id="__span-0-51">        <span class="c1"># Display each finding</span>
</span><span id="__span-0-52">        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">finding</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vulnerabilities&#39;</span><span class="p">,</span> <span class="p">[]),</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-53">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üö® Finding </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-54">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Severity: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;severity&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-55">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Type: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-56">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Description: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;No description&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-57">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Impact: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;impact&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-58">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Recommendation: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recommendation&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;No recommendation&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-59">            <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-0-60">
</span><span id="__span-0-61">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-62">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Audit failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-0-63">        <span class="k">return</span> <span class="mi">1</span>
</span><span id="__span-0-64">
</span><span id="__span-0-65">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Audit completed successfully!&quot;</span><span class="p">)</span>
</span><span id="__span-0-66">    <span class="k">return</span> <span class="mi">0</span>
</span><span id="__span-0-67">
</span><span id="__span-0-68"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-0-69">    <span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></code></pre></div>
<h3 id="example-2-command-line-audit">Example 2: Command Line Audit</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><span class="ch">#!/bin/bash</span>
</span><span id="__span-1-2"><span class="c1"># Command line audit examples</span>
</span><span id="__span-1-3">
</span><span id="__span-1-4"><span class="c1"># Basic contract audit</span>
</span><span id="__span-1-5">web3-audit<span class="w"> </span>audit<span class="w"> </span>contracts/Token.sol<span class="w"> </span>--output<span class="w"> </span>audit_results.json
</span><span id="__span-1-6">
</span><span id="__span-1-7"><span class="c1"># Comprehensive audit with multiple tools</span>
</span><span id="__span-1-8">web3-audit<span class="w"> </span>audit<span class="w"> </span>contracts/<span class="w"> </span>--comprehensive<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-9"><span class="w">    </span>--tools<span class="w"> </span>slither,mythril<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-10"><span class="w">    </span>--format<span class="w"> </span>pdf<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-11"><span class="w">    </span>--output<span class="w"> </span>comprehensive_audit.pdf
</span><span id="__span-1-12">
</span><span id="__span-1-13"><span class="c1"># Audit with custom configuration</span>
</span><span id="__span-1-14">web3-audit<span class="w"> </span>audit<span class="w"> </span>contracts/DeFiProtocol.sol<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-15"><span class="w">    </span>--config<span class="w"> </span>audit_config.yaml<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-16"><span class="w">    </span>--parallel<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-17"><span class="w">    </span>--timeout<span class="w"> </span><span class="m">600</span>
</span><span id="__span-1-18">
</span><span id="__span-1-19"><span class="c1"># Batch audit multiple contracts</span>
</span><span id="__span-1-20">web3-audit<span class="w"> </span>audit<span class="w"> </span>contracts/*.sol<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-21"><span class="w">    </span>--batch<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-22"><span class="w">    </span>--output-dir<span class="w"> </span>audit_results/
</span><span id="__span-1-23">
</span><span id="__span-1-24"><span class="c1"># Check audit status</span>
</span><span id="__span-1-25">web3-audit<span class="w"> </span>status<span class="w"> </span>audit_12345
</span><span id="__span-1-26">
</span><span id="__span-1-27"><span class="c1"># Generate report from existing results</span>
</span><span id="__span-1-28">web3-audit<span class="w"> </span>report<span class="w"> </span>audit_12345<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-29"><span class="w">    </span>--format<span class="w"> </span>json,pdf,html<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-30"><span class="w">    </span>--include-source
</span></code></pre></div>
<h3 id="example-3-defi-protocol-audit">Example 3: DeFi Protocol Audit</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-2-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-3"><span class="sd">DeFi Protocol auditing example.</span>
</span><span id="__span-2-4"><span class="sd">This example shows how to audit a complete DeFi protocol with multiple contracts.</span>
</span><span id="__span-2-5"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-6">
</span><span id="__span-2-7"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.orchestrator</span><span class="w"> </span><span class="kn">import</span> <span class="n">AuditOrchestrator</span>
</span><span id="__span-2-8"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.agents</span><span class="w"> </span><span class="kn">import</span> <span class="n">DeFiAuditAgent</span><span class="p">,</span> <span class="n">LiquidityAnalysisAgent</span>
</span><span id="__span-2-9"><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-2-10"><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-2-11">
</span><span id="__span-2-12"><span class="k">def</span><span class="w"> </span><span class="nf">audit_defi_protocol</span><span class="p">(</span><span class="n">protocol_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-2-13"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-14"><span class="sd">    Perform comprehensive audit of a DeFi protocol.</span>
</span><span id="__span-2-15">
</span><span id="__span-2-16"><span class="sd">    Args:</span>
</span><span id="__span-2-17"><span class="sd">        protocol_path: Path to the protocol directory</span>
</span><span id="__span-2-18">
</span><span id="__span-2-19"><span class="sd">    Returns:</span>
</span><span id="__span-2-20"><span class="sd">        Audit results dictionary</span>
</span><span id="__span-2-21"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-2-22">
</span><span id="__span-2-23">    <span class="c1"># Initialize specialized agents</span>
</span><span id="__span-2-24">    <span class="n">agents</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-2-25">        <span class="n">DeFiAuditAgent</span><span class="p">(),</span>
</span><span id="__span-2-26">        <span class="n">LiquidityAnalysisAgent</span><span class="p">()</span>
</span><span id="__span-2-27">    <span class="p">]</span>
</span><span id="__span-2-28">
</span><span id="__span-2-29">    <span class="c1"># Create orchestrator</span>
</span><span id="__span-2-30">    <span class="n">orchestrator</span> <span class="o">=</span> <span class="n">AuditOrchestrator</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span>
</span><span id="__span-2-31">
</span><span id="__span-2-32">    <span class="c1"># Define protocol configuration</span>
</span><span id="__span-2-33">    <span class="n">protocol_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-34">        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sample DeFi Protocol&quot;</span><span class="p">,</span>
</span><span id="__span-2-35">        <span class="s2">&quot;contracts&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-2-36">            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">protocol_path</span><span class="si">}</span><span class="s2">/contracts/core/*.sol&quot;</span><span class="p">,</span>
</span><span id="__span-2-37">            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">protocol_path</span><span class="si">}</span><span class="s2">/contracts/periphery/*.sol&quot;</span>
</span><span id="__span-2-38">        <span class="p">],</span>
</span><span id="__span-2-39">        <span class="s2">&quot;networks&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ethereum&quot;</span><span class="p">,</span> <span class="s2">&quot;polygon&quot;</span><span class="p">],</span>
</span><span id="__span-2-40">        <span class="s2">&quot;analysis_depth&quot;</span><span class="p">:</span> <span class="s2">&quot;comprehensive&quot;</span><span class="p">,</span>
</span><span id="__span-2-41">        <span class="s2">&quot;check_flash_loans&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-2-42">        <span class="s2">&quot;verify_oracle_security&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-2-43">        <span class="s2">&quot;analyze_impermanent_loss&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-2-44">    <span class="p">}</span>
</span><span id="__span-2-45">
</span><span id="__span-2-46">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üîç Auditing DeFi protocol: </span><span class="si">{</span><span class="n">protocol_config</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-47">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="__span-2-48">
</span><span id="__span-2-49">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-2-50">        <span class="c1"># Run comprehensive audit</span>
</span><span id="__span-2-51">        <span class="n">report</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">run_full_audit</span><span class="p">(</span><span class="n">protocol_config</span><span class="p">)</span>
</span><span id="__span-2-52">
</span><span id="__span-2-53">        <span class="c1"># Display summary</span>
</span><span id="__span-2-54">        <span class="n">summary</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">summary</span>
</span><span id="__span-2-55">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üìä Audit Summary:&quot;</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Total Contracts: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">protocol_config</span><span class="p">[</span><span class="s1">&#39;contracts&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-56">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Total Findings: </span><span class="si">{</span><span class="n">summary</span><span class="o">.</span><span class="n">total_findings</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-57">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Critical: </span><span class="si">{</span><span class="n">summary</span><span class="o">.</span><span class="n">critical</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-58">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   High: </span><span class="si">{</span><span class="n">summary</span><span class="o">.</span><span class="n">high</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-59">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Medium: </span><span class="si">{</span><span class="n">summary</span><span class="o">.</span><span class="n">medium</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-60">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Low: </span><span class="si">{</span><span class="n">summary</span><span class="o">.</span><span class="n">low</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-61">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Risk Score: </span><span class="si">{</span><span class="n">summary</span><span class="o">.</span><span class="n">risk_score</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">/10&quot;</span><span class="p">)</span>
</span><span id="__span-2-62">        <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-2-63">
</span><span id="__span-2-64">        <span class="c1"># Display top findings</span>
</span><span id="__span-2-65">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üö® Top Security Findings:&quot;</span><span class="p">)</span>
</span><span id="__span-2-66">        <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">report</span><span class="o">.</span><span class="n">findings</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Show top 5</span>
</span><span id="__span-2-67">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-68">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;     </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">description</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="__span-2-69">
</span><span id="__span-2-70">        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-2-71">            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-2-72">            <span class="s2">&quot;report&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">,</span>
</span><span id="__span-2-73">            <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="n">summary</span>
</span><span id="__span-2-74">        <span class="p">}</span>
</span><span id="__span-2-75">
</span><span id="__span-2-76">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-2-77">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Audit failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-78">        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-2-79">            <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-2-80">            <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-2-81">        <span class="p">}</span>
</span><span id="__span-2-82">
</span><span id="__span-2-83"><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-2-84">    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-2-85">
</span><span id="__span-2-86">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="__span-2-87">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage: python defi_audit.py &lt;protocol_path&gt;&quot;</span><span class="p">)</span>
</span><span id="__span-2-88">        <span class="k">return</span> <span class="mi">1</span>
</span><span id="__span-2-89">
</span><span id="__span-2-90">    <span class="n">protocol_path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-2-91">
</span><span id="__span-2-92">    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">protocol_path</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-2-93">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Protocol path does not exist: </span><span class="si">{</span><span class="n">protocol_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-94">        <span class="k">return</span> <span class="mi">1</span>
</span><span id="__span-2-95">
</span><span id="__span-2-96">    <span class="n">results</span> <span class="o">=</span> <span class="n">audit_defi_protocol</span><span class="p">(</span><span class="n">protocol_path</span><span class="p">)</span>
</span><span id="__span-2-97">
</span><span id="__span-2-98">    <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]:</span>
</span><span id="__span-2-99">        <span class="c1"># Save detailed report</span>
</span><span id="__span-2-100">        <span class="n">output_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">protocol_path</span><span class="si">}</span><span class="s2">/audit_report.json&quot;</span>
</span><span id="__span-2-101">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-2-102">            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
</span><span id="__span-2-103">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìÑ Detailed report saved to: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-104">
</span><span id="__span-2-105">    <span class="k">return</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="__span-2-106">
</span><span id="__span-2-107"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-2-108">    <span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></code></pre></div>
<hr />
<h2 id="custom-agent-development">Custom Agent Development</h2>
<h3 id="example-4-custom-security-agent">Example 4: Custom Security Agent</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-3-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-3"><span class="sd">Custom security agent development example.</span>
</span><span id="__span-3-4"><span class="sd">This example shows how to create a specialized security agent.</span>
</span><span id="__span-3-5"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-6">
</span><span id="__span-3-7"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.sdk</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseAuditAgent</span><span class="p">,</span> <span class="n">AgentConfig</span>
</span><span id="__span-3-8"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">CodeAnalyzer</span><span class="p">,</span> <span class="n">PatternMatcher</span>
</span><span id="__span-3-9"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Finding</span><span class="p">,</span> <span class="n">Severity</span>
</span><span id="__span-3-10"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
</span><span id="__span-3-11"><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="__span-3-12">
</span><span id="__span-3-13"><span class="k">class</span><span class="w"> </span><span class="nc">CustomSecurityAgent</span><span class="p">(</span><span class="n">BaseAuditAgent</span><span class="p">):</span>
</span><span id="__span-3-14"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-15"><span class="sd">    Custom security agent for specialized vulnerability detection.</span>
</span><span id="__span-3-16"><span class="sd">    This agent focuses on domain-specific security patterns.</span>
</span><span id="__span-3-17"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-3-18">
</span><span id="__span-3-19">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">AgentConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-3-20">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-3-21">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Custom Security Agent&quot;</span><span class="p">,</span>
</span><span id="__span-3-22">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Specialized agent for custom security checks&quot;</span><span class="p">,</span>
</span><span id="__span-3-23">            <span class="n">config</span><span class="o">=</span><span class="n">config</span> <span class="ow">or</span> <span class="n">AgentConfig</span><span class="p">()</span>
</span><span id="__span-3-24">        <span class="p">)</span>
</span><span id="__span-3-25">
</span><span id="__span-3-26">        <span class="c1"># Initialize tools</span>
</span><span id="__span-3-27">        <span class="bp">self</span><span class="o">.</span><span class="n">code_analyzer</span> <span class="o">=</span> <span class="n">CodeAnalyzer</span><span class="p">()</span>
</span><span id="__span-3-28">        <span class="bp">self</span><span class="o">.</span><span class="n">pattern_matcher</span> <span class="o">=</span> <span class="n">PatternMatcher</span><span class="p">()</span>
</span><span id="__span-3-29">
</span><span id="__span-3-30">        <span class="c1"># Define custom vulnerability patterns</span>
</span><span id="__span-3-31">        <span class="bp">self</span><span class="o">.</span><span class="n">vulnerability_patterns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-3-32">            <span class="s2">&quot;unchecked_send&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-33">                <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\.send\s*\(\s*\w+\s*\)&quot;</span><span class="p">,</span>
</span><span id="__span-3-34">                <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
</span><span id="__span-3-35">                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Use of .send() without return value check&quot;</span><span class="p">,</span>
</span><span id="__span-3-36">                <span class="s2">&quot;recommendation&quot;</span><span class="p">:</span> <span class="s2">&quot;Use .call() with proper error handling or require success check&quot;</span>
</span><span id="__span-3-37">            <span class="p">},</span>
</span><span id="__span-3-38">            <span class="s2">&quot;tx_origin&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-39">                <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;tx\.origin&quot;</span><span class="p">,</span>
</span><span id="__span-3-40">                <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
</span><span id="__span-3-41">                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Use of tx.origin for authorization&quot;</span><span class="p">,</span>
</span><span id="__span-3-42">                <span class="s2">&quot;recommendation&quot;</span><span class="p">:</span> <span class="s2">&quot;Use msg.sender for authorization checks&quot;</span>
</span><span id="__span-3-43">            <span class="p">},</span>
</span><span id="__span-3-44">            <span class="s2">&quot;magic_numbers&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-3-45">                <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;=\s*\d{4,}&quot;</span><span class="p">,</span>  <span class="c1"># Numbers with 4+ digits</span>
</span><span id="__span-3-46">                <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">LOW</span><span class="p">,</span>
</span><span id="__span-3-47">                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Magic numbers in code&quot;</span><span class="p">,</span>
</span><span id="__span-3-48">                <span class="s2">&quot;recommendation&quot;</span><span class="p">:</span> <span class="s2">&quot;Use named constants instead of magic numbers&quot;</span>
</span><span id="__span-3-49">            <span class="p">}</span>
</span><span id="__span-3-50">        <span class="p">}</span>
</span><span id="__span-3-51">
</span><span id="__span-3-52">    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_contract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">]:</span>
</span><span id="__span-3-53"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-54"><span class="sd">        Analyze contract code for custom vulnerabilities.</span>
</span><span id="__span-3-55">
</span><span id="__span-3-56"><span class="sd">        Args:</span>
</span><span id="__span-3-57"><span class="sd">            contract_code: The contract source code</span>
</span><span id="__span-3-58"><span class="sd">            context: Additional analysis context</span>
</span><span id="__span-3-59">
</span><span id="__span-3-60"><span class="sd">        Returns:</span>
</span><span id="__span-3-61"><span class="sd">            List of security findings</span>
</span><span id="__span-3-62"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-3-63">        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-3-64">
</span><span id="__span-3-65">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-3-66">            <span class="c1"># Run custom pattern analysis</span>
</span><span id="__span-3-67">            <span class="n">pattern_findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_patterns</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span>
</span><span id="__span-3-68">            <span class="n">findings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pattern_findings</span><span class="p">)</span>
</span><span id="__span-3-69">
</span><span id="__span-3-70">            <span class="c1"># Run code structure analysis</span>
</span><span id="__span-3-71">            <span class="n">structure_findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_code_structure</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span>
</span><span id="__span-3-72">            <span class="n">findings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">structure_findings</span><span class="p">)</span>
</span><span id="__span-3-73">
</span><span id="__span-3-74">            <span class="c1"># Run business logic analysis</span>
</span><span id="__span-3-75">            <span class="n">logic_findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_business_logic</span><span class="p">(</span><span class="n">contract_code</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</span><span id="__span-3-76">            <span class="n">findings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">logic_findings</span><span class="p">)</span>
</span><span id="__span-3-77">
</span><span id="__span-3-78">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-3-79">            <span class="c1"># Create error finding</span>
</span><span id="__span-3-80">            <span class="n">error_finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="__span-3-81">                <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;analysis_error_</span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10000</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-3-82">                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;analysis_error&quot;</span><span class="p">,</span>
</span><span id="__span-3-83">                <span class="n">severity</span><span class="o">=</span><span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
</span><span id="__span-3-84">                <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
</span><span id="__span-3-85">                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Analysis Error&quot;</span><span class="p">,</span>
</span><span id="__span-3-86">                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Failed to complete analysis: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-3-87">                <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="__span-3-88">                <span class="n">code_snippet</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-3-89">                <span class="n">impact</span><span class="o">=</span><span class="s2">&quot;Analysis may be incomplete&quot;</span><span class="p">,</span>
</span><span id="__span-3-90">                <span class="n">recommendation</span><span class="o">=</span><span class="s2">&quot;Review analysis logs and retry&quot;</span><span class="p">,</span>
</span><span id="__span-3-91">                <span class="n">cvss_score</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
</span><span id="__span-3-92">                <span class="n">references</span><span class="o">=</span><span class="p">[],</span>
</span><span id="__span-3-93">                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span id="__span-3-94">            <span class="p">)</span>
</span><span id="__span-3-95">            <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_finding</span><span class="p">)</span>
</span><span id="__span-3-96">
</span><span id="__span-3-97">        <span class="k">return</span> <span class="n">findings</span>
</span><span id="__span-3-98">
</span><span id="__span-3-99">    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">]:</span>
</span><span id="__span-3-100"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze code for pattern-based vulnerabilities.&quot;&quot;&quot;</span>
</span><span id="__span-3-101">        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-3-102">
</span><span id="__span-3-103">        <span class="k">for</span> <span class="n">vuln_name</span><span class="p">,</span> <span class="n">vuln_config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vulnerability_patterns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-3-104">            <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">vuln_config</span><span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">],</span> <span class="n">contract_code</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
</span><span id="__span-3-105">
</span><span id="__span-3-106">            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
</span><span id="__span-3-107">                <span class="c1"># Get line number</span>
</span><span id="__span-3-108">                <span class="n">line_num</span> <span class="o">=</span> <span class="n">contract_code</span><span class="p">[:</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-3-109">
</span><span id="__span-3-110">                <span class="c1"># Extract code snippet</span>
</span><span id="__span-3-111">                <span class="n">lines</span> <span class="o">=</span> <span class="n">contract_code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="__span-3-112">                <span class="n">start_line</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">line_num</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-3-113">                <span class="n">end_line</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">),</span> <span class="n">line_num</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-3-114">                <span class="n">snippet</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">start_line</span><span class="p">:</span><span class="n">end_line</span><span class="p">])</span>
</span><span id="__span-3-115">
</span><span id="__span-3-116">                <span class="n">finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="__span-3-117">                    <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vuln_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">line_num</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">())</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10000</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-3-118">                    <span class="nb">type</span><span class="o">=</span><span class="n">vuln_name</span><span class="p">,</span>
</span><span id="__span-3-119">                    <span class="n">severity</span><span class="o">=</span><span class="n">vuln_config</span><span class="p">[</span><span class="s2">&quot;severity&quot;</span><span class="p">],</span>
</span><span id="__span-3-120">                    <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>
</span><span id="__span-3-121">                    <span class="n">title</span><span class="o">=</span><span class="n">vuln_config</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">],</span>
</span><span id="__span-3-122">                    <span class="n">description</span><span class="o">=</span><span class="n">vuln_config</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">],</span>
</span><span id="__span-3-123">                    <span class="n">location</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-3-124">                        <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;contract.sol&quot;</span><span class="p">,</span>
</span><span id="__span-3-125">                        <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="n">line_num</span><span class="p">,</span>
</span><span id="__span-3-126">                        <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="o">-</span> <span class="n">contract_code</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">())</span>
</span><span id="__span-3-127">                    <span class="p">},</span>
</span><span id="__span-3-128">                    <span class="n">code_snippet</span><span class="o">=</span><span class="n">snippet</span><span class="p">,</span>
</span><span id="__span-3-129">                    <span class="n">impact</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_determine_impact</span><span class="p">(</span><span class="n">vuln_name</span><span class="p">),</span>
</span><span id="__span-3-130">                    <span class="n">recommendation</span><span class="o">=</span><span class="n">vuln_config</span><span class="p">[</span><span class="s2">&quot;recommendation&quot;</span><span class="p">],</span>
</span><span id="__span-3-131">                    <span class="n">cvss_score</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculate_cvss</span><span class="p">(</span><span class="n">vuln_config</span><span class="p">[</span><span class="s2">&quot;severity&quot;</span><span class="p">]),</span>
</span><span id="__span-3-132">                    <span class="n">references</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_references</span><span class="p">(</span><span class="n">vuln_name</span><span class="p">),</span>
</span><span id="__span-3-133">                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">vuln_config</span><span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">]}</span>
</span><span id="__span-3-134">                <span class="p">)</span>
</span><span id="__span-3-135">                <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-3-136">
</span><span id="__span-3-137">        <span class="k">return</span> <span class="n">findings</span>
</span><span id="__span-3-138">
</span><span id="__span-3-139">    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_code_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">]:</span>
</span><span id="__span-3-140"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze code structure for potential issues.&quot;&quot;&quot;</span>
</span><span id="__span-3-141">        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-3-142">
</span><span id="__span-3-143">        <span class="c1"># Check for missing access controls</span>
</span><span id="__span-3-144">        <span class="k">if</span> <span class="s2">&quot;function&quot;</span> <span class="ow">in</span> <span class="n">contract_code</span> <span class="ow">and</span> <span class="s2">&quot;onlyOwner&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">contract_code</span><span class="p">:</span>
</span><span id="__span-3-145">            <span class="n">finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="__span-3-146">                <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;missing_access_control_</span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10000</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-3-147">                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;access_control&quot;</span><span class="p">,</span>
</span><span id="__span-3-148">                <span class="n">severity</span><span class="o">=</span><span class="n">Severity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
</span><span id="__span-3-149">                <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
</span><span id="__span-3-150">                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Potential Missing Access Control&quot;</span><span class="p">,</span>
</span><span id="__span-3-151">                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Contract contains functions that may lack proper access control&quot;</span><span class="p">,</span>
</span><span id="__span-3-152">                <span class="n">location</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;contract.sol&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
</span><span id="__span-3-153">                <span class="n">code_snippet</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-3-154">                <span class="n">impact</span><span class="o">=</span><span class="s2">&quot;Unauthorized access to sensitive functions&quot;</span><span class="p">,</span>
</span><span id="__span-3-155">                <span class="n">recommendation</span><span class="o">=</span><span class="s2">&quot;Implement proper access control modifiers&quot;</span><span class="p">,</span>
</span><span id="__span-3-156">                <span class="n">cvss_score</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
</span><span id="__span-3-157">                <span class="n">references</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;https://swcregistry.io/docs/SWC-105&quot;</span><span class="p">],</span>
</span><span id="__span-3-158">                <span class="n">metadata</span><span class="o">=</span><span class="p">{}</span>
</span><span id="__span-3-159">            <span class="p">)</span>
</span><span id="__span-3-160">            <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-3-161">
</span><span id="__span-3-162">        <span class="k">return</span> <span class="n">findings</span>
</span><span id="__span-3-163">
</span><span id="__span-3-164">    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_business_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">]:</span>
</span><span id="__span-3-165"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze business logic for domain-specific issues.&quot;&quot;&quot;</span>
</span><span id="__span-3-166">        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-3-167">
</span><span id="__span-3-168">        <span class="c1"># Context-aware analysis</span>
</span><span id="__span-3-169">        <span class="k">if</span> <span class="n">context</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;contract_type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;token&quot;</span><span class="p">:</span>
</span><span id="__span-3-170">            <span class="c1"># Token-specific checks</span>
</span><span id="__span-3-171">            <span class="k">if</span> <span class="s2">&quot;transfer&quot;</span> <span class="ow">in</span> <span class="n">contract_code</span> <span class="ow">and</span> <span class="s2">&quot;balances&quot;</span> <span class="ow">in</span> <span class="n">contract_code</span><span class="p">:</span>
</span><span id="__span-3-172">                <span class="c1"># Check for overflow protection</span>
</span><span id="__span-3-173">                <span class="k">if</span> <span class="s2">&quot;_safe&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">contract_code</span> <span class="ow">and</span> <span class="s2">&quot;SafeMath&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">contract_code</span><span class="p">:</span>
</span><span id="__span-3-174">                    <span class="n">finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="__span-3-175">                        <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;overflow_risk_</span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10000</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-3-176">                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;overflow&quot;</span><span class="p">,</span>
</span><span id="__span-3-177">                        <span class="n">severity</span><span class="o">=</span><span class="n">Severity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
</span><span id="__span-3-178">                        <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
</span><span id="__span-3-179">                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Potential Arithmetic Overflow&quot;</span><span class="p">,</span>
</span><span id="__span-3-180">                        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Token contract may be vulnerable to arithmetic overflow&quot;</span><span class="p">,</span>
</span><span id="__span-3-181">                        <span class="n">location</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;contract.sol&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
</span><span id="__span-3-182">                        <span class="n">code_snippet</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-3-183">                        <span class="n">impact</span><span class="o">=</span><span class="s2">&quot;Loss of token accounting integrity&quot;</span><span class="p">,</span>
</span><span id="__span-3-184">                        <span class="n">recommendation</span><span class="o">=</span><span class="s2">&quot;Use SafeMath library or Solidity 0.8+ built-in checks&quot;</span><span class="p">,</span>
</span><span id="__span-3-185">                        <span class="n">cvss_score</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span>
</span><span id="__span-3-186">                        <span class="n">references</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;https://swcregistry.io/docs/SWC-101&quot;</span><span class="p">],</span>
</span><span id="__span-3-187">                        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;contract_type&quot;</span><span class="p">:</span> <span class="s2">&quot;token&quot;</span><span class="p">}</span>
</span><span id="__span-3-188">                    <span class="p">)</span>
</span><span id="__span-3-189">                    <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-3-190">
</span><span id="__span-3-191">        <span class="k">return</span> <span class="n">findings</span>
</span><span id="__span-3-192">
</span><span id="__span-3-193">    <span class="k">def</span><span class="w"> </span><span class="nf">_determine_impact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vuln_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-3-194"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine the impact of a vulnerability.&quot;&quot;&quot;</span>
</span><span id="__span-3-195">        <span class="n">impacts</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-3-196">            <span class="s2">&quot;unchecked_send&quot;</span><span class="p">:</span> <span class="s2">&quot;Potential loss of ether due to failed transfers&quot;</span><span class="p">,</span>
</span><span id="__span-3-197">            <span class="s2">&quot;tx_origin&quot;</span><span class="p">:</span> <span class="s2">&quot;Authorization bypass through phishing attacks&quot;</span><span class="p">,</span>
</span><span id="__span-3-198">            <span class="s2">&quot;magic_numbers&quot;</span><span class="p">:</span> <span class="s2">&quot;Code maintainability and potential logic errors&quot;</span>
</span><span id="__span-3-199">        <span class="p">}</span>
</span><span id="__span-3-200">        <span class="k">return</span> <span class="n">impacts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="s2">&quot;Unknown impact&quot;</span><span class="p">)</span>
</span><span id="__span-3-201">
</span><span id="__span-3-202">    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_cvss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">severity</span><span class="p">:</span> <span class="n">Severity</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-3-203"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate CVSS score based on severity.&quot;&quot;&quot;</span>
</span><span id="__span-3-204">        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-3-205">            <span class="n">Severity</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span> <span class="mf">9.0</span><span class="p">,</span>
</span><span id="__span-3-206">            <span class="n">Severity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
</span><span id="__span-3-207">            <span class="n">Severity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="__span-3-208">            <span class="n">Severity</span><span class="o">.</span><span class="n">LOW</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
</span><span id="__span-3-209">            <span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span><span class="p">:</span> <span class="mf">0.0</span>
</span><span id="__span-3-210">        <span class="p">}</span>
</span><span id="__span-3-211">        <span class="k">return</span> <span class="n">scores</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-3-212">
</span><span id="__span-3-213">    <span class="k">def</span><span class="w"> </span><span class="nf">_get_references</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vuln_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="__span-3-214"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get reference links for vulnerability type.&quot;&quot;&quot;</span>
</span><span id="__span-3-215">        <span class="n">references</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-3-216">            <span class="s2">&quot;unchecked_send&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;https://swcregistry.io/docs/SWC-104&quot;</span><span class="p">],</span>
</span><span id="__span-3-217">            <span class="s2">&quot;tx_origin&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;https://swcregistry.io/docs/SWC-115&quot;</span><span class="p">],</span>
</span><span id="__span-3-218">            <span class="s2">&quot;magic_numbers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;https://wiki.sei.cmu.edu/confluence/display/java/DCL00-J.+Prevent+class+initialization+cycles&quot;</span><span class="p">]</span>
</span><span id="__span-3-219">        <span class="p">}</span>
</span><span id="__span-3-220">        <span class="k">return</span> <span class="n">references</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vuln_type</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-3-221">
</span><span id="__span-3-222"><span class="c1"># Usage example</span>
</span><span id="__span-3-223"><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-3-224">    <span class="c1"># Create custom agent</span>
</span><span id="__span-3-225">    <span class="n">agent</span> <span class="o">=</span> <span class="n">CustomSecurityAgent</span><span class="p">()</span>
</span><span id="__span-3-226">
</span><span id="__span-3-227">    <span class="c1"># Sample contract with vulnerabilities</span>
</span><span id="__span-3-228">    <span class="n">contract</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-3-229"><span class="s1">pragma solidity ^0.7.0; // Old version, potential overflow</span>
</span><span id="__span-3-230">
</span><span id="__span-3-231"><span class="s1">contract MyToken {</span>
</span><span id="__span-3-232"><span class="s1">    mapping(address =&gt; uint256) balances;</span>
</span><span id="__span-3-233">
</span><span id="__span-3-234"><span class="s1">    function transfer(address to, uint256 amount) public {</span>
</span><span id="__span-3-235"><span class="s1">        require(balances[msg.sender] &gt;= amount);</span>
</span><span id="__span-3-236"><span class="s1">        balances[to] += amount; // Potential overflow</span>
</span><span id="__span-3-237"><span class="s1">        balances[msg.sender] -= amount;</span>
</span><span id="__span-3-238"><span class="s1">    }</span>
</span><span id="__span-3-239">
</span><span id="__span-3-240"><span class="s1">    function sendEther(address payable recipient, uint256 amount) public {</span>
</span><span id="__span-3-241"><span class="s1">        recipient.send(amount); // Unchecked send</span>
</span><span id="__span-3-242"><span class="s1">    }</span>
</span><span id="__span-3-243">
</span><span id="__span-3-244"><span class="s1">    function checkOwner() public view returns (bool) {</span>
</span><span id="__span-3-245"><span class="s1">        return tx.origin == owner; // Wrong authorization</span>
</span><span id="__span-3-246"><span class="s1">    }</span>
</span><span id="__span-3-247"><span class="s1">}</span>
</span><span id="__span-3-248"><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-3-249">
</span><span id="__span-3-250">    <span class="c1"># Run analysis</span>
</span><span id="__span-3-251">    <span class="n">findings</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">analyze_contract</span><span class="p">(</span><span class="n">contract</span><span class="p">)</span>
</span><span id="__span-3-252">
</span><span id="__span-3-253">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üîç Custom Agent Analysis Results:&quot;</span><span class="p">)</span>
</span><span id="__span-3-254">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Findings: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-3-255">    <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-3-256">
</span><span id="__span-3-257">    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
</span><span id="__span-3-258">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üö® </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-3-259">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-3-260">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üí° </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">recommendation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-3-261">        <span class="nb">print</span><span class="p">()</span>
</span><span id="__span-3-262">
</span><span id="__span-3-263"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-3-264">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="example-5-plugin-development">Example 5: Plugin Development</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-4-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-4-3"><span class="sd">Plugin development example.</span>
</span><span id="__span-4-4"><span class="sd">This example shows how to create a plugin that extends the auditing system.</span>
</span><span id="__span-4-5"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-4-6">
</span><span id="__span-4-7"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.plugins</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasePlugin</span><span class="p">,</span> <span class="n">PluginManager</span>
</span><span id="__span-4-8"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseTool</span>
</span><span id="__span-4-9"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.agents</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseAuditAgent</span>
</span><span id="__span-4-10"><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="__span-4-11">
</span><span id="__span-4-12"><span class="k">class</span><span class="w"> </span><span class="nc">APISecurityTool</span><span class="p">(</span><span class="n">BaseTool</span><span class="p">):</span>
</span><span id="__span-4-13"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tool for API security testing.&quot;&quot;&quot;</span>
</span><span id="__span-4-14">
</span><span id="__span-4-15">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-4-16">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-4-17">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;API Security Scanner&quot;</span><span class="p">,</span>
</span><span id="__span-4-18">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Scans APIs for common security vulnerabilities&quot;</span>
</span><span id="__span-4-19">        <span class="p">)</span>
</span><span id="__span-4-20">
</span><span id="__span-4-21">    <span class="k">def</span><span class="w"> </span><span class="nf">run_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-4-22"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run API security analysis.&quot;&quot;&quot;</span>
</span><span id="__span-4-23">        <span class="c1"># Implementation for API security scanning</span>
</span><span id="__span-4-24">        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-4-25">            <span class="s2">&quot;vulnerabilities&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="__span-4-26">            <span class="s2">&quot;endpoints_tested&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-4-27">            <span class="s2">&quot;scan_duration&quot;</span><span class="p">:</span> <span class="mi">0</span>
</span><span id="__span-4-28">        <span class="p">}</span>
</span><span id="__span-4-29">
</span><span id="__span-4-30"><span class="k">class</span><span class="w"> </span><span class="nc">APISecurityAgent</span><span class="p">(</span><span class="n">BaseAuditAgent</span><span class="p">):</span>
</span><span id="__span-4-31"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Agent specialized in API security.&quot;&quot;&quot;</span>
</span><span id="__span-4-32">
</span><span id="__span-4-33">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-4-34">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-4-35">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;API Security Agent&quot;</span><span class="p">,</span>
</span><span id="__span-4-36">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Specialized agent for API security analysis&quot;</span>
</span><span id="__span-4-37">        <span class="p">)</span>
</span><span id="__span-4-38">        <span class="bp">self</span><span class="o">.</span><span class="n">api_tool</span> <span class="o">=</span> <span class="n">APISecurityTool</span><span class="p">()</span>
</span><span id="__span-4-39">
</span><span id="__span-4-40">    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="__span-4-41"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze target for API security issues.&quot;&quot;&quot;</span>
</span><span id="__span-4-42">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_tool</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-4-43">
</span><span id="__span-4-44"><span class="k">class</span><span class="w"> </span><span class="nc">CustomAuditPlugin</span><span class="p">(</span><span class="n">BasePlugin</span><span class="p">):</span>
</span><span id="__span-4-45"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-4-46"><span class="sd">    Custom audit plugin that adds API security capabilities.</span>
</span><span id="__span-4-47"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-4-48">
</span><span id="__span-4-49">    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;api_security_plugin&quot;</span>
</span><span id="__span-4-50">    <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1.0.0&quot;</span>
</span><span id="__span-4-51">    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Extends auditing system with API security capabilities&quot;</span>
</span><span id="__span-4-52">
</span><span id="__span-4-53">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">):</span>
</span><span id="__span-4-54">        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_manager</span> <span class="o">=</span> <span class="n">plugin_manager</span>
</span><span id="__span-4-55">        <span class="bp">self</span><span class="o">.</span><span class="n">api_agent</span> <span class="o">=</span> <span class="n">APISecurityAgent</span><span class="p">()</span>
</span><span id="__span-4-56">        <span class="bp">self</span><span class="o">.</span><span class="n">api_tool</span> <span class="o">=</span> <span class="n">APISecurityTool</span><span class="p">()</span>
</span><span id="__span-4-57">
</span><span id="__span-4-58">    <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-4-59"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the plugin.&quot;&quot;&quot;</span>
</span><span id="__span-4-60">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üîå Initializing </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> v</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-61">
</span><span id="__span-4-62">        <span class="c1"># Register new tool</span>
</span><span id="__span-4-63">        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_manager</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_tool</span><span class="p">)</span>
</span><span id="__span-4-64">
</span><span id="__span-4-65">        <span class="c1"># Register new agent</span>
</span><span id="__span-4-66">        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_manager</span><span class="o">.</span><span class="n">register_agent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_agent</span><span class="p">)</span>
</span><span id="__span-4-67">
</span><span id="__span-4-68">        <span class="c1"># Register event handlers</span>
</span><span id="__span-4-69">        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_manager</span><span class="o">.</span><span class="n">register_hook</span><span class="p">(</span>
</span><span id="__span-4-70">            <span class="s1">&#39;audit_started&#39;</span><span class="p">,</span>
</span><span id="__span-4-71">            <span class="bp">self</span><span class="o">.</span><span class="n">on_audit_started</span>
</span><span id="__span-4-72">        <span class="p">)</span>
</span><span id="__span-4-73">
</span><span id="__span-4-74">        <span class="bp">self</span><span class="o">.</span><span class="n">plugin_manager</span><span class="o">.</span><span class="n">register_hook</span><span class="p">(</span>
</span><span id="__span-4-75">            <span class="s1">&#39;audit_completed&#39;</span><span class="p">,</span>
</span><span id="__span-4-76">            <span class="bp">self</span><span class="o">.</span><span class="n">on_audit_completed</span>
</span><span id="__span-4-77">        <span class="p">)</span>
</span><span id="__span-4-78">
</span><span id="__span-4-79">    <span class="k">def</span><span class="w"> </span><span class="nf">on_audit_started</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-4-80"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle audit started event.&quot;&quot;&quot;</span>
</span><span id="__span-4-81">        <span class="n">target</span> <span class="o">=</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
</span><span id="__span-4-82">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üîç API Security Plugin: Starting audit for </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-83">
</span><span id="__span-4-84">        <span class="c1"># Check if target is an API</span>
</span><span id="__span-4-85">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_api_target</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
</span><span id="__span-4-86">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   üì° Detected API target, enabling API security checks&quot;</span><span class="p">)</span>
</span><span id="__span-4-87">
</span><span id="__span-4-88">    <span class="k">def</span><span class="w"> </span><span class="nf">on_audit_completed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="__span-4-89"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle audit completed event.&quot;&quot;&quot;</span>
</span><span id="__span-4-90">        <span class="n">audit_id</span> <span class="o">=</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;audit_id&#39;</span><span class="p">)</span>
</span><span id="__span-4-91">        <span class="n">findings</span> <span class="o">=</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;findings&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-4-92">
</span><span id="__span-4-93">        <span class="n">api_findings</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">findings</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;api_&#39;</span><span class="p">)]</span>
</span><span id="__span-4-94">
</span><span id="__span-4-95">        <span class="k">if</span> <span class="n">api_findings</span><span class="p">:</span>
</span><span id="__span-4-96">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üîç API Security Plugin: Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">api_findings</span><span class="p">)</span><span class="si">}</span><span class="s2"> API-related findings&quot;</span><span class="p">)</span>
</span><span id="__span-4-97">            <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">api_findings</span><span class="p">:</span>
</span><span id="__span-4-98">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üö® </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;severity&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-99">
</span><span id="__span-4-100">    <span class="k">def</span><span class="w"> </span><span class="nf">_is_api_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-4-101"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if target appears to be an API.&quot;&quot;&quot;</span>
</span><span id="__span-4-102">        <span class="n">api_indicators</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-4-103">            <span class="s1">&#39;api.&#39;</span><span class="p">,</span> <span class="s1">&#39;.api&#39;</span><span class="p">,</span> <span class="s1">&#39;/api/&#39;</span><span class="p">,</span> <span class="s1">&#39;/v1/&#39;</span><span class="p">,</span> <span class="s1">&#39;/v2/&#39;</span><span class="p">,</span>
</span><span id="__span-4-104">            <span class="s1">&#39;swagger&#39;</span><span class="p">,</span> <span class="s1">&#39;openapi&#39;</span><span class="p">,</span> <span class="s1">&#39;graphql&#39;</span>
</span><span id="__span-4-105">        <span class="p">]</span>
</span><span id="__span-4-106">        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">indicator</span> <span class="ow">in</span> <span class="n">target</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">api_indicators</span><span class="p">)</span>
</span><span id="__span-4-107">
</span><span id="__span-4-108">    <span class="k">def</span><span class="w"> </span><span class="nf">get_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__span-4-109"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return plugin capabilities.&quot;&quot;&quot;</span>
</span><span id="__span-4-110">        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-4-111">            <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">api_tool</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-4-112">            <span class="s2">&quot;agents&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">api_agent</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-4-113">            <span class="s2">&quot;supported_targets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;web_service&quot;</span><span class="p">,</span> <span class="s2">&quot;microservice&quot;</span><span class="p">],</span>
</span><span id="__span-4-114">            <span class="s2">&quot;vulnerability_types&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span id="__span-4-115">                <span class="s2">&quot;api_injection&quot;</span><span class="p">,</span>
</span><span id="__span-4-116">                <span class="s2">&quot;broken_authentication&quot;</span><span class="p">,</span>
</span><span id="__span-4-117">                <span class="s2">&quot;excessive_data_exposure&quot;</span><span class="p">,</span>
</span><span id="__span-4-118">                <span class="s2">&quot;rate_limiting_bypass&quot;</span><span class="p">,</span>
</span><span id="__span-4-119">                <span class="s2">&quot;cors_misconfiguration&quot;</span>
</span><span id="__span-4-120">            <span class="p">]</span>
</span><span id="__span-4-121">        <span class="p">}</span>
</span><span id="__span-4-122">
</span><span id="__span-4-123"><span class="c1"># Plugin registration function</span>
</span><span id="__span-4-124"><span class="k">def</span><span class="w"> </span><span class="nf">register_plugin</span><span class="p">(</span><span class="n">plugin_manager</span><span class="p">:</span> <span class="n">PluginManager</span><span class="p">):</span>
</span><span id="__span-4-125"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Register the custom plugin.&quot;&quot;&quot;</span>
</span><span id="__span-4-126">    <span class="n">plugin</span> <span class="o">=</span> <span class="n">CustomAuditPlugin</span><span class="p">(</span><span class="n">plugin_manager</span><span class="p">)</span>
</span><span id="__span-4-127">    <span class="n">plugin_manager</span><span class="o">.</span><span class="n">register_plugin</span><span class="p">(</span><span class="n">plugin</span><span class="p">)</span>
</span><span id="__span-4-128">    <span class="k">return</span> <span class="n">plugin</span>
</span><span id="__span-4-129">
</span><span id="__span-4-130"><span class="c1"># Usage example</span>
</span><span id="__span-4-131"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-4-132">    <span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.plugins</span><span class="w"> </span><span class="kn">import</span> <span class="n">PluginManager</span>
</span><span id="__span-4-133">
</span><span id="__span-4-134">    <span class="c1"># Create plugin manager</span>
</span><span id="__span-4-135">    <span class="n">plugin_manager</span> <span class="o">=</span> <span class="n">PluginManager</span><span class="p">()</span>
</span><span id="__span-4-136">
</span><span id="__span-4-137">    <span class="c1"># Register custom plugin</span>
</span><span id="__span-4-138">    <span class="n">plugin</span> <span class="o">=</span> <span class="n">register_plugin</span><span class="p">(</span><span class="n">plugin_manager</span><span class="p">)</span>
</span><span id="__span-4-139">
</span><span id="__span-4-140">    <span class="c1"># Display plugin information</span>
</span><span id="__span-4-141">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üì¶ Registered Plugin: </span><span class="si">{</span><span class="n">plugin</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-142">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Version: </span><span class="si">{</span><span class="n">plugin</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-143">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Description: </span><span class="si">{</span><span class="n">plugin</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-144">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Capabilities: </span><span class="si">{</span><span class="n">plugin</span><span class="o">.</span><span class="n">get_capabilities</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h2 id="external-tool-integration">External Tool Integration</h2>
<h3 id="example-6-integrating-third-party-tools">Example 6: Integrating Third-Party Tools</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-5-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-5-3"><span class="sd">External tool integration example.</span>
</span><span id="__span-5-4"><span class="sd">This example shows how to integrate third-party security tools.</span>
</span><span id="__span-5-5"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-5-6">
</span><span id="__span-5-7"><span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
</span><span id="__span-5-8"><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-5-9"><span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
</span><span id="__span-5-10"><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-5-11"><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-5-12"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="__span-5-13"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseTool</span>
</span><span id="__span-5-14"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Finding</span><span class="p">,</span> <span class="n">Severity</span>
</span><span id="__span-5-15">
</span><span id="__span-5-16"><span class="k">class</span><span class="w"> </span><span class="nc">SlitherTool</span><span class="p">(</span><span class="n">BaseTool</span><span class="p">):</span>
</span><span id="__span-5-17"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Integration with Slither static analysis tool.&quot;&quot;&quot;</span>
</span><span id="__span-5-18">
</span><span id="__span-5-19">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slither_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;slither&quot;</span><span class="p">):</span>
</span><span id="__span-5-20">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-5-21">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Slither&quot;</span><span class="p">,</span>
</span><span id="__span-5-22">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Static analysis tool for Solidity smart contracts&quot;</span>
</span><span id="__span-5-23">        <span class="p">)</span>
</span><span id="__span-5-24">        <span class="bp">self</span><span class="o">.</span><span class="n">slither_path</span> <span class="o">=</span> <span class="n">slither_path</span>
</span><span id="__span-5-25">
</span><span id="__span-5-26">    <span class="k">def</span><span class="w"> </span><span class="nf">run_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="__span-5-27"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-5-28"><span class="sd">        Run Slither analysis on target contract.</span>
</span><span id="__span-5-29">
</span><span id="__span-5-30"><span class="sd">        Args:</span>
</span><span id="__span-5-31"><span class="sd">            target: Path to contract file or directory</span>
</span><span id="__span-5-32"><span class="sd">            config: Analysis configuration</span>
</span><span id="__span-5-33">
</span><span id="__span-5-34"><span class="sd">        Returns:</span>
</span><span id="__span-5-35"><span class="sd">            Analysis results</span>
</span><span id="__span-5-36"><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-5-37">        <span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="__span-5-38">
</span><span id="__span-5-39">        <span class="c1"># Prepare command</span>
</span><span id="__span-5-40">        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">slither_path</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="s2">&quot;--json&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">]</span>
</span><span id="__span-5-41">
</span><span id="__span-5-42">        <span class="c1"># Add configuration options</span>
</span><span id="__span-5-43">        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exclude_dependencies&quot;</span><span class="p">):</span>
</span><span id="__span-5-44">            <span class="n">cmd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;--exclude-dependencies&quot;</span><span class="p">)</span>
</span><span id="__span-5-45">
</span><span id="__span-5-46">        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;foundry_ignore_compile&quot;</span><span class="p">):</span>
</span><span id="__span-5-47">            <span class="n">cmd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;--foundry-ignore-compile&quot;</span><span class="p">)</span>
</span><span id="__span-5-48">
</span><span id="__span-5-49">        <span class="n">detectors</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;detectors&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-5-50">        <span class="k">if</span> <span class="n">detectors</span><span class="p">:</span>
</span><span id="__span-5-51">            <span class="k">for</span> <span class="n">detector</span> <span class="ow">in</span> <span class="n">detectors</span><span class="p">:</span>
</span><span id="__span-5-52">                <span class="n">cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--detect&quot;</span><span class="p">,</span> <span class="n">detector</span><span class="p">])</span>
</span><span id="__span-5-53">
</span><span id="__span-5-54">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-5-55">            <span class="c1"># Run Slither</span>
</span><span id="__span-5-56">            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="__span-5-57">                <span class="n">cmd</span><span class="p">,</span>
</span><span id="__span-5-58">                <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-5-59">                <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-5-60">                <span class="n">timeout</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</span><span id="__span-5-61">            <span class="p">)</span>
</span><span id="__span-5-62">
</span><span id="__span-5-63">            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-5-64">                <span class="c1"># Parse JSON output</span>
</span><span id="__span-5-65">                <span class="n">findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_slither_output</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
</span><span id="__span-5-66">                <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-67">                    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-5-68">                    <span class="s2">&quot;findings&quot;</span><span class="p">:</span> <span class="n">findings</span><span class="p">,</span>
</span><span id="__span-5-69">                    <span class="s2">&quot;raw_output&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
</span><span id="__span-5-70">                <span class="p">}</span>
</span><span id="__span-5-71">            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-5-72">                <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-73">                    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-5-74">                    <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
</span><span id="__span-5-75">                    <span class="s2">&quot;raw_output&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
</span><span id="__span-5-76">                <span class="p">}</span>
</span><span id="__span-5-77">
</span><span id="__span-5-78">        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
</span><span id="__span-5-79">            <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-80">                <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-5-81">                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Analysis timed out&quot;</span>
</span><span id="__span-5-82">            <span class="p">}</span>
</span><span id="__span-5-83">        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="__span-5-84">            <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-85">                <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-5-86">                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Slither not found at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">slither_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-5-87">            <span class="p">}</span>
</span><span id="__span-5-88">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-5-89">            <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-90">                <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-5-91">                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Analysis failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-5-92">            <span class="p">}</span>
</span><span id="__span-5-93">
</span><span id="__span-5-94">    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_slither_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">]:</span>
</span><span id="__span-5-95"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse Slither JSON output into standardized findings.&quot;&quot;&quot;</span>
</span><span id="__span-5-96">        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-5-97">
</span><span id="__span-5-98">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-5-99">            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="__span-5-100">
</span><span id="__span-5-101">            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;detectors&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-5-102">                <span class="c1"># Convert Slither finding to standardized format</span>
</span><span id="__span-5-103">                <span class="n">finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="__span-5-104">                    <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;slither_</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;check&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">))</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10000</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-5-105">                    <span class="nb">type</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;check&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
</span><span id="__span-5-106">                    <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_map_severity</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;impact&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)),</span>
</span><span id="__span-5-107">                    <span class="n">confidence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_map_confidence</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)),</span>
</span><span id="__span-5-108">                    <span class="n">title</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown finding&quot;</span><span class="p">),</span>
</span><span id="__span-5-109">                    <span class="n">description</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="__span-5-110">                    <span class="n">location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_parse_location</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;elements&quot;</span><span class="p">,</span> <span class="p">[])),</span>
</span><span id="__span-5-111">                    <span class="n">code_snippet</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># Would need to extract from source</span>
</span><span id="__span-5-112">                    <span class="n">impact</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;impact&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
</span><span id="__span-5-113">                    <span class="n">recommendation</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># Slither doesn&#39;t provide recommendations</span>
</span><span id="__span-5-114">                    <span class="n">cvss_score</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculate_cvss_score</span><span class="p">(</span><span class="n">result</span><span class="p">),</span>
</span><span id="__span-5-115">                    <span class="n">references</span><span class="o">=</span><span class="p">[],</span>
</span><span id="__span-5-116">                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-117">                        <span class="s2">&quot;tool&quot;</span><span class="p">:</span> <span class="s2">&quot;slither&quot;</span><span class="p">,</span>
</span><span id="__span-5-118">                        <span class="s2">&quot;check&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;check&quot;</span><span class="p">),</span>
</span><span id="__span-5-119">                        <span class="s2">&quot;raw_result&quot;</span><span class="p">:</span> <span class="n">result</span>
</span><span id="__span-5-120">                    <span class="p">}</span>
</span><span id="__span-5-121">                <span class="p">)</span>
</span><span id="__span-5-122">                <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-5-123">
</span><span id="__span-5-124">        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
</span><span id="__span-5-125">            <span class="c1"># Handle non-JSON output</span>
</span><span id="__span-5-126">            <span class="k">pass</span>
</span><span id="__span-5-127">
</span><span id="__span-5-128">        <span class="k">return</span> <span class="n">findings</span>
</span><span id="__span-5-129">
</span><span id="__span-5-130">    <span class="k">def</span><span class="w"> </span><span class="nf">_map_severity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slither_impact</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Severity</span><span class="p">:</span>
</span><span id="__span-5-131"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Map Slither impact to standardized severity.&quot;&quot;&quot;</span>
</span><span id="__span-5-132">        <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-5-133">            <span class="s2">&quot;High&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
</span><span id="__span-5-134">            <span class="s2">&quot;Medium&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
</span><span id="__span-5-135">            <span class="s2">&quot;Low&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">LOW</span><span class="p">,</span>
</span><span id="__span-5-136">            <span class="s2">&quot;Informational&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span>
</span><span id="__span-5-137">        <span class="p">}</span>
</span><span id="__span-5-138">        <span class="k">return</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">slither_impact</span><span class="p">,</span> <span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</span><span id="__span-5-139">
</span><span id="__span-5-140">    <span class="k">def</span><span class="w"> </span><span class="nf">_map_confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slither_confidence</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-5-141"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Map Slither confidence to standardized confidence.&quot;&quot;&quot;</span>
</span><span id="__span-5-142">        <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-5-143">            <span class="s2">&quot;High&quot;</span><span class="p">:</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
</span><span id="__span-5-144">            <span class="s2">&quot;Medium&quot;</span><span class="p">:</span> <span class="s2">&quot;medium&quot;</span><span class="p">,</span>
</span><span id="__span-5-145">            <span class="s2">&quot;Low&quot;</span><span class="p">:</span> <span class="s2">&quot;low&quot;</span>
</span><span id="__span-5-146">        <span class="p">}</span>
</span><span id="__span-5-147">        <span class="k">return</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">slither_confidence</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">)</span>
</span><span id="__span-5-148">
</span><span id="__span-5-149">    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="__span-5-150"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse Slither location information.&quot;&quot;&quot;</span>
</span><span id="__span-5-151">        <span class="k">if</span> <span class="ow">not</span> <span class="n">elements</span><span class="p">:</span>
</span><span id="__span-5-152">            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-5-153">
</span><span id="__span-5-154">        <span class="c1"># Extract first element&#39;s location</span>
</span><span id="__span-5-155">        <span class="n">element</span> <span class="o">=</span> <span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-5-156">        <span class="n">source_mapping</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source_mapping&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-5-157">
</span><span id="__span-5-158">        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-159">            <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">source_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filename_relative&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
</span><span id="__span-5-160">            <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="n">source_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">source_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;lines&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-5-161">            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="mi">0</span>
</span><span id="__span-5-162">        <span class="p">}</span>
</span><span id="__span-5-163">
</span><span id="__span-5-164">    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_cvss_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-5-165"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate CVSS score from Slither result.&quot;&quot;&quot;</span>
</span><span id="__span-5-166">        <span class="n">impact</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;impact&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">)</span>
</span><span id="__span-5-167">        <span class="n">confidence</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">)</span>
</span><span id="__span-5-168">
</span><span id="__span-5-169">        <span class="c1"># Simple scoring based on impact and confidence</span>
</span><span id="__span-5-170">        <span class="n">base_scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-5-171">            <span class="s2">&quot;High&quot;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
</span><span id="__span-5-172">            <span class="s2">&quot;Medium&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="__span-5-173">            <span class="s2">&quot;Low&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
</span><span id="__span-5-174">            <span class="s2">&quot;Informational&quot;</span><span class="p">:</span> <span class="mf">0.0</span>
</span><span id="__span-5-175">        <span class="p">}</span>
</span><span id="__span-5-176">
</span><span id="__span-5-177">        <span class="n">confidence_multipliers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-5-178">            <span class="s2">&quot;High&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span id="__span-5-179">            <span class="s2">&quot;Medium&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
</span><span id="__span-5-180">            <span class="s2">&quot;Low&quot;</span><span class="p">:</span> <span class="mf">0.6</span>
</span><span id="__span-5-181">        <span class="p">}</span>
</span><span id="__span-5-182">
</span><span id="__span-5-183">        <span class="n">base_score</span> <span class="o">=</span> <span class="n">base_scores</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">impact</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-5-184">        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">confidence_multipliers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">confidence</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
</span><span id="__span-5-185">
</span><span id="__span-5-186">        <span class="k">return</span> <span class="n">base_score</span> <span class="o">*</span> <span class="n">multiplier</span>
</span><span id="__span-5-187">
</span><span id="__span-5-188"><span class="k">class</span><span class="w"> </span><span class="nc">MythrilTool</span><span class="p">(</span><span class="n">BaseTool</span><span class="p">):</span>
</span><span id="__span-5-189"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Integration with Mythril symbolic execution tool.&quot;&quot;&quot;</span>
</span><span id="__span-5-190">
</span><span id="__span-5-191">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mythril_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mythril&quot;</span><span class="p">):</span>
</span><span id="__span-5-192">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-5-193">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mythril&quot;</span><span class="p">,</span>
</span><span id="__span-5-194">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Symbolic execution tool for Ethereum smart contracts&quot;</span>
</span><span id="__span-5-195">        <span class="p">)</span>
</span><span id="__span-5-196">        <span class="bp">self</span><span class="o">.</span><span class="n">mythril_path</span> <span class="o">=</span> <span class="n">mythril_path</span>
</span><span id="__span-5-197">
</span><span id="__span-5-198">    <span class="k">def</span><span class="w"> </span><span class="nf">run_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="__span-5-199"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run Mythril analysis on target contract.&quot;&quot;&quot;</span>
</span><span id="__span-5-200">        <span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="__span-5-201">
</span><span id="__span-5-202">        <span class="c1"># Create temporary file for analysis</span>
</span><span id="__span-5-203">        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.sol&#39;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-5-204">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">target</span> <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.sol&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_temp_contract</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
</span><span id="__span-5-205">            <span class="n">temp_file</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-5-206">
</span><span id="__span-5-207">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-5-208">            <span class="c1"># Prepare command</span>
</span><span id="__span-5-209">            <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-5-210">                <span class="bp">self</span><span class="o">.</span><span class="n">mythril_path</span><span class="p">,</span>
</span><span id="__span-5-211">                <span class="s2">&quot;analyze&quot;</span><span class="p">,</span>
</span><span id="__span-5-212">                <span class="n">temp_file</span><span class="p">,</span>
</span><span id="__span-5-213">                <span class="s2">&quot;--json&quot;</span><span class="p">,</span>
</span><span id="__span-5-214">                <span class="s2">&quot;--max-depth&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_depth&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>
</span><span id="__span-5-215">                <span class="s2">&quot;--loop-bound&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;loop_bound&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="__span-5-216">            <span class="p">]</span>
</span><span id="__span-5-217">
</span><span id="__span-5-218">            <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;enable_iprof&quot;</span><span class="p">):</span>
</span><span id="__span-5-219">                <span class="n">cmd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;--enable-iprof&quot;</span><span class="p">)</span>
</span><span id="__span-5-220">
</span><span id="__span-5-221">            <span class="c1"># Run Mythril</span>
</span><span id="__span-5-222">            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="__span-5-223">                <span class="n">cmd</span><span class="p">,</span>
</span><span id="__span-5-224">                <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-5-225">                <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-5-226">                <span class="n">timeout</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
</span><span id="__span-5-227">            <span class="p">)</span>
</span><span id="__span-5-228">
</span><span id="__span-5-229">            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-5-230">                <span class="n">findings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_mythril_output</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
</span><span id="__span-5-231">                <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-232">                    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-5-233">                    <span class="s2">&quot;findings&quot;</span><span class="p">:</span> <span class="n">findings</span><span class="p">,</span>
</span><span id="__span-5-234">                    <span class="s2">&quot;raw_output&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
</span><span id="__span-5-235">                <span class="p">}</span>
</span><span id="__span-5-236">            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-5-237">                <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-238">                    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-5-239">                    <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
</span><span id="__span-5-240">                    <span class="s2">&quot;raw_output&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
</span><span id="__span-5-241">                <span class="p">}</span>
</span><span id="__span-5-242">
</span><span id="__span-5-243">        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
</span><span id="__span-5-244">            <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-5-245">                <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-5-246">                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Analysis timed out&quot;</span>
</span><span id="__span-5-247">            <span class="p">}</span>
</span><span id="__span-5-248">        <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-5-249">            <span class="c1"># Clean up temporary file</span>
</span><span id="__span-5-250">            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">temp_file</span><span class="p">)</span>
</span><span id="__span-5-251">
</span><span id="__span-5-252">    <span class="k">def</span><span class="w"> </span><span class="nf">_create_temp_contract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contract_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__span-5-253"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create temporary contract file from code string.&quot;&quot;&quot;</span>
</span><span id="__span-5-254">        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-5-255"><span class="s1">pragma solidity ^0.8.0;</span>
</span><span id="__span-5-256">
</span><span id="__span-5-257"><span class="s1">contract TempContract </span><span class="se">{{</span>
</span><span id="__span-5-258"><span class="s1">    </span><span class="si">{</span><span class="n">contract_code</span><span class="si">}</span>
</span><span id="__span-5-259"><span class="se">}}</span>
</span><span id="__span-5-260"><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-5-261">
</span><span id="__span-5-262">    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_mythril_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Finding</span><span class="p">]:</span>
</span><span id="__span-5-263"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse Mythril JSON output.&quot;&quot;&quot;</span>
</span><span id="__span-5-264">        <span class="n">findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-5-265">
</span><span id="__span-5-266">        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-5-267">            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="__span-5-268">
</span><span id="__span-5-269">            <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;issues&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="__span-5-270">                <span class="n">finding</span> <span class="o">=</span> <span class="n">Finding</span><span class="p">(</span>
</span><span id="__span-5-271">                    <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;mythril_</span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">issue</span><span class="p">))</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">10000</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-5-272">                    <span class="nb">type</span><span class="o">=</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
</span><span id="__span-5-273">                    <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_map_mythril_severity</span><span class="p">(</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)),</span>
</span><span id="__span-5-274">                    <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span>  <span class="c1"># Mythril typically has high confidence</span>
</span><span id="__span-5-275">                    <span class="n">title</span><span class="o">=</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown issue&quot;</span><span class="p">),</span>
</span><span id="__span-5-276">                    <span class="n">description</span><span class="o">=</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="__span-5-277">                    <span class="n">location</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-278">                        <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;contract.sol&quot;</span><span class="p">,</span>
</span><span id="__span-5-279">                        <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;lineno&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="__span-5-280">                        <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="mi">0</span>
</span><span id="__span-5-281">                    <span class="p">},</span>
</span><span id="__span-5-282">                    <span class="n">code_snippet</span><span class="o">=</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
</span><span id="__span-5-283">                    <span class="n">impact</span><span class="o">=</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
</span><span id="__span-5-284">                    <span class="n">recommendation</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># Mythril doesn&#39;t provide recommendations</span>
</span><span id="__span-5-285">                    <span class="n">cvss_score</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_calculate_mythril_cvss</span><span class="p">(</span><span class="n">issue</span><span class="p">),</span>
</span><span id="__span-5-286">                    <span class="n">references</span><span class="o">=</span><span class="p">[],</span>
</span><span id="__span-5-287">                    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-5-288">                        <span class="s2">&quot;tool&quot;</span><span class="p">:</span> <span class="s2">&quot;mythril&quot;</span><span class="p">,</span>
</span><span id="__span-5-289">                        <span class="s2">&quot;raw_issue&quot;</span><span class="p">:</span> <span class="n">issue</span>
</span><span id="__span-5-290">                    <span class="p">}</span>
</span><span id="__span-5-291">                <span class="p">)</span>
</span><span id="__span-5-292">                <span class="n">findings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finding</span><span class="p">)</span>
</span><span id="__span-5-293">
</span><span id="__span-5-294">        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
</span><span id="__span-5-295">            <span class="k">pass</span>
</span><span id="__span-5-296">
</span><span id="__span-5-297">        <span class="k">return</span> <span class="n">findings</span>
</span><span id="__span-5-298">
</span><span id="__span-5-299">    <span class="k">def</span><span class="w"> </span><span class="nf">_map_mythril_severity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Severity</span><span class="p">:</span>
</span><span id="__span-5-300"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Map Mythril severity.&quot;&quot;&quot;</span>
</span><span id="__span-5-301">        <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-5-302">            <span class="s2">&quot;High&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
</span><span id="__span-5-303">            <span class="s2">&quot;Medium&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
</span><span id="__span-5-304">            <span class="s2">&quot;Low&quot;</span><span class="p">:</span> <span class="n">Severity</span><span class="o">.</span><span class="n">LOW</span>
</span><span id="__span-5-305">        <span class="p">}</span>
</span><span id="__span-5-306">        <span class="k">return</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</span><span id="__span-5-307">
</span><span id="__span-5-308">    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_mythril_cvss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issue</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-5-309"><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate CVSS score for Mythril issue.&quot;&quot;&quot;</span>
</span><span id="__span-5-310">        <span class="n">severity</span> <span class="o">=</span> <span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">)</span>
</span><span id="__span-5-311">        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-5-312">            <span class="s2">&quot;High&quot;</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span>
</span><span id="__span-5-313">            <span class="s2">&quot;Medium&quot;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
</span><span id="__span-5-314">            <span class="s2">&quot;Low&quot;</span><span class="p">:</span> <span class="mf">3.0</span>
</span><span id="__span-5-315">        <span class="p">}</span>
</span><span id="__span-5-316">        <span class="k">return</span> <span class="n">scores</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-5-317">
</span><span id="__span-5-318"><span class="c1"># Usage example</span>
</span><span id="__span-5-319"><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-5-320">    <span class="c1"># Initialize tools</span>
</span><span id="__span-5-321">    <span class="n">slither</span> <span class="o">=</span> <span class="n">SlitherTool</span><span class="p">()</span>
</span><span id="__span-5-322">    <span class="n">mythril</span> <span class="o">=</span> <span class="n">MythrilTool</span><span class="p">()</span>
</span><span id="__span-5-323">
</span><span id="__span-5-324">    <span class="c1"># Sample contract</span>
</span><span id="__span-5-325">    <span class="n">contract_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-5-326"><span class="s1">pragma solidity ^0.8.0;</span>
</span><span id="__span-5-327">
</span><span id="__span-5-328"><span class="s1">contract SimpleToken {</span>
</span><span id="__span-5-329"><span class="s1">    mapping(address =&gt; uint) balances;</span>
</span><span id="__span-5-330">
</span><span id="__span-5-331"><span class="s1">    function transfer(address to, uint amount) public {</span>
</span><span id="__span-5-332"><span class="s1">        require(balances[msg.sender] &gt;= amount);</span>
</span><span id="__span-5-333"><span class="s1">        balances[to] += amount;</span>
</span><span id="__span-5-334"><span class="s1">        balances[msg.sender] -= amount;</span>
</span><span id="__span-5-335"><span class="s1">    }</span>
</span><span id="__span-5-336"><span class="s1">}</span>
</span><span id="__span-5-337"><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-5-338">
</span><span id="__span-5-339">    <span class="c1"># Create temporary contract file</span>
</span><span id="__span-5-340">    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.sol&#39;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-5-341">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span>
</span><span id="__span-5-342">        <span class="n">contract_file</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
</span><span id="__span-5-343">
</span><span id="__span-5-344">    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-5-345">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üîç Running Slither analysis...&quot;</span><span class="p">)</span>
</span><span id="__span-5-346">        <span class="n">slither_results</span> <span class="o">=</span> <span class="n">slither</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">(</span><span class="n">contract_file</span><span class="p">)</span>
</span><span id="__span-5-347">
</span><span id="__span-5-348">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üîç Running Mythril analysis...&quot;</span><span class="p">)</span>
</span><span id="__span-5-349">        <span class="n">mythril_results</span> <span class="o">=</span> <span class="n">mythril</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">(</span><span class="n">contract_code</span><span class="p">)</span>
</span><span id="__span-5-350">
</span><span id="__span-5-351">        <span class="c1"># Combine results</span>
</span><span id="__span-5-352">        <span class="n">all_findings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-5-353">        <span class="n">all_findings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">slither_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;findings&quot;</span><span class="p">,</span> <span class="p">[]))</span>
</span><span id="__span-5-354">        <span class="n">all_findings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">mythril_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;findings&quot;</span><span class="p">,</span> <span class="p">[]))</span>
</span><span id="__span-5-355">
</span><span id="__span-5-356">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìä Combined Analysis Results:&quot;</span><span class="p">)</span>
</span><span id="__span-5-357">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Total Findings: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_findings</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-5-358">
</span><span id="__span-5-359">        <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">all_findings</span><span class="p">:</span>
</span><span id="__span-5-360">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üö® </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">finding</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-5-361">
</span><span id="__span-5-362">    <span class="k">finally</span><span class="p">:</span>
</span><span id="__span-5-363">        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">contract_file</span><span class="p">)</span>
</span><span id="__span-5-364">
</span><span id="__span-5-365"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-5-366">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
<hr />
<h2 id="configuration-examples">Configuration Examples</h2>
<h3 id="example-7-advanced-configuration">Example 7: Advanced Configuration</h3>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-6-1"><span class="c1"># advanced_audit_config.yaml</span>
</span><span id="__span-6-2"><span class="nt">audit</span><span class="p">:</span>
</span><span id="__span-6-3"><span class="w">  </span><span class="c1"># General settings</span>
</span><span id="__span-6-4"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Advanced</span><span class="nv"> </span><span class="s">DeFi</span><span class="nv"> </span><span class="s">Protocol</span><span class="nv"> </span><span class="s">Audit&quot;</span>
</span><span id="__span-6-5"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2.0.0&quot;</span>
</span><span id="__span-6-6"><span class="w">  </span><span class="nt">auditor</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Web3</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">AI</span><span class="nv"> </span><span class="s">v0.1.0&quot;</span>
</span><span id="__span-6-7">
</span><span id="__span-6-8"><span class="w">  </span><span class="c1"># Target specification</span>
</span><span id="__span-6-9"><span class="w">  </span><span class="nt">target</span><span class="p">:</span>
</span><span id="__span-6-10"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;protocol&quot;</span><span class="w">  </span><span class="c1"># contract, protocol, dapp</span>
</span><span id="__span-6-11"><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./contracts&quot;</span>
</span><span id="__span-6-12"><span class="w">    </span><span class="nt">include_patterns</span><span class="p">:</span>
</span><span id="__span-6-13"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/*.sol&quot;</span>
</span><span id="__span-6-14"><span class="w">    </span><span class="nt">exclude_patterns</span><span class="p">:</span>
</span><span id="__span-6-15"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/test/**&quot;</span>
</span><span id="__span-6-16"><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;**/mock/**&quot;</span>
</span><span id="__span-6-17">
</span><span id="__span-6-18"><span class="w">  </span><span class="c1"># Analysis configuration</span>
</span><span id="__span-6-19"><span class="w">  </span><span class="nt">analysis</span><span class="p">:</span>
</span><span id="__span-6-20"><span class="w">    </span><span class="nt">depth</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;comprehensive&quot;</span><span class="w">  </span><span class="c1"># basic, standard, comprehensive, deep</span>
</span><span id="__span-6-21"><span class="w">    </span><span class="nt">parallel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-22"><span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1800</span><span class="w">  </span><span class="c1"># 30 minutes</span>
</span><span id="__span-6-23"><span class="w">    </span><span class="nt">max_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</span><span id="__span-6-24">
</span><span id="__span-6-25"><span class="w">    </span><span class="c1"># Tool-specific configurations</span>
</span><span id="__span-6-26"><span class="w">    </span><span class="nt">tools</span><span class="p">:</span>
</span><span id="__span-6-27"><span class="w">      </span><span class="nt">slither</span><span class="p">:</span>
</span><span id="__span-6-28"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-29"><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-6-30"><span class="w">          </span><span class="nt">exclude_dependencies</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-31"><span class="w">          </span><span class="nt">detectors</span><span class="p">:</span>
</span><span id="__span-6-32"><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;reentrancy&quot;</span>
</span><span id="__span-6-33"><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;unchecked-lowlevel-call&quot;</span>
</span><span id="__span-6-34"><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;arbitrary-send&quot;</span>
</span><span id="__span-6-35"><span class="w">          </span><span class="nt">solc_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.8.19&quot;</span>
</span><span id="__span-6-36">
</span><span id="__span-6-37"><span class="w">      </span><span class="nt">mythril</span><span class="p">:</span>
</span><span id="__span-6-38"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-39"><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-6-40"><span class="w">          </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
</span><span id="__span-6-41"><span class="w">          </span><span class="nt">loop_bound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id="__span-6-42"><span class="w">          </span><span class="nt">enable_iprof</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-43"><span class="w">          </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">600</span>
</span><span id="__span-6-44">
</span><span id="__span-6-45"><span class="w">      </span><span class="nt">custom_ml</span><span class="p">:</span>
</span><span id="__span-6-46"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-47"><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-6-48"><span class="w">          </span><span class="nt">model_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./models/vulnerability_classifier.pkl&quot;</span>
</span><span id="__span-6-49"><span class="w">          </span><span class="nt">confidence_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.8</span>
</span><span id="__span-6-50"><span class="w">          </span><span class="nt">feature_extraction</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;advanced&quot;</span>
</span><span id="__span-6-51">
</span><span id="__span-6-52"><span class="w">    </span><span class="c1"># Agent configurations</span>
</span><span id="__span-6-53"><span class="w">    </span><span class="nt">agents</span><span class="p">:</span>
</span><span id="__span-6-54"><span class="w">      </span><span class="nt">orchestrator</span><span class="p">:</span>
</span><span id="__span-6-55"><span class="w">        </span><span class="nt">max_concurrent_audits</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id="__span-6-56"><span class="w">        </span><span class="nt">retry_failed_agents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-57"><span class="w">        </span><span class="nt">agent_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
</span><span id="__span-6-58">
</span><span id="__span-6-59"><span class="w">      </span><span class="nt">web3_audit</span><span class="p">:</span>
</span><span id="__span-6-60"><span class="w">        </span><span class="nt">deep_analysis</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-61"><span class="w">        </span><span class="nt">check_inheritance</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-62"><span class="w">        </span><span class="nt">analyze_state_changes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-63"><span class="w">        </span><span class="nt">verify_access_controls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-64">
</span><span id="__span-6-65"><span class="w">      </span><span class="nt">ml_engine</span><span class="p">:</span>
</span><span id="__span-6-66"><span class="w">        </span><span class="nt">models</span><span class="p">:</span>
</span><span id="__span-6-67"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;vulnerability_classifier&quot;</span>
</span><span id="__span-6-68"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;classification&quot;</span>
</span><span id="__span-6-69"><span class="w">            </span><span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.75</span>
</span><span id="__span-6-70"><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;risk_predictor&quot;</span>
</span><span id="__span-6-71"><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;regression&quot;</span>
</span><span id="__span-6-72"><span class="w">            </span><span class="nt">features</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;complexity&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;external_calls&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;state_changes&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-6-73">
</span><span id="__span-6-74"><span class="w">  </span><span class="c1"># Reporting configuration</span>
</span><span id="__span-6-75"><span class="w">  </span><span class="nt">reporting</span><span class="p">:</span>
</span><span id="__span-6-76"><span class="w">    </span><span class="nt">formats</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;json&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;pdf&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;html&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-6-77"><span class="w">    </span><span class="nt">include_source_code</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-78"><span class="w">    </span><span class="nt">include_recommendations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-79"><span class="w">    </span><span class="nt">risk_threshold</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;medium&quot;</span><span class="w">  </span><span class="c1"># low, medium, high, critical</span>
</span><span id="__span-6-80">
</span><span id="__span-6-81"><span class="w">    </span><span class="c1"># PDF report settings</span>
</span><span id="__span-6-82"><span class="w">    </span><span class="nt">pdf</span><span class="p">:</span>
</span><span id="__span-6-83"><span class="w">      </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;professional&quot;</span>
</span><span id="__span-6-84"><span class="w">      </span><span class="nt">include_charts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-85"><span class="w">      </span><span class="nt">include_code_snippets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-86"><span class="w">      </span><span class="nt">max_findings_per_page</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-6-87">
</span><span id="__span-6-88"><span class="w">    </span><span class="c1"># JSON report settings</span>
</span><span id="__span-6-89"><span class="w">    </span><span class="nt">json</span><span class="p">:</span>
</span><span id="__span-6-90"><span class="w">      </span><span class="nt">pretty_print</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-91"><span class="w">      </span><span class="nt">include_metadata</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-92"><span class="w">      </span><span class="nt">schema_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span>
</span><span id="__span-6-93">
</span><span id="__span-6-94"><span class="w">  </span><span class="c1"># Integration settings</span>
</span><span id="__span-6-95"><span class="w">  </span><span class="nt">integrations</span><span class="p">:</span>
</span><span id="__span-6-96"><span class="w">    </span><span class="nt">github</span><span class="p">:</span>
</span><span id="__span-6-97"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-98"><span class="w">      </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;org/protocol-repo&quot;</span>
</span><span id="__span-6-99"><span class="w">      </span><span class="nt">create_issues</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-100"><span class="w">      </span><span class="nt">labels</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;security&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;audit&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-6-101">
</span><span id="__span-6-102"><span class="w">    </span><span class="nt">slack</span><span class="p">:</span>
</span><span id="__span-6-103"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-104"><span class="w">      </span><span class="nt">webhook_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${SLACK_WEBHOOK_URL}&quot;</span>
</span><span id="__span-6-105"><span class="w">      </span><span class="nt">channels</span><span class="p">:</span>
</span><span id="__span-6-106"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;#security-audits&quot;</span>
</span><span id="__span-6-107"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;#dev-team&quot;</span>
</span><span id="__span-6-108">
</span><span id="__span-6-109"><span class="w">    </span><span class="nt">jira</span><span class="p">:</span>
</span><span id="__span-6-110"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-111"><span class="w">      </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;company.atlassian.net&quot;</span>
</span><span id="__span-6-112"><span class="w">      </span><span class="nt">project</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SEC&quot;</span>
</span><span id="__span-6-113"><span class="w">      </span><span class="nt">issue_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Bug&quot;</span>
</span><span id="__span-6-114">
</span><span id="__span-6-115"><span class="w">  </span><span class="c1"># Security settings</span>
</span><span id="__span-6-116"><span class="w">  </span><span class="nt">security</span><span class="p">:</span>
</span><span id="__span-6-117"><span class="w">    </span><span class="nt">guardrails</span><span class="p">:</span>
</span><span id="__span-6-118"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-119"><span class="w">      </span><span class="nt">prompt_injection_protection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-120"><span class="w">      </span><span class="nt">dangerous_command_blocking</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-121">
</span><span id="__span-6-122"><span class="w">    </span><span class="nt">encryption</span><span class="p">:</span>
</span><span id="__span-6-123"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-124"><span class="w">      </span><span class="nt">key_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./keys/audit_key.pem&quot;</span>
</span><span id="__span-6-125">
</span><span id="__span-6-126"><span class="w">    </span><span class="nt">audit_trail</span><span class="p">:</span>
</span><span id="__span-6-127"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-128"><span class="w">      </span><span class="nt">log_level</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;INFO&quot;</span>
</span><span id="__span-6-129"><span class="w">      </span><span class="nt">retention_days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">365</span>
</span><span id="__span-6-130">
</span><span id="__span-6-131"><span class="w">  </span><span class="c1"># Performance tuning</span>
</span><span id="__span-6-132"><span class="w">  </span><span class="nt">performance</span><span class="p">:</span>
</span><span id="__span-6-133"><span class="w">    </span><span class="nt">memory_limit</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4GB&quot;</span>
</span><span id="__span-6-134"><span class="w">    </span><span class="nt">cpu_limit</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2.0&quot;</span><span class="w">  </span><span class="c1"># 2 CPU cores</span>
</span><span id="__span-6-135"><span class="w">    </span><span class="nt">disk_limit</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10GB&quot;</span>
</span><span id="__span-6-136">
</span><span id="__span-6-137"><span class="w">    </span><span class="nt">caching</span><span class="p">:</span>
</span><span id="__span-6-138"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-6-139"><span class="w">      </span><span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./.audit_cache&quot;</span>
</span><span id="__span-6-140"><span class="w">      </span><span class="nt">max_cache_size</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1GB&quot;</span>
</span><span id="__span-6-141"><span class="w">      </span><span class="nt">ttl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">86400</span><span class="w">  </span><span class="c1"># 24 hours</span>
</span><span id="__span-6-142">
</span><span id="__span-6-143"><span class="w">  </span><span class="c1"># Environment settings</span>
</span><span id="__span-6-144"><span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
</span><span id="__span-6-145"><span class="w">    </span><span class="nt">variables</span><span class="p">:</span>
</span><span id="__span-6-146"><span class="w">      </span><span class="nt">SOLC_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.8.19&quot;</span>
</span><span id="__span-6-147"><span class="w">      </span><span class="nt">PYTHONPATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./src&quot;</span>
</span><span id="__span-6-148"><span class="w">      </span><span class="nt">AUDIT_ENV</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;production&quot;</span>
</span><span id="__span-6-149">
</span><span id="__span-6-150"><span class="w">    </span><span class="nt">paths</span><span class="p">:</span>
</span><span id="__span-6-151"><span class="w">      </span><span class="nt">solc</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/usr/local/bin/solc&quot;</span>
</span><span id="__span-6-152"><span class="w">      </span><span class="nt">python</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/usr/bin/python3.12&quot;</span>
</span><span id="__span-6-153"><span class="w">      </span><span class="nt">tools_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./tools&quot;</span>
</span></code></pre></div>
<h3 id="example-8-cicd-integration-config">Example 8: CI/CD Integration Config</h3>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-7-1"><span class="c1"># ci_audit_config.yaml</span>
</span><span id="__span-7-2"><span class="nt">ci</span><span class="p">:</span>
</span><span id="__span-7-3"><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-4"><span class="w">  </span><span class="nt">fail_on_findings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-5"><span class="w">  </span><span class="nt">fail_threshold</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;high&quot;</span><span class="w">  </span><span class="c1"># Fail if any high or critical findings</span>
</span><span id="__span-7-6">
</span><span id="__span-7-7"><span class="w">  </span><span class="c1"># Pull request integration</span>
</span><span id="__span-7-8"><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
</span><span id="__span-7-9"><span class="w">    </span><span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-10"><span class="w">    </span><span class="nt">require_review</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-11"><span class="w">    </span><span class="nt">block_merge</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-7-12">
</span><span id="__span-7-13"><span class="w">  </span><span class="c1"># Branch protection</span>
</span><span id="__span-7-14"><span class="w">  </span><span class="nt">branches</span><span class="p">:</span>
</span><span id="__span-7-15"><span class="w">    </span><span class="nt">main</span><span class="p">:</span>
</span><span id="__span-7-16"><span class="w">      </span><span class="nt">require_audit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-17"><span class="w">      </span><span class="nt">max_critical_findings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</span><span id="__span-7-18"><span class="w">      </span><span class="nt">max_high_findings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id="__span-7-19">
</span><span id="__span-7-20"><span class="w">    </span><span class="nt">develop</span><span class="p">:</span>
</span><span id="__span-7-21"><span class="w">      </span><span class="nt">require_audit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-22"><span class="w">      </span><span class="nt">max_critical_findings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span><span id="__span-7-23"><span class="w">      </span><span class="nt">max_high_findings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-7-24">
</span><span id="__span-7-25"><span class="w">  </span><span class="c1"># Notification settings</span>
</span><span id="__span-7-26"><span class="w">  </span><span class="nt">notifications</span><span class="p">:</span>
</span><span id="__span-7-27"><span class="w">    </span><span class="nt">email</span><span class="p">:</span>
</span><span id="__span-7-28"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-29"><span class="w">      </span><span class="nt">recipients</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;security@company.com&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;dev-team@company.com&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-7-30"><span class="w">      </span><span class="nt">on_failure_only</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-7-31">
</span><span id="__span-7-32"><span class="w">    </span><span class="nt">slack</span><span class="p">:</span>
</span><span id="__span-7-33"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-34"><span class="w">      </span><span class="nt">channel</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#security-audits&quot;</span>
</span><span id="__span-7-35"><span class="w">      </span><span class="nt">mention_groups</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;@security-team&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-7-36">
</span><span id="__span-7-37"><span class="c1"># Tool configurations optimized for CI</span>
</span><span id="__span-7-38"><span class="nt">tools</span><span class="p">:</span>
</span><span id="__span-7-39"><span class="w">  </span><span class="nt">slither</span><span class="p">:</span>
</span><span id="__span-7-40"><span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">120</span><span class="w">  </span><span class="c1"># Shorter timeout for CI</span>
</span><span id="__span-7-41"><span class="w">    </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-7-42"><span class="w">      </span><span class="nt">exclude_dependencies</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-43"><span class="w">      </span><span class="nt">detectors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;reentrancy&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;unchecked-lowlevel-call&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-7-44">
</span><span id="__span-7-45"><span class="w">  </span><span class="nt">mythril</span><span class="p">:</span>
</span><span id="__span-7-46"><span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">180</span>
</span><span id="__span-7-47"><span class="w">    </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-7-48"><span class="w">      </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span><span class="w">  </span><span class="c1"># Reduced for faster CI runs</span>
</span><span id="__span-7-49">
</span><span id="__span-7-50"><span class="c1"># Reporting optimized for CI</span>
</span><span id="__span-7-51"><span class="nt">reporting</span><span class="p">:</span>
</span><span id="__span-7-52"><span class="w">  </span><span class="nt">formats</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;json&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;junit&quot;</span><span class="p p-Indicator">]</span><span class="w">  </span><span class="c1"># JUnit for CI integration</span>
</span><span id="__span-7-53"><span class="w">  </span><span class="nt">output_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./audit-results&quot;</span>
</span><span id="__span-7-54"><span class="w">  </span><span class="nt">include_source_code</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">  </span><span class="c1"># Reduce output size</span>
</span></code></pre></div>
<hr />
<h2 id="advanced-usage-patterns">Advanced Usage Patterns</h2>
<h3 id="example-9-parallel-multi-protocol-audit">Example 9: Parallel Multi-Protocol Audit</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><span class="ch">#!/usr/bin/env python3</span>
</span><span id="__span-8-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-8-3"><span class="sd">Advanced parallel multi-protocol auditing example.</span>
</span><span id="__span-8-4"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-8-5">
</span><span id="__span-8-6"><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
</span><span id="__span-8-7"><span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span><span id="__span-8-8"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.orchestrator</span><span class="w"> </span><span class="kn">import</span> <span class="n">AuditOrchestrator</span>
</span><span id="__span-8-9"><span class="kn">from</span><span class="w"> </span><span class="nn">web3_security_ai.agents</span><span class="w"> </span><span class="kn">import</span> <span class="n">Web3AuditAgent</span><span class="p">,</span> <span class="n">DeFiAuditAgent</span><span class="p">,</span> <span class="n">NFTAuditAgent</span>
</span><span id="__span-8-10"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-8-11">
</span><span id="__span-8-12"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">audit_multiple_protocols</span><span class="p">(</span><span class="n">protocols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="__span-8-13"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-8-14"><span class="sd">    Audit multiple protocols in parallel.</span>
</span><span id="__span-8-15">
</span><span id="__span-8-16"><span class="sd">    Args:</span>
</span><span id="__span-8-17"><span class="sd">        protocols: List of protocol configurations</span>
</span><span id="__span-8-18">
</span><span id="__span-8-19"><span class="sd">    Returns:</span>
</span><span id="__span-8-20"><span class="sd">        List of audit results</span>
</span><span id="__span-8-21"><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-8-22">
</span><span id="__span-8-23">    <span class="c1"># Create orchestrator with multiple agent types</span>
</span><span id="__span-8-24">    <span class="n">agents</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-8-25">        <span class="n">Web3AuditAgent</span><span class="p">(),</span>
</span><span id="__span-8-26">        <span class="n">DeFiAuditAgent</span><span class="p">(),</span>
</span><span id="__span-8-27">        <span class="n">NFTAuditAgent</span><span class="p">()</span>
</span><span id="__span-8-28">    <span class="p">]</span>
</span><span id="__span-8-29">
</span><span id="__span-8-30">    <span class="n">orchestrator</span> <span class="o">=</span> <span class="n">AuditOrchestrator</span><span class="p">(</span><span class="n">agents</span><span class="p">)</span>
</span><span id="__span-8-31">
</span><span id="__span-8-32">    <span class="c1"># Run audits in parallel using thread pool</span>
</span><span id="__span-8-33">    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span><span id="__span-8-34">        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span><span id="__span-8-35">
</span><span id="__span-8-36">        <span class="c1"># Create audit tasks</span>
</span><span id="__span-8-37">        <span class="n">audit_tasks</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-8-38">        <span class="k">for</span> <span class="n">protocol</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
</span><span id="__span-8-39">            <span class="n">task</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_in_executor</span><span class="p">(</span>
</span><span id="__span-8-40">                <span class="n">executor</span><span class="p">,</span>
</span><span id="__span-8-41">                <span class="n">orchestrator</span><span class="o">.</span><span class="n">run_full_audit</span><span class="p">,</span>
</span><span id="__span-8-42">                <span class="n">protocol</span>
</span><span id="__span-8-43">            <span class="p">)</span>
</span><span id="__span-8-44">            <span class="n">audit_tasks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">protocol</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">task</span><span class="p">))</span>
</span><span id="__span-8-45">
</span><span id="__span-8-46">        <span class="c1"># Wait for all audits to complete</span>
</span><span id="__span-8-47">        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-8-48">        <span class="k">for</span> <span class="n">protocol_name</span><span class="p">,</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">audit_tasks</span><span class="p">:</span>
</span><span id="__span-8-49">            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-8-50">                <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-8-51">                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">task</span>
</span><span id="__span-8-52">                <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="__span-8-53">
</span><span id="__span-8-54">                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="__span-8-55">                    <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="n">protocol_name</span><span class="p">,</span>
</span><span id="__span-8-56">                    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-8-57">                    <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">,</span>
</span><span id="__span-8-58">                    <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="n">duration</span>
</span><span id="__span-8-59">                <span class="p">})</span>
</span><span id="__span-8-60">
</span><span id="__span-8-61">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ Completed audit for </span><span class="si">{</span><span class="n">protocol_name</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span id="__span-8-62">
</span><span id="__span-8-63">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-8-64">                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="__span-8-65">                    <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="n">protocol_name</span><span class="p">,</span>
</span><span id="__span-8-66">                    <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="__span-8-67">                    <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
</span><span id="__span-8-68">                    <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">0</span>
</span><span id="__span-8-69">                <span class="p">})</span>
</span><span id="__span-8-70">
</span><span id="__span-8-71">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Failed audit for </span><span class="si">{</span><span class="n">protocol_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-72">
</span><span id="__span-8-73">        <span class="k">return</span> <span class="n">results</span>
</span><span id="__span-8-74">
</span><span id="__span-8-75"><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-8-76">    <span class="c1"># Define multiple protocols to audit</span>
</span><span id="__span-8-77">    <span class="n">protocols</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-8-78">        <span class="p">{</span>
</span><span id="__span-8-79">            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Uniswap V3&quot;</span><span class="p">,</span>
</span><span id="__span-8-80">            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;defi&quot;</span><span class="p">,</span>
</span><span id="__span-8-81">            <span class="s2">&quot;contracts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;contracts/uniswap/v3/core/*.sol&quot;</span><span class="p">],</span>
</span><span id="__span-8-82">            <span class="s2">&quot;analysis_depth&quot;</span><span class="p">:</span> <span class="s2">&quot;comprehensive&quot;</span><span class="p">,</span>
</span><span id="__span-8-83">            <span class="s2">&quot;check_flash_loans&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-8-84">        <span class="p">},</span>
</span><span id="__span-8-85">        <span class="p">{</span>
</span><span id="__span-8-86">            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Compound Finance&quot;</span><span class="p">,</span>
</span><span id="__span-8-87">            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;defi&quot;</span><span class="p">,</span>
</span><span id="__span-8-88">            <span class="s2">&quot;contracts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;contracts/compound/*.sol&quot;</span><span class="p">],</span>
</span><span id="__span-8-89">            <span class="s2">&quot;analysis_depth&quot;</span><span class="p">:</span> <span class="s2">&quot;comprehensive&quot;</span><span class="p">,</span>
</span><span id="__span-8-90">            <span class="s2">&quot;verify_interest_rate_model&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-8-91">        <span class="p">},</span>
</span><span id="__span-8-92">        <span class="p">{</span>
</span><span id="__span-8-93">            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;OpenSea Contracts&quot;</span><span class="p">,</span>
</span><span id="__span-8-94">            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;nft&quot;</span><span class="p">,</span>
</span><span id="__span-8-95">            <span class="s2">&quot;contracts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;contracts/opensea/*.sol&quot;</span><span class="p">],</span>
</span><span id="__span-8-96">            <span class="s2">&quot;analysis_depth&quot;</span><span class="p">:</span> <span class="s2">&quot;standard&quot;</span><span class="p">,</span>
</span><span id="__span-8-97">            <span class="s2">&quot;check_royalty_implementation&quot;</span><span class="p">:</span> <span class="kc">True</span>
</span><span id="__span-8-98">        <span class="p">},</span>
</span><span id="__span-8-99">        <span class="p">{</span>
</span><span id="__span-8-100">            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Custom Token&quot;</span><span class="p">,</span>
</span><span id="__span-8-101">            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;erc20&quot;</span><span class="p">,</span>
</span><span id="__span-8-102">            <span class="s2">&quot;contracts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;contracts/token/*.sol&quot;</span><span class="p">],</span>
</span><span id="__span-8-103">            <span class="s2">&quot;analysis_depth&quot;</span><span class="p">:</span> <span class="s2">&quot;basic&quot;</span>
</span><span id="__span-8-104">        <span class="p">}</span>
</span><span id="__span-8-105">    <span class="p">]</span>
</span><span id="__span-8-106">
</span><span id="__span-8-107">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üöÄ Starting parallel multi-protocol audit...&quot;</span><span class="p">)</span>
</span><span id="__span-8-108">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìä Auditing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">protocols</span><span class="p">)</span><span class="si">}</span><span class="s2"> protocols&quot;</span><span class="p">)</span>
</span><span id="__span-8-109">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="__span-8-110">
</span><span id="__span-8-111">    <span class="c1"># Run parallel audits</span>
</span><span id="__span-8-112">    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-8-113">    <span class="n">results</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">audit_multiple_protocols</span><span class="p">(</span><span class="n">protocols</span><span class="p">))</span>
</span><span id="__span-8-114">    <span class="n">total_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="__span-8-115">
</span><span id="__span-8-116">    <span class="c1"># Summarize results</span>
</span><span id="__span-8-117">    <span class="n">successful</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">])</span>
</span><span id="__span-8-118">    <span class="n">total_findings</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
</span><span id="__span-8-119">        <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;findings&quot;</span><span class="p">,</span> <span class="p">[]))</span>
</span><span id="__span-8-120">        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span>
</span><span id="__span-8-121">    <span class="p">)</span>
</span><span id="__span-8-122">
</span><span id="__span-8-123">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìà Audit Summary:&quot;</span><span class="p">)</span>
</span><span id="__span-8-124">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Total Protocols: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">protocols</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-125">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Successful Audits: </span><span class="si">{</span><span class="n">successful</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-126">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Failed Audits: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">protocols</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">successful</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-127">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Total Findings: </span><span class="si">{</span><span class="n">total_findings</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-128">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.1f&quot;</span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.2f&quot;</span>
</span><span id="__span-8-129">    <span class="c1"># Detailed results</span>
</span><span id="__span-8-130">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìã Detailed Results:&quot;</span><span class="p">)</span>
</span><span id="__span-8-131">    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="__span-8-132">        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;‚úÖ&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;‚ùå&quot;</span>
</span><span id="__span-8-133">        <span class="n">findings</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;findings&quot;</span><span class="p">,</span> <span class="p">[]))</span> <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-8-134">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.1f&quot;</span>
</span><span id="__span-8-135"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-8-136">    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="example-10-custom-reporting-and-analytics">Example 10: Custom Reporting and Analytics</h3>
<p>```python</p>
<h1 id="usrbinenv-python3">!/usr/bin/env python3</h1>
<p>"""
Custom reporting and analytics example.
"""</p>
<p>import json
import matplotlib.pyplot as plt
import seaborn as sns
from collections import defaultdict, Counter
from datetime import datetime
from typing import List, Dict, Any
from web3_security_ai.models import Finding, Severity</p>
<p>class AuditAnalytics:
    """Custom analytics and reporting for audit results."""</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">audit_results</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">Dict</span><span class="o">]</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">self</span><span class="p">.</span><span class="n">audit_results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">audit_results</span>
<span class="w">    </span><span class="n">self</span><span class="p">.</span><span class="n">findings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_extract_findings</span><span class="p">()</span>

<span class="n">def</span><span class="w"> </span><span class="n">_extract_findings</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">Finding</span><span class="o">]</span><span class="err">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Extract all findings from audit results.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">all_findings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">audit_results</span><span class="p">:</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">result</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;success&quot;</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">&quot;result&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">result</span><span class="err">:</span>
<span class="w">            </span><span class="n">findings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">result</span><span class="o">[</span><span class="n">&quot;result&quot;</span><span class="o">]</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;findings&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">[]</span><span class="p">)</span>
<span class="w">            </span><span class="n">all_findings</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">findings</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">all_findings</span>

<span class="n">def</span><span class="w"> </span><span class="n">generate_summary_report</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="err">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Generate comprehensive summary report.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="ss">&quot;audit_summary&quot;</span><span class="err">:</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="ss">&quot;total_audits&quot;</span><span class="err">:</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">audit_results</span><span class="p">),</span>
<span class="w">            </span><span class="ss">&quot;successful_audits&quot;</span><span class="err">:</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">audit_results</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;success&quot;</span><span class="p">)),</span>
<span class="w">            </span><span class="ss">&quot;failed_audits&quot;</span><span class="err">:</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">audit_results</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;success&quot;</span><span class="p">)),</span>
<span class="w">            </span><span class="ss">&quot;total_findings&quot;</span><span class="err">:</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">findings</span><span class="p">)</span>
<span class="w">        </span><span class="err">}</span><span class="p">,</span>
<span class="w">        </span><span class="ss">&quot;findings_by_severity&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_findings_by_severity</span><span class="p">(),</span>
<span class="w">        </span><span class="ss">&quot;findings_by_type&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_findings_by_type</span><span class="p">(),</span>
<span class="w">        </span><span class="ss">&quot;findings_by_contract&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_findings_by_contract</span><span class="p">(),</span>
<span class="w">        </span><span class="ss">&quot;risk_assessment&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_calculate_risk_score</span><span class="p">(),</span>
<span class="w">        </span><span class="ss">&quot;recommendations&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_generate_recommendations</span><span class="p">()</span>
<span class="w">    </span><span class="err">}</span>

<span class="n">def</span><span class="w"> </span><span class="n">_findings_by_severity</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Dict</span><span class="o">[</span><span class="n">str, int</span><span class="o">]</span><span class="err">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Count findings by severity level.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">severity_counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">defaultdict</span><span class="p">(</span><span class="nc">int</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">finding</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">findings</span><span class="p">:</span>
<span class="w">        </span><span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finding</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;severity&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;unknown&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">severity_counts</span><span class="o">[</span><span class="n">severity</span><span class="o">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="n">severity_counts</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_findings_by_type</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Dict</span><span class="o">[</span><span class="n">str, int</span><span class="o">]</span><span class="err">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Count findings by vulnerability type.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">type_counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Counter</span><span class="p">(</span>
<span class="w">        </span><span class="n">finding</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;unknown&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">finding</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">findings</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="n">type_counts</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_findings_by_contract</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Dict</span><span class="o">[</span><span class="n">str, int</span><span class="o">]</span><span class="err">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Count findings by contract.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">contract_counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">defaultdict</span><span class="p">(</span><span class="nc">int</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">finding</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">findings</span><span class="p">:</span>
<span class="w">        </span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finding</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;location&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">{}</span><span class="p">)</span>
<span class="w">        </span><span class="n">contract</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;unknown&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">contract_counts</span><span class="o">[</span><span class="n">contract</span><span class="o">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="n">contract_counts</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">_calculate_risk_score</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="err">:</span>
<span class="w">    </span><span class="ss">&quot;&quot;&quot;Calculate overall risk score.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">findings</span><span class="p">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">{</span><span class="ss">&quot;score&quot;</span><span class="err">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;level&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;description&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;No findings detected&quot;</span><span class="err">}</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Weight</span><span class="w"> </span><span class="n">findings</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">severity</span>
<span class="w">    </span><span class="n">weights</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="ss">&quot;critical&quot;</span><span class="err">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span>
<span class="w">        </span><span class="ss">&quot;high&quot;</span><span class="err">:</span><span class="w"> </span><span class="mf">7.0</span><span class="p">,</span>
<span class="w">        </span><span class="ss">&quot;medium&quot;</span><span class="err">:</span><span class="w"> </span><span class="mf">4.0</span><span class="p">,</span>
<span class="w">        </span><span class="ss">&quot;low&quot;</span><span class="err">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">        </span><span class="ss">&quot;info&quot;</span><span class="err">:</span><span class="w"> </span><span class="mf">0.1</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">total_score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span>
<span class="w">    </span><span class="n">max_possible_score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">findings</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">10.0</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">finding</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">findings</span><span class="p">:</span>
<span class="w">        </span><span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finding</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="ss">&quot;severity&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;info&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weights</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">)</span>
<span class="w">        </span><span class="n">total_score</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">weight</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Normalize</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">0</span><span class="o">-</span><span class="mi">10</span><span class="w"> </span><span class="n">scale</span>
<span class="w">    </span><span class="n">normalized_score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">total_score</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">max_possible_score</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">10.0</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Determine</span><span class="w"> </span><span class="n">risk</span><span class="w"> </span><span class="k">level</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">normalized_score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">8.0</span><span class="err">:</span>
<span class="w">        </span><span class="k">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Critical&quot;</span>
<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">normalized_score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">6.0</span><span class="err">:</span>
<span class="w">        </span><span class="k">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;High&quot;</span>
<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">normalized_score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">4.0</span><span class="err">:</span>
<span class="w">        </span><span class="k">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Medium&quot;</span>
<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">normalized_score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">2.0</span><span class="err">:</span>
<span class="w">        </span><span class="k">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Low&quot;</span>
<span class="w">    </span><span class="k">else</span><span class="err">:</span>
<span class="w">        </span><span class="k">level</span><span class="w"> </span><span class="o">=</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "navigation.path", "navigation.sections", "navigation.expand", "content.code.annotate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>